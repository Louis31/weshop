!function(t,e){function i(t){var e=t.length,i=he.type(t);return he.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function n(t){var e=De[t]={};return he.each(t.match(de)||[],function(t,i){e[i]=!0}),e}function s(t,i,n,s){if(he.acceptData(t)){var o,a,r=he.expando,l=t.nodeType,c=l?he.cache:t,h=l?t[r]:t[r]&&r;if(h&&c[h]&&(s||c[h].data)||n!==e||"string"!=typeof i)return h||(h=l?t[r]=ee.pop()||he.guid++:r),c[h]||(c[h]=l?{}:{toJSON:he.noop}),("object"==typeof i||"function"==typeof i)&&(s?c[h]=he.extend(c[h],i):c[h].data=he.extend(c[h].data,i)),a=c[h],s||(a.data||(a.data={}),a=a.data),n!==e&&(a[he.camelCase(i)]=n),"string"==typeof i?(o=a[i],null==o&&(o=a[he.camelCase(i)])):o=a,o}}function o(t,e,i){if(he.acceptData(t)){var n,s,o=t.nodeType,a=o?he.cache:t,l=o?t[he.expando]:he.expando;if(a[l]){if(e&&(n=i?a[l]:a[l].data)){he.isArray(e)?e=e.concat(he.map(e,he.camelCase)):e in n?e=[e]:(e=he.camelCase(e),e=e in n?[e]:e.split(" ")),s=e.length;for(;s--;)delete n[e[s]];if(i?!r(n):!he.isEmptyObject(n))return}(i||(delete a[l].data,r(a[l])))&&(o?he.cleanData([t],!0):he.support.deleteExpando||a!=a.window?delete a[l]:a[l]=null)}}}function a(t,i,n){if(n===e&&1===t.nodeType){var s="data-"+i.replace(je,"-$1").toLowerCase();if(n=t.getAttribute(s),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Te.test(n)?he.parseJSON(n):n}catch(o){}he.data(t,i,n)}else n=e}return n}function r(t){var e;for(e in t)if(("data"!==e||!he.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function l(){return!0}function c(){return!1}function h(){try{return Q.activeElement}catch(t){}}function u(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function d(t,e,i){if(he.isFunction(e))return he.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return he.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(qe.test(e))return he.filter(e,t,i);e=he.filter(e,t)}return he.grep(t,function(t){return he.inArray(t,e)>=0!==i})}function p(t){var e=Ve.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function f(t,e){return he.nodeName(t,"table")&&he.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function m(t){return t.type=(null!==he.find.attr(t,"type"))+"/"+t.type,t}function g(t){var e=si.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function v(t,e){for(var i,n=0;null!=(i=t[n]);n++)he._data(i,"globalEval",!e||he._data(e[n],"globalEval"))}function y(t,e){if(1===e.nodeType&&he.hasData(t)){var i,n,s,o=he._data(t),a=he._data(e,o),r=o.events;if(r){delete a.handle,a.events={};for(i in r)for(n=0,s=r[i].length;s>n;n++)he.event.add(e,i,r[i][n])}a.data&&(a.data=he.extend({},a.data))}}function _(t,e){var i,n,s;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!he.support.noCloneEvent&&e[he.expando]){s=he._data(e);for(n in s.events)he.removeEvent(e,n,s.handle);e.removeAttribute(he.expando)}"script"===i&&e.text!==t.text?(m(e).text=t.text,g(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),he.support.html5Clone&&t.innerHTML&&!he.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&ei.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function b(t,i){var n,s,o=0,a=typeof t.getElementsByTagName!==K?t.getElementsByTagName(i||"*"):typeof t.querySelectorAll!==K?t.querySelectorAll(i||"*"):e;if(!a)for(a=[],n=t.childNodes||t;null!=(s=n[o]);o++)!i||he.nodeName(s,i)?a.push(s):he.merge(a,b(s,i));return i===e||i&&he.nodeName(t,i)?he.merge([t],a):a}function w(t){ei.test(t.type)&&(t.defaultChecked=t.checked)}function x(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,s=Ci.length;s--;)if(e=Ci[s]+i,e in t)return e;return n}function k(t,e){return t=e||t,"none"===he.css(t,"display")||!he.contains(t.ownerDocument,t)}function C(t,e){for(var i,n,s,o=[],a=0,r=t.length;r>a;a++)n=t[a],n.style&&(o[a]=he._data(n,"olddisplay"),i=n.style.display,e?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&k(n)&&(o[a]=he._data(n,"olddisplay",S(n.nodeName)))):o[a]||(s=k(n),(i&&"none"!==i||!s)&&he._data(n,"olddisplay",s?i:he.css(n,"display"))));for(a=0;r>a;a++)n=t[a],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[a]||"":"none"));return t}function D(t,e,i){var n=vi.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function T(t,e,i,n,s){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=he.css(t,i+ki[o],!0,s)),n?("content"===i&&(a-=he.css(t,"padding"+ki[o],!0,s)),"margin"!==i&&(a-=he.css(t,"border"+ki[o]+"Width",!0,s))):(a+=he.css(t,"padding"+ki[o],!0,s),"padding"!==i&&(a+=he.css(t,"border"+ki[o]+"Width",!0,s)));return a}function j(t,e,i){var n=!0,s="width"===e?t.offsetWidth:t.offsetHeight,o=hi(t),a=he.support.boxSizing&&"border-box"===he.css(t,"boxSizing",!1,o);if(0>=s||null==s){if(s=ui(t,e,o),(0>s||null==s)&&(s=t.style[e]),yi.test(s))return s;n=a&&(he.support.boxSizingReliable||s===t.style[e]),s=parseFloat(s)||0}return s+T(t,e,i||(a?"border":"content"),n,o)+"px"}function S(t){var e=Q,i=bi[t];return i||(i=$(t,e),"none"!==i&&i||(ci=(ci||he("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(ci[0].contentWindow||ci[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),i=$(t,e),ci.detach()),bi[t]=i),i}function $(t,e){var i=he(e.createElement(t)).appendTo(e.body),n=he.css(i[0],"display");return i.remove(),n}function N(t,e,i,n){var s;if(he.isArray(e))he.each(e,function(e,s){i||Ti.test(t)?n(t,s):N(t+"["+("object"==typeof s?e:"")+"]",s,i,n)});else if(i||"object"!==he.type(e))n(t,e);else for(s in e)N(t+"["+s+"]",e[s],i,n)}function E(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,o=e.toLowerCase().match(de)||[];if(he.isFunction(i))for(;n=o[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function F(t,e,i,n){function s(r){var l;return o[r]=!0,he.each(t[r]||[],function(t,r){var c=r(e,i,n);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)}),l}var o={},a=t===Wi;return s(e.dataTypes[0])||!o["*"]&&s("*")}function M(t,i){var n,s,o=he.ajaxSettings.flatOptions||{};for(s in i)i[s]!==e&&((o[s]?t:n||(n={}))[s]=i[s]);return n&&he.extend(!0,t,n),t}function I(t,i,n){for(var s,o,a,r,l=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),o===e&&(o=t.mimeType||i.getResponseHeader("Content-Type"));if(o)for(r in l)if(l[r]&&l[r].test(o)){c.unshift(r);break}if(c[0]in n)a=c[0];else{for(r in n){if(!c[0]||t.converters[r+" "+c[0]]){a=r;break}s||(s=r)}a=a||s}return a?(a!==c[0]&&c.unshift(a),n[a]):void 0}function z(t,e,i,n){var s,o,a,r,l,c={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=h.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=h.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=c[l+" "+o]||c["* "+o],!a)for(s in c)if(r=s.split(" "),r[1]===o&&(a=c[l+" "+r[0]]||c["* "+r[0]])){a===!0?a=c[s]:c[s]!==!0&&(o=r[0],h.unshift(r[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}function P(){try{return new t.XMLHttpRequest}catch(e){}}function A(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function O(){return setTimeout(function(){Gi=e}),Gi=he.now()}function L(t,e,i){for(var n,s=(on[e]||[]).concat(on["*"]),o=0,a=s.length;a>o;o++)if(n=s[o].call(i,e,t))return n}function H(t,e,i){var n,s,o=0,a=sn.length,r=he.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var e=Gi||O(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,o=1-n,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(o);return r.notifyWith(t,[c,o,i]),1>o&&l?i:(r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:he.extend({},e),opts:he.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Gi||O(),duration:i.duration,tweens:[],createTween:function(e,i){var n=he.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)c.tweens[i].run(1);return e?r.resolveWith(t,[c,e]):r.rejectWith(t,[c,e]),this}}),h=c.props;for(R(h,c.opts.specialEasing);a>o;o++)if(n=sn[o].call(c,t,h,c.opts))return n;return he.map(h,L,c),he.isFunction(c.opts.start)&&c.opts.start.call(t,c),he.fx.timer(he.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function R(t,e){var i,n,s,o,a;for(i in t)if(n=he.camelCase(i),s=e[n],o=t[i],he.isArray(o)&&(s=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),a=he.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=s)}else e[n]=s}function q(t,e,i){var n,s,o,a,r,l,c=this,h={},u=t.style,d=t.nodeType&&k(t),p=he._data(t,"fxshow");i.queue||(r=he._queueHooks(t,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,c.always(function(){c.always(function(){r.unqueued--,he.queue(t,"fx").length||r.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===he.css(t,"display")&&"none"===he.css(t,"float")&&(he.support.inlineBlockNeedsLayout&&"inline"!==S(t.nodeName)?u.zoom=1:u.display="inline-block")),i.overflow&&(u.overflow="hidden",he.support.shrinkWrapBlocks||c.always(function(){u.overflow=i.overflow[0],u.overflowX=i.overflow[1],u.overflowY=i.overflow[2]}));for(n in e)if(s=e[n],tn.exec(s)){if(delete e[n],o=o||"toggle"===s,s===(d?"hide":"show"))continue;h[n]=p&&p[n]||he.style(t,n)}if(!he.isEmptyObject(h)){p?"hidden"in p&&(d=p.hidden):p=he._data(t,"fxshow",{}),o&&(p.hidden=!d),d?he(t).show():c.done(function(){he(t).hide()}),c.done(function(){var e;he._removeData(t,"fxshow");for(e in h)he.style(t,e,h[e])});for(n in h)a=L(d?p[n]:0,n,c),n in p||(p[n]=a.start,d&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function W(t,e,i,n,s){return new W.prototype.init(t,e,i,n,s)}function B(t,e){var i,n={height:t},s=0;for(e=e?1:0;4>s;s+=2-e)i=ki[s],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function U(t){return he.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var V,Y,K=typeof e,X=t.location,Q=t.document,Z=Q.documentElement,G=t.jQuery,J=t.$,te={},ee=[],ie="1.10.2",ne=ee.concat,se=ee.push,oe=ee.slice,ae=ee.indexOf,re=te.toString,le=te.hasOwnProperty,ce=ie.trim,he=function(t,e){return new he.fn.init(t,e,Y)},ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,de=/\S+/g,pe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,fe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,me=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ge=/^[\],:{}\s]*$/,ve=/(?:^|:|,)(?:\s*\[)+/g,ye=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,_e=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,be=/^-ms-/,we=/-([\da-z])/gi,xe=function(t,e){return e.toUpperCase()},ke=function(t){(Q.addEventListener||"load"===t.type||"complete"===Q.readyState)&&(Ce(),he.ready())},Ce=function(){Q.addEventListener?(Q.removeEventListener("DOMContentLoaded",ke,!1),t.removeEventListener("load",ke,!1)):(Q.detachEvent("onreadystatechange",ke),t.detachEvent("onload",ke))};he.fn=he.prototype={jquery:ie,constructor:he,init:function(t,i,n){var s,o;if(!t)return this;if("string"==typeof t){if(s="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:fe.exec(t),!s||!s[1]&&i)return!i||i.jquery?(i||n).find(t):this.constructor(i).find(t);if(s[1]){if(i=i instanceof he?i[0]:i,he.merge(this,he.parseHTML(s[1],i&&i.nodeType?i.ownerDocument||i:Q,!0)),me.test(s[1])&&he.isPlainObject(i))for(s in i)he.isFunction(this[s])?this[s](i[s]):this.attr(s,i[s]);return this}if(o=Q.getElementById(s[2]),o&&o.parentNode){if(o.id!==s[2])return n.find(t);this.length=1,this[0]=o}return this.context=Q,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):he.isFunction(t)?n.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),he.makeArray(t,this))},selector:"",length:0,toArray:function(){return oe.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=he.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return he.each(this,t,e)},ready:function(t){return he.ready.promise().done(t),this},slice:function(){return this.pushStack(oe.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(he.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:se,sort:[].sort,splice:[].splice},he.fn.init.prototype=he.fn,he.extend=he.fn.extend=function(){var t,i,n,s,o,a,r=arguments[0]||{},l=1,c=arguments.length,h=!1;for("boolean"==typeof r&&(h=r,r=arguments[1]||{},l=2),"object"==typeof r||he.isFunction(r)||(r={}),c===l&&(r=this,--l);c>l;l++)if(null!=(o=arguments[l]))for(s in o)t=r[s],n=o[s],r!==n&&(h&&n&&(he.isPlainObject(n)||(i=he.isArray(n)))?(i?(i=!1,a=t&&he.isArray(t)?t:[]):a=t&&he.isPlainObject(t)?t:{},r[s]=he.extend(h,a,n)):n!==e&&(r[s]=n));return r},he.extend({expando:"jQuery"+(ie+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===he&&(t.$=J),e&&t.jQuery===he&&(t.jQuery=G),he},isReady:!1,readyWait:1,holdReady:function(t){t?he.readyWait++:he.ready(!0)},ready:function(t){if(t===!0?!--he.readyWait:!he.isReady){if(!Q.body)return setTimeout(he.ready);he.isReady=!0,t!==!0&&--he.readyWait>0||(V.resolveWith(Q,[he]),he.fn.trigger&&he(Q).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===he.type(t)},isArray:Array.isArray||function(t){return"array"===he.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?te[re.call(t)]||"object":typeof t},isPlainObject:function(t){var i;if(!t||"object"!==he.type(t)||t.nodeType||he.isWindow(t))return!1;try{if(t.constructor&&!le.call(t,"constructor")&&!le.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(he.support.ownLast)for(i in t)return le.call(t,i);for(i in t);return i===e||le.call(t,i)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||Q;var n=me.exec(t),s=!i&&[];return n?[e.createElement(n[1])]:(n=he.buildFragment([t],e,s),s&&he(s).remove(),he.merge([],n.childNodes))},parseJSON:function(e){return t.JSON&&t.JSON.parse?t.JSON.parse(e):null===e?e:"string"==typeof e&&(e=he.trim(e),e&&ge.test(e.replace(ye,"@").replace(_e,"]").replace(ve,"")))?new Function("return "+e)():void he.error("Invalid JSON: "+e)},parseXML:function(i){var n,s;if(!i||"string"!=typeof i)return null;try{t.DOMParser?(s=new DOMParser,n=s.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(o){n=e}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||he.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(e){e&&he.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(be,"ms-").replace(we,xe)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var s,o=0,a=t.length,r=i(t);if(n){if(r)for(;a>o&&(s=e.apply(t[o],n),s!==!1);o++);else for(o in t)if(s=e.apply(t[o],n),s===!1)break}else if(r)for(;a>o&&(s=e.call(t[o],o,t[o]),s!==!1);o++);else for(o in t)if(s=e.call(t[o],o,t[o]),s===!1)break;return t},trim:ce&&!ce.call("﻿ ")?function(t){return null==t?"":ce.call(t)}:function(t){return null==t?"":(t+"").replace(pe,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?he.merge(n,"string"==typeof t?[t]:t):se.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(ae)return ae.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,i){var n=i.length,s=t.length,o=0;if("number"==typeof n)for(;n>o;o++)t[s++]=i[o];else for(;i[o]!==e;)t[s++]=i[o++];return t.length=s,t},grep:function(t,e,i){var n,s=[],o=0,a=t.length;for(i=!!i;a>o;o++)n=!!e(t[o],o),i!==n&&s.push(t[o]);return s},map:function(t,e,n){var s,o=0,a=t.length,r=i(t),l=[];if(r)for(;a>o;o++)s=e(t[o],o,n),null!=s&&(l[l.length]=s);else for(o in t)s=e(t[o],o,n),null!=s&&(l[l.length]=s);return ne.apply([],l)},guid:1,proxy:function(t,i){var n,s,o;return"string"==typeof i&&(o=t[i],i=t,t=o),he.isFunction(t)?(n=oe.call(arguments,2),s=function(){return t.apply(i||this,n.concat(oe.call(arguments)))},s.guid=t.guid=t.guid||he.guid++,s):e},access:function(t,i,n,s,o,a,r){var l=0,c=t.length,h=null==n;if("object"===he.type(n)){o=!0;for(l in n)he.access(t,i,l,n[l],!0,a,r)}else if(s!==e&&(o=!0,he.isFunction(s)||(r=!0),h&&(r?(i.call(t,s),i=null):(h=i,i=function(t,e,i){return h.call(he(t),i)})),i))for(;c>l;l++)i(t[l],n,r?s:s.call(t[l],l,i(t[l],n)));return o?t:h?i.call(t):c?i(t[0],n):a},now:function(){return(new Date).getTime()},swap:function(t,e,i,n){var s,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];s=i.apply(t,n||[]);for(o in e)t.style[o]=a[o];return s}}),he.ready.promise=function(e){if(!V)if(V=he.Deferred(),"complete"===Q.readyState)setTimeout(he.ready);else if(Q.addEventListener)Q.addEventListener("DOMContentLoaded",ke,!1),t.addEventListener("load",ke,!1);else{Q.attachEvent("onreadystatechange",ke),t.attachEvent("onload",ke);var i=!1;try{i=null==t.frameElement&&Q.documentElement}catch(n){}i&&i.doScroll&&!function s(){if(!he.isReady){try{i.doScroll("left")}catch(t){return setTimeout(s,50)}Ce(),he.ready()}}()}return V.promise(e)},he.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){te["[object "+e+"]"]=e.toLowerCase()}),Y=he(Q),function(t,e){function i(t,e,i,n){var s,o,a,r,l,c,h,u,f,m;if((e?e.ownerDocument||e:H)!==F&&E(e),e=e||F,i=i||[],!t||"string"!=typeof t)return i;if(1!==(r=e.nodeType)&&9!==r)return[];if(I&&!n){if(s=_e.exec(t))if(a=s[1]){if(9===r){if(o=e.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&O(e,o)&&o.id===a)return i.push(o),i}else{if(s[2])return te.apply(i,e.getElementsByTagName(t)),i;if((a=s[3])&&k.getElementsByClassName&&e.getElementsByClassName)return te.apply(i,e.getElementsByClassName(a)),i}if(k.qsa&&(!z||!z.test(t))){if(u=h=L,f=e,m=9===r&&t,1===r&&"object"!==e.nodeName.toLowerCase()){for(c=d(t),(h=e.getAttribute("id"))?u=h.replace(xe,"\\$&"):e.setAttribute("id",u),u="[id='"+u+"'] ",l=c.length;l--;)c[l]=u+p(c[l]);f=pe.test(t)&&e.parentNode||e,m=c.join(",")}if(m)try{return te.apply(i,f.querySelectorAll(m)),i}catch(g){}finally{h||e.removeAttribute("id")}}}return w(t.replace(ce,"$1"),e,i,n)}function n(){function t(i,n){return e.push(i+=" ")>D.cacheLength&&delete t[e.shift()],t[i]=n}var e=[];return t}function s(t){return t[L]=!0,t}function o(t){var e=F.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function a(t,e){for(var i=t.split("|"),n=t.length;n--;)D.attrHandle[i[n]]=e}function r(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||X)-(~t.sourceIndex||X);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function l(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function c(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function h(t){return s(function(e){return e=+e,s(function(i,n){for(var s,o=t([],i.length,e),a=o.length;a--;)i[s=o[a]]&&(i[s]=!(n[s]=i[s]))})})}function u(){}function d(t,e){var n,s,o,a,r,l,c,h=B[t+" "];if(h)return e?0:h.slice(0);for(r=t,l=[],c=D.preFilter;r;){(!n||(s=ue.exec(r)))&&(s&&(r=r.slice(s[0].length)||r),l.push(o=[])),n=!1,(s=de.exec(r))&&(n=s.shift(),o.push({value:n,type:s[0].replace(ce," ")}),r=r.slice(n.length));for(a in D.filter)!(s=ve[a].exec(r))||c[a]&&!(s=c[a](s))||(n=s.shift(),o.push({value:n,type:a,matches:s}),r=r.slice(n.length));if(!n)break}return e?r.length:r?i.error(t):B(t,l).slice(0)}function p(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function f(t,e,i){var n=e.dir,s=i&&"parentNode"===n,o=q++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,o)}:function(e,i,a){var r,l,c,h=R+" "+o;if(a){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(c=e[L]||(e[L]={}),(l=c[n])&&l[0]===h){if((r=l[1])===!0||r===C)return r===!0}else if(l=c[n]=[h],l[1]=t(e,i,a)||C,l[1]===!0)return!0}}function m(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function g(t,e,i,n,s){for(var o,a=[],r=0,l=t.length,c=null!=e;l>r;r++)(o=t[r])&&(!i||i(o,n,s))&&(a.push(o),c&&e.push(r));return a}function v(t,e,i,n,o,a){return n&&!n[L]&&(n=v(n)),o&&!o[L]&&(o=v(o,a)),s(function(s,a,r,l){var c,h,u,d=[],p=[],f=a.length,m=s||b(e||"*",r.nodeType?[r]:r,[]),v=!t||!s&&e?m:g(m,d,t,r,l),y=i?o||(s?t:f||n)?[]:a:v;if(i&&i(v,y,r,l),n)for(c=g(y,p),n(c,[],r,l),h=c.length;h--;)(u=c[h])&&(y[p[h]]=!(v[p[h]]=u));if(s){if(o||t){if(o){for(c=[],h=y.length;h--;)(u=y[h])&&c.push(v[h]=u);o(null,y=[],c,l)}for(h=y.length;h--;)(u=y[h])&&(c=o?ie.call(s,u):d[h])>-1&&(s[c]=!(a[c]=u))}}else y=g(y===a?y.splice(f,y.length):y),o?o(null,a,y,l):te.apply(a,y)})}function y(t){for(var e,i,n,s=t.length,o=D.relative[t[0].type],a=o||D.relative[" "],r=o?1:0,l=f(function(t){return t===e},a,!0),c=f(function(t){return ie.call(e,t)>-1},a,!0),h=[function(t,i,n){return!o&&(n||i!==$)||((e=i).nodeType?l(t,i,n):c(t,i,n))}];s>r;r++)if(i=D.relative[t[r].type])h=[f(m(h),i)];else{if(i=D.filter[t[r].type].apply(null,t[r].matches),i[L]){for(n=++r;s>n&&!D.relative[t[n].type];n++);return v(r>1&&m(h),r>1&&p(t.slice(0,r-1).concat({value:" "===t[r-2].type?"*":""})).replace(ce,"$1"),i,n>r&&y(t.slice(r,n)),s>n&&y(t=t.slice(n)),s>n&&p(t))}h.push(i)}return m(h)}function _(t,e){var n=0,o=e.length>0,a=t.length>0,r=function(s,r,l,c,h){var u,d,p,f=[],m=0,v="0",y=s&&[],_=null!=h,b=$,w=s||a&&D.find.TAG("*",h&&r.parentNode||r),x=R+=null==b?1:Math.random()||.1;for(_&&($=r!==F&&r,C=n);null!=(u=w[v]);v++){if(a&&u){for(d=0;p=t[d++];)if(p(u,r,l)){c.push(u);break}_&&(R=x,C=++n)}o&&((u=!p&&u)&&m--,s&&y.push(u))}if(m+=v,o&&v!==m){for(d=0;p=e[d++];)p(y,f,r,l);if(s){if(m>0)for(;v--;)y[v]||f[v]||(f[v]=G.call(c));f=g(f)}te.apply(c,f),_&&!s&&f.length>0&&m+e.length>1&&i.uniqueSort(c)}return _&&(R=x,$=b),y};return o?s(r):r}function b(t,e,n){for(var s=0,o=e.length;o>s;s++)i(t,e[s],n);return n}function w(t,e,i,n){var s,o,a,r,l,c=d(t);if(!n&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&k.getById&&9===e.nodeType&&I&&D.relative[o[1].type]){if(e=(D.find.ID(a.matches[0].replace(ke,Ce),e)||[])[0],!e)return i;t=t.slice(o.shift().value.length)}for(s=ve.needsContext.test(t)?0:o.length;s--&&(a=o[s],!D.relative[r=a.type]);)if((l=D.find[r])&&(n=l(a.matches[0].replace(ke,Ce),pe.test(o[0].type)&&e.parentNode||e))){if(o.splice(s,1),t=n.length&&p(o),!t)return te.apply(i,n),i;break}}return S(t,c)(n,e,!I,i,pe.test(t)),i}var x,k,C,D,T,j,S,$,N,E,F,M,I,z,P,A,O,L="sizzle"+-new Date,H=t.document,R=0,q=0,W=n(),B=n(),U=n(),V=!1,Y=function(t,e){return t===e?(V=!0,0):0},K=typeof e,X=1<<31,Q={}.hasOwnProperty,Z=[],G=Z.pop,J=Z.push,te=Z.push,ee=Z.slice,ie=Z.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},ne="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",se="[\\x20\\t\\r\\n\\f]",oe="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ae=oe.replace("w","w#"),re="\\["+se+"*("+oe+")"+se+"*(?:([*^$|!~]?=)"+se+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ae+")|)|)"+se+"*\\]",le=":("+oe+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+re.replace(3,8)+")*)|.*)\\)|)",ce=new RegExp("^"+se+"+|((?:^|[^\\\\])(?:\\\\.)*)"+se+"+$","g"),ue=new RegExp("^"+se+"*,"+se+"*"),de=new RegExp("^"+se+"*([>+~]|"+se+")"+se+"*"),pe=new RegExp(se+"*[+~]"),fe=new RegExp("="+se+"*([^\\]'\"]*)"+se+"*\\]","g"),me=new RegExp(le),ge=new RegExp("^"+ae+"$"),ve={ID:new RegExp("^#("+oe+")"),CLASS:new RegExp("^\\.("+oe+")"),TAG:new RegExp("^("+oe.replace("w","w*")+")"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+le),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+se+"*(even|odd|(([+-]|)(\\d*)n|)"+se+"*(?:([+-]|)"+se+"*(\\d+)|))"+se+"*\\)|)","i"),bool:new RegExp("^(?:"+ne+")$","i"),needsContext:new RegExp("^"+se+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+se+"*((?:-\\d)?\\d*)"+se+"*\\)|)(?=[^-]|$)","i")},ye=/^[^{]+\{\s*\[native \w/,_e=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/^(?:input|select|textarea|button)$/i,we=/^h\d$/i,xe=/'|\\/g,ke=new RegExp("\\\\([\\da-f]{1,6}"+se+"?|("+se+")|.)","ig"),Ce=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{te.apply(Z=ee.call(H.childNodes),H.childNodes),Z[H.childNodes.length].nodeType}catch(De){te={apply:Z.length?function(t,e){J.apply(t,ee.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}j=i.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},k=i.support={},E=i.setDocument=function(t){var e=t?t.ownerDocument||t:H,i=e.defaultView;return e!==F&&9===e.nodeType&&e.documentElement?(F=e,M=e.documentElement,I=!j(e),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){E()}),k.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),k.getElementsByTagName=o(function(t){return t.appendChild(e.createComment("")),!t.getElementsByTagName("*").length}),k.getElementsByClassName=o(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),k.getById=o(function(t){return M.appendChild(t).id=L,!e.getElementsByName||!e.getElementsByName(L).length}),k.getById?(D.find.ID=function(t,e){if(typeof e.getElementById!==K&&I){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},D.filter.ID=function(t){var e=t.replace(ke,Ce);return function(t){return t.getAttribute("id")===e}}):(delete D.find.ID,D.filter.ID=function(t){var e=t.replace(ke,Ce);return function(t){var i=typeof t.getAttributeNode!==K&&t.getAttributeNode("id");return i&&i.value===e}}),D.find.TAG=k.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==K?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],s=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[s++];)1===i.nodeType&&n.push(i);return n}return o},D.find.CLASS=k.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==K&&I?e.getElementsByClassName(t):void 0},P=[],z=[],(k.qsa=ye.test(e.querySelectorAll))&&(o(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||z.push("\\["+se+"*(?:value|"+ne+")"),t.querySelectorAll(":checked").length||z.push(":checked")}),o(function(t){var i=e.createElement("input");i.setAttribute("type","hidden"),t.appendChild(i).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&z.push("[*^$]="+se+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||z.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),z.push(",.*:")})),(k.matchesSelector=ye.test(A=M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(t){k.disconnectedMatch=A.call(t,"div"),A.call(t,"[s!='']:x"),P.push("!=",le)}),z=z.length&&new RegExp(z.join("|")),P=P.length&&new RegExp(P.join("|")),O=ye.test(M.contains)||M.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},Y=M.compareDocumentPosition?function(t,i){if(t===i)return V=!0,0;var n=i.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(i);return n?1&n||!k.sortDetached&&i.compareDocumentPosition(t)===n?t===e||O(H,t)?-1:i===e||O(H,i)?1:N?ie.call(N,t)-ie.call(N,i):0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,i){var n,s=0,o=t.parentNode,a=i.parentNode,l=[t],c=[i];if(t===i)return V=!0,0;if(!o||!a)return t===e?-1:i===e?1:o?-1:a?1:N?ie.call(N,t)-ie.call(N,i):0;if(o===a)return r(t,i);for(n=t;n=n.parentNode;)l.unshift(n);for(n=i;n=n.parentNode;)c.unshift(n);for(;l[s]===c[s];)s++;return s?r(l[s],c[s]):l[s]===H?-1:c[s]===H?1:0},e):F},i.matches=function(t,e){return i(t,null,null,e)},i.matchesSelector=function(t,e){if((t.ownerDocument||t)!==F&&E(t),e=e.replace(fe,"='$1']"),!(!k.matchesSelector||!I||P&&P.test(e)||z&&z.test(e)))try{var n=A.call(t,e);if(n||k.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(s){}return i(e,F,null,[t]).length>0},i.contains=function(t,e){return(t.ownerDocument||t)!==F&&E(t),O(t,e)},i.attr=function(t,i){(t.ownerDocument||t)!==F&&E(t);var n=D.attrHandle[i.toLowerCase()],s=n&&Q.call(D.attrHandle,i.toLowerCase())?n(t,i,!I):e;return s===e?k.attributes||!I?t.getAttribute(i):(s=t.getAttributeNode(i))&&s.specified?s.value:null:s},i.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},i.uniqueSort=function(t){var e,i=[],n=0,s=0;if(V=!k.detectDuplicates,N=!k.sortStable&&t.slice(0),t.sort(Y),V){for(;e=t[s++];)e===t[s]&&(n=i.push(s));for(;n--;)t.splice(i[n],1)}return t},T=i.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=T(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n];n++)i+=T(e);return i},D=i.selectors={cacheLength:50,createPseudo:s,match:ve,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(ke,Ce),t[3]=(t[4]||t[5]||"").replace(ke,Ce),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||i.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&i.error(t[0]),t},PSEUDO:function(t){var i,n=!t[5]&&t[2];return ve.CHILD.test(t[0])?null:(t[3]&&t[4]!==e?t[2]=t[4]:n&&me.test(n)&&(i=d(n,!0))&&(i=n.indexOf(")",n.length-i)-n.length)&&(t[0]=t[0].slice(0,i),t[2]=n.slice(0,i)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(ke,Ce).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+se+")"+t+"("+se+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==K&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(s){var o=i.attr(s,t);return null==o?"!="===e:e?(o+="","="===e?o===n:"!="===e?o!==n:"^="===e?n&&0===o.indexOf(n):"*="===e?n&&o.indexOf(n)>-1:"$="===e?n&&o.slice(-n.length)===n:"~="===e?(" "+o+" ").indexOf(n)>-1:"|="===e?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,s){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),r="of-type"===e;
return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,l){var c,h,u,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=r&&e.nodeName.toLowerCase(),y=!l&&!r;if(g){if(o){for(;m;){for(u=e;u=u[m];)if(r?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(h=g[L]||(g[L]={}),c=h[t]||[],p=c[0]===R&&c[1],d=c[0]===R&&c[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(d=p=0)||f.pop();)if(1===u.nodeType&&++d&&u===e){h[t]=[R,p,d];break}}else if(y&&(c=(e[L]||(e[L]={}))[t])&&c[0]===R)d=c[1];else for(;(u=++p&&u&&u[m]||(d=p=0)||f.pop())&&((r?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[L]||(u[L]={}))[t]=[R,d]),u!==e)););return d-=s,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,e){var n,o=D.pseudos[t]||D.setFilters[t.toLowerCase()]||i.error("unsupported pseudo: "+t);return o[L]?o(e):o.length>1?(n=[t,t,"",e],D.setFilters.hasOwnProperty(t.toLowerCase())?s(function(t,i){for(var n,s=o(t,e),a=s.length;a--;)n=ie.call(t,s[a]),t[n]=!(i[n]=s[a])}):function(t){return o(t,0,n)}):o}},pseudos:{not:s(function(t){var e=[],i=[],n=S(t.replace(ce,"$1"));return n[L]?s(function(t,e,i,s){for(var o,a=n(t,null,s,[]),r=t.length;r--;)(o=a[r])&&(t[r]=!(e[r]=o))}):function(t,s,o){return e[0]=t,n(e,null,o,i),!i.pop()}}),has:s(function(t){return function(e){return i(t,e).length>0}}),contains:s(function(t){return function(e){return(e.textContent||e.innerText||T(e)).indexOf(t)>-1}}),lang:s(function(t){return ge.test(t||"")||i.error("unsupported lang: "+t),t=t.replace(ke,Ce).toLowerCase(),function(e){var i;do if(i=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===M},focus:function(t){return t===F.activeElement&&(!F.hasFocus||F.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!D.pseudos.empty(t)},header:function(t){return we.test(t.nodeName)},input:function(t){return be.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:h(function(){return[0]}),last:h(function(t,e){return[e-1]}),eq:h(function(t,e,i){return[0>i?i+e:i]}),even:h(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:h(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:h(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:h(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},D.pseudos.nth=D.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})D.pseudos[x]=l(x);for(x in{submit:!0,reset:!0})D.pseudos[x]=c(x);u.prototype=D.filters=D.pseudos,D.setFilters=new u,S=i.compile=function(t,e){var i,n=[],s=[],o=U[t+" "];if(!o){for(e||(e=d(t)),i=e.length;i--;)o=y(e[i]),o[L]?n.push(o):s.push(o);o=U(t,_(s,n))}return o},k.sortStable=L.split("").sort(Y).join("")===L,k.detectDuplicates=V,E(),k.sortDetached=o(function(t){return 1&t.compareDocumentPosition(F.createElement("div"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||a("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),k.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||a("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||a(ne,function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&n.specified?n.value:t[e]===!0?e.toLowerCase():null}),he.find=i,he.expr=i.selectors,he.expr[":"]=he.expr.pseudos,he.unique=i.uniqueSort,he.text=i.getText,he.isXMLDoc=i.isXML,he.contains=i.contains}(t);var De={};he.Callbacks=function(t){t="string"==typeof t?De[t]||n(t):he.extend({},t);var i,s,o,a,r,l,c=[],h=!t.once&&[],u=function(e){for(s=t.memory&&e,o=!0,r=l||0,l=0,a=c.length,i=!0;c&&a>r;r++)if(c[r].apply(e[0],e[1])===!1&&t.stopOnFalse){s=!1;break}i=!1,c&&(h?h.length&&u(h.shift()):s?c=[]:d.disable())},d={add:function(){if(c){var e=c.length;!function n(e){he.each(e,function(e,i){var s=he.type(i);"function"===s?t.unique&&d.has(i)||c.push(i):i&&i.length&&"string"!==s&&n(i)})}(arguments),i?a=c.length:s&&(l=e,u(s))}return this},remove:function(){return c&&he.each(arguments,function(t,e){for(var n;(n=he.inArray(e,c,n))>-1;)c.splice(n,1),i&&(a>=n&&a--,r>=n&&r--)}),this},has:function(t){return t?he.inArray(t,c)>-1:!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=h=s=e,this},disabled:function(){return!c},lock:function(){return h=e,s||d.disable(),this},locked:function(){return!h},fireWith:function(t,e){return!c||o&&!h||(e=e||[],e=[t,e.slice?e.slice():e],i?h.push(e):u(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!o}};return d},he.extend({Deferred:function(t){var e=[["resolve","done",he.Callbacks("once memory"),"resolved"],["reject","fail",he.Callbacks("once memory"),"rejected"],["notify","progress",he.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return he.Deferred(function(i){he.each(e,function(e,o){var a=o[0],r=he.isFunction(t[e])&&t[e];s[o[1]](function(){var t=r&&r.apply(this,arguments);t&&he.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a+"With"](this===n?i.promise():this,r?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?he.extend(t,n):n}},s={};return n.pipe=n.then,he.each(e,function(t,o){var a=o[2],r=o[3];n[o[1]]=a.add,r&&a.add(function(){i=r},e[1^t][2].disable,e[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?n:this,arguments),this},s[o[0]+"With"]=a.fireWith}),n.promise(s),t&&t.call(s,s),s},when:function(t){var e,i,n,s=0,o=oe.call(arguments),a=o.length,r=1!==a||t&&he.isFunction(t.promise)?a:0,l=1===r?t:he.Deferred(),c=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?oe.call(arguments):s,n===e?l.notifyWith(i,n):--r||l.resolveWith(i,n)}};if(a>1)for(e=new Array(a),i=new Array(a),n=new Array(a);a>s;s++)o[s]&&he.isFunction(o[s].promise)?o[s].promise().done(c(s,n,o)).fail(l.reject).progress(c(s,i,e)):--r;return r||l.resolveWith(n,o),l.promise()}}),he.support=function(e){var i,n,s,o,a,r,l,c,h,u=Q.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=u.getElementsByTagName("*")||[],n=u.getElementsByTagName("a")[0],!n||!n.style||!i.length)return e;o=Q.createElement("select"),r=o.appendChild(Q.createElement("option")),s=u.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",e.getSetAttribute="t"!==u.className,e.leadingWhitespace=3===u.firstChild.nodeType,e.tbody=!u.getElementsByTagName("tbody").length,e.htmlSerialize=!!u.getElementsByTagName("link").length,e.style=/top/.test(n.getAttribute("style")),e.hrefNormalized="/a"===n.getAttribute("href"),e.opacity=/^0.5/.test(n.style.opacity),e.cssFloat=!!n.style.cssFloat,e.checkOn=!!s.value,e.optSelected=r.selected,e.enctype=!!Q.createElement("form").enctype,e.html5Clone="<:nav></:nav>"!==Q.createElement("nav").cloneNode(!0).outerHTML,e.inlineBlockNeedsLayout=!1,e.shrinkWrapBlocks=!1,e.pixelPosition=!1,e.deleteExpando=!0,e.noCloneEvent=!0,e.reliableMarginRight=!0,e.boxSizingReliable=!0,s.checked=!0,e.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,e.optDisabled=!r.disabled;try{delete u.test}catch(d){e.deleteExpando=!1}s=Q.createElement("input"),s.setAttribute("value",""),e.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),e.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),a=Q.createDocumentFragment(),a.appendChild(s),e.appendChecked=s.checked,e.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){e.noCloneEvent=!1}),u.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})u.setAttribute(l="on"+h,"t"),e[h+"Bubbles"]=l in t||u.attributes[l].expando===!1;u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===u.style.backgroundClip;for(h in he(e))break;return e.ownLast="0"!==h,he(function(){var i,n,s,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=Q.getElementsByTagName("body")[0];a&&(i=Q.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(i).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=u.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",e.reliableHiddenOffsets=c&&0===s[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",he.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===u.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(u,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(u,null)||{width:"4px"}).width,n=u.appendChild(Q.createElement("div")),n.style.cssText=u.style.cssText=o,n.style.marginRight=n.style.width="0",u.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(n,null)||{}).marginRight)),typeof u.style.zoom!==K&&(u.innerHTML="",u.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==u.offsetWidth,e.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(i),i=u=s=n=null)}),i=o=a=r=n=s=null,e}({});var Te=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,je=/([A-Z])/g;he.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?he.cache[t[he.expando]]:t[he.expando],!!t&&!r(t)},data:function(t,e,i){return s(t,e,i)},removeData:function(t,e){return o(t,e)},_data:function(t,e,i){return s(t,e,i,!0)},_removeData:function(t,e){return o(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&he.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),he.fn.extend({data:function(t,i){var n,s,o=null,r=0,l=this[0];if(t===e){if(this.length&&(o=he.data(l),1===l.nodeType&&!he._data(l,"parsedAttrs"))){for(n=l.attributes;r<n.length;r++)s=n[r].name,0===s.indexOf("data-")&&(s=he.camelCase(s.slice(5)),a(l,s,o[s]));he._data(l,"parsedAttrs",!0)}return o}return"object"==typeof t?this.each(function(){he.data(this,t)}):arguments.length>1?this.each(function(){he.data(this,t,i)}):l?a(l,t,he.data(l,t)):null},removeData:function(t){return this.each(function(){he.removeData(this,t)})}}),he.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=he._data(t,e),i&&(!n||he.isArray(i)?n=he._data(t,e,he.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=he.queue(t,e),n=i.length,s=i.shift(),o=he._queueHooks(t,e),a=function(){he.dequeue(t,e)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete o.stop,s.call(t,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return he._data(t,i)||he._data(t,i,{empty:he.Callbacks("once memory").add(function(){he._removeData(t,e+"queue"),he._removeData(t,i)})})}}),he.fn.extend({queue:function(t,i){var n=2;return"string"!=typeof t&&(i=t,t="fx",n--),arguments.length<n?he.queue(this[0],t):i===e?this:this.each(function(){var e=he.queue(this,t,i);he._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&he.dequeue(this,t)})},dequeue:function(t){return this.each(function(){he.dequeue(this,t)})},delay:function(t,e){return t=he.fx?he.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var n,s=1,o=he.Deferred(),a=this,r=this.length,l=function(){--s||o.resolveWith(a,[a])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";r--;)n=he._data(a[r],t+"queueHooks"),n&&n.empty&&(s++,n.empty.add(l));return l(),o.promise(i)}});var Se,$e,Ne=/[\t\r\n\f]/g,Ee=/\r/g,Fe=/^(?:input|select|textarea|button|object)$/i,Me=/^(?:a|area)$/i,Ie=/^(?:checked|selected)$/i,ze=he.support.getSetAttribute,Pe=he.support.input;he.fn.extend({attr:function(t,e){return he.access(this,he.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){he.removeAttr(this,t)})},prop:function(t,e){return he.access(this,he.prop,t,e,arguments.length>1)},removeProp:function(t){return t=he.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(i){}})},addClass:function(t){var e,i,n,s,o,a=0,r=this.length,l="string"==typeof t&&t;if(he.isFunction(t))return this.each(function(e){he(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(de)||[];r>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ne," "):" ")){for(o=0;s=e[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");i.className=he.trim(n)}return this},removeClass:function(t){var e,i,n,s,o,a=0,r=this.length,l=0===arguments.length||"string"==typeof t&&t;if(he.isFunction(t))return this.each(function(e){he(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(de)||[];r>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ne," "):"")){for(o=0;s=e[o++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");i.className=t?he.trim(n):""}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(he.isFunction(t)?function(i){he(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,s=he(this),o=t.match(de)||[];e=o[n++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else(i===K||"boolean"===i)&&(this.className&&he._data(this,"__className__",this.className),this.className=this.className||t===!1?"":he._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Ne," ").indexOf(e)>=0)return!0;return!1},val:function(t){var i,n,s,o=this[0];{if(arguments.length)return s=he.isFunction(t),this.each(function(i){var o;1===this.nodeType&&(o=s?t.call(this,i,he(this).val()):t,null==o?o="":"number"==typeof o?o+="":he.isArray(o)&&(o=he.map(o,function(t){return null==t?"":t+""})),n=he.valHooks[this.type]||he.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==e||(this.value=o))});if(o)return n=he.valHooks[o.type]||he.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(o,"value"))!==e?i:(i=o.value,"string"==typeof i?i.replace(Ee,""):null==i?"":i)}}}),he.extend({valHooks:{option:{get:function(t){var e=he.find.attr(t,"value");return null!=e?e:t.text}},select:{get:function(t){for(var e,i,n=t.options,s=t.selectedIndex,o="select-one"===t.type||0>s,a=o?null:[],r=o?s+1:n.length,l=0>s?r:o?s:0;r>l;l++)if(i=n[l],!(!i.selected&&l!==s||(he.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&he.nodeName(i.parentNode,"optgroup"))){if(e=he(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,s=t.options,o=he.makeArray(e),a=s.length;a--;)n=s[a],(n.selected=he.inArray(he(n).val(),o)>=0)&&(i=!0);return i||(t.selectedIndex=-1),o}}},attr:function(t,i,n){var s,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===K?he.prop(t,i,n):(1===a&&he.isXMLDoc(t)||(i=i.toLowerCase(),s=he.attrHooks[i]||(he.expr.match.bool.test(i)?$e:Se)),n===e?s&&"get"in s&&null!==(o=s.get(t,i))?o:(o=he.find.attr(t,i),null==o?e:o):null!==n?s&&"set"in s&&(o=s.set(t,n,i))!==e?o:(t.setAttribute(i,n+""),n):void he.removeAttr(t,i))},removeAttr:function(t,e){var i,n,s=0,o=e&&e.match(de);if(o&&1===t.nodeType)for(;i=o[s++];)n=he.propFix[i]||i,he.expr.match.bool.test(i)?Pe&&ze||!Ie.test(i)?t[n]=!1:t[he.camelCase("default-"+i)]=t[n]=!1:he.attr(t,i,""),t.removeAttribute(ze?i:n)},attrHooks:{type:{set:function(t,e){if(!he.support.radioValue&&"radio"===e&&he.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(t,i,n){var s,o,a,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return a=1!==r||!he.isXMLDoc(t),a&&(i=he.propFix[i]||i,o=he.propHooks[i]),n!==e?o&&"set"in o&&(s=o.set(t,n,i))!==e?s:t[i]=n:o&&"get"in o&&null!==(s=o.get(t,i))?s:t[i]},propHooks:{tabIndex:{get:function(t){var e=he.find.attr(t,"tabindex");return e?parseInt(e,10):Fe.test(t.nodeName)||Me.test(t.nodeName)&&t.href?0:-1}}}}),$e={set:function(t,e,i){return e===!1?he.removeAttr(t,i):Pe&&ze||!Ie.test(i)?t.setAttribute(!ze&&he.propFix[i]||i,i):t[he.camelCase("default-"+i)]=t[i]=!0,i}},he.each(he.expr.match.bool.source.match(/\w+/g),function(t,i){var n=he.expr.attrHandle[i]||he.find.attr;he.expr.attrHandle[i]=Pe&&ze||!Ie.test(i)?function(t,i,s){var o=he.expr.attrHandle[i],a=s?e:(he.expr.attrHandle[i]=e)!=n(t,i,s)?i.toLowerCase():null;return he.expr.attrHandle[i]=o,a}:function(t,i,n){return n?e:t[he.camelCase("default-"+i)]?i.toLowerCase():null}}),Pe&&ze||(he.attrHooks.value={set:function(t,e,i){return he.nodeName(t,"input")?void(t.defaultValue=e):Se&&Se.set(t,e,i)}}),ze||(Se={set:function(t,i,n){var s=t.getAttributeNode(n);return s||t.setAttributeNode(s=t.ownerDocument.createAttribute(n)),s.value=i+="","value"===n||i===t.getAttribute(n)?i:e}},he.expr.attrHandle.id=he.expr.attrHandle.name=he.expr.attrHandle.coords=function(t,i,n){var s;return n?e:(s=t.getAttributeNode(i))&&""!==s.value?s.value:null},he.valHooks.button={get:function(t,i){var n=t.getAttributeNode(i);return n&&n.specified?n.value:e},set:Se.set},he.attrHooks.contenteditable={set:function(t,e,i){Se.set(t,""===e?!1:e,i)}},he.each(["width","height"],function(t,e){he.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),he.support.hrefNormalized||he.each(["href","src"],function(t,e){he.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),he.support.style||(he.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),he.support.optSelected||(he.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),he.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){he.propFix[this.toLowerCase()]=this}),he.support.enctype||(he.propFix.enctype="encoding"),he.each(["radio","checkbox"],function(){he.valHooks[this]={set:function(t,e){return he.isArray(e)?t.checked=he.inArray(he(t).val(),e)>=0:void 0}},he.support.checkOn||(he.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Ae=/^(?:input|select|textarea)$/i,Oe=/^key/,Le=/^(?:mouse|contextmenu)|click/,He=/^(?:focusinfocus|focusoutblur)$/,Re=/^([^.]*)(?:\.(.+)|)$/;he.event={global:{},add:function(t,i,n,s,o){var a,r,l,c,h,u,d,p,f,m,g,v=he._data(t);if(v){for(n.handler&&(c=n,n=c.handler,o=c.selector),n.guid||(n.guid=he.guid++),(r=v.events)||(r=v.events={}),(u=v.handle)||(u=v.handle=function(t){return typeof he===K||t&&he.event.triggered===t.type?e:he.event.dispatch.apply(u.elem,arguments)},u.elem=t),i=(i||"").match(de)||[""],l=i.length;l--;)a=Re.exec(i[l])||[],f=g=a[1],m=(a[2]||"").split(".").sort(),f&&(h=he.event.special[f]||{},f=(o?h.delegateType:h.bindType)||f,h=he.event.special[f]||{},d=he.extend({type:f,origType:g,data:s,handler:n,guid:n.guid,selector:o,needsContext:o&&he.expr.match.needsContext.test(o),namespace:m.join(".")},c),(p=r[f])||(p=r[f]=[],p.delegateCount=0,h.setup&&h.setup.call(t,s,m,u)!==!1||(t.addEventListener?t.addEventListener(f,u,!1):t.attachEvent&&t.attachEvent("on"+f,u))),h.add&&(h.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),he.event.global[f]=!0);t=null}},remove:function(t,e,i,n,s){var o,a,r,l,c,h,u,d,p,f,m,g=he.hasData(t)&&he._data(t);if(g&&(h=g.events)){for(e=(e||"").match(de)||[""],c=e.length;c--;)if(r=Re.exec(e[c])||[],p=m=r[1],f=(r[2]||"").split(".").sort(),p){for(u=he.event.special[p]||{},p=(n?u.delegateType:u.bindType)||p,d=h[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=d.length;o--;)a=d[o],!s&&m!==a.origType||i&&i.guid!==a.guid||r&&!r.test(a.namespace)||n&&n!==a.selector&&("**"!==n||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,u.remove&&u.remove.call(t,a));l&&!d.length&&(u.teardown&&u.teardown.call(t,f,g.handle)!==!1||he.removeEvent(t,p,g.handle),delete h[p])}else for(p in h)he.event.remove(t,p+e[c],i,n,!0);he.isEmptyObject(h)&&(delete g.handle,he._removeData(t,"events"))}},trigger:function(i,n,s,o){var a,r,l,c,h,u,d,p=[s||Q],f=le.call(i,"type")?i.type:i,m=le.call(i,"namespace")?i.namespace.split("."):[];if(l=u=s=s||Q,3!==s.nodeType&&8!==s.nodeType&&!He.test(f+he.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),r=f.indexOf(":")<0&&"on"+f,i=i[he.expando]?i:new he.Event(f,"object"==typeof i&&i),i.isTrigger=o?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=s),n=null==n?[i]:he.makeArray(n,[i]),h=he.event.special[f]||{},o||!h.trigger||h.trigger.apply(s,n)!==!1)){if(!o&&!h.noBubble&&!he.isWindow(s)){for(c=h.delegateType||f,He.test(c+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),u=l;u===(s.ownerDocument||Q)&&p.push(u.defaultView||u.parentWindow||t)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();)i.type=d>1?c:h.bindType||f,a=(he._data(l,"events")||{})[i.type]&&he._data(l,"handle"),a&&a.apply(l,n),a=r&&l[r],a&&he.acceptData(l)&&a.apply&&a.apply(l,n)===!1&&i.preventDefault();if(i.type=f,!o&&!i.isDefaultPrevented()&&(!h._default||h._default.apply(p.pop(),n)===!1)&&he.acceptData(s)&&r&&s[f]&&!he.isWindow(s)){u=s[r],u&&(s[r]=null),he.event.triggered=f;try{s[f]()}catch(g){}he.event.triggered=e,u&&(s[r]=u)}return i.result}},dispatch:function(t){t=he.event.fix(t);var i,n,s,o,a,r=[],l=oe.call(arguments),c=(he._data(this,"events")||{})[t.type]||[],h=he.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,t)!==!1){for(r=he.event.handlers.call(this,t,c),i=0;(o=r[i++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,a=0;(s=o.handlers[a++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(s.namespace))&&(t.handleObj=s,t.data=s.data,n=((he.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l),n!==e&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,t),t.result}},handlers:function(t,i){var n,s,o,a,r=[],l=i.delegateCount,c=t.target;if(l&&c.nodeType&&(!t.button||"click"!==t.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==t.type)){for(o=[],a=0;l>a;a++)s=i[a],n=s.selector+" ",o[n]===e&&(o[n]=s.needsContext?he(n,this).index(c)>=0:he.find(n,this,null,[c]).length),o[n]&&o.push(s);o.length&&r.push({elem:c,handlers:o})}return l<i.length&&r.push({elem:this,handlers:i.slice(l)}),r},fix:function(t){if(t[he.expando])return t;var e,i,n,s=t.type,o=t,a=this.fixHooks[s];for(a||(this.fixHooks[s]=a=Le.test(s)?this.mouseHooks:Oe.test(s)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new he.Event(o),e=n.length;e--;)i=n[e],t[i]=o[i];return t.target||(t.target=o.srcElement||Q),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var n,s,o,a=i.button,r=i.fromElement;return null==t.pageX&&null!=i.clientX&&(s=t.target.ownerDocument||Q,o=s.documentElement,n=s.body,t.pageX=i.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),t.pageY=i.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&r&&(t.relatedTarget=r===t.target?i.toElement:r),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==h()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return he.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return he.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var s=he.extend(new he.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?he.event.trigger(s,null,e):he.event.dispatch.call(e,s),s.isDefaultPrevented()&&i.preventDefault()}},he.removeEvent=Q.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===K&&(t[n]=null),t.detachEvent(n,i))},he.Event=function(t,e){return this instanceof he.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?l:c):this.type=t,e&&he.extend(this,e),this.timeStamp=t&&t.timeStamp||he.now(),void(this[he.expando]=!0)):new he.Event(t,e)},he.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},he.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){he.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,s=t.relatedTarget,o=t.handleObj;return(!s||s!==n&&!he.contains(n,s))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),he.support.submitBubbles||(he.event.special.submit={setup:function(){return he.nodeName(this,"form")?!1:void he.event.add(this,"click._submit keypress._submit",function(t){var i=t.target,n=he.nodeName(i,"input")||he.nodeName(i,"button")?i.form:e;n&&!he._data(n,"submitBubbles")&&(he.event.add(n,"submit._submit",function(t){t._submit_bubble=!0}),he._data(n,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&he.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return he.nodeName(this,"form")?!1:void he.event.remove(this,"._submit")}}),he.support.changeBubbles||(he.event.special.change={setup:function(){return Ae.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(he.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),he.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),he.event.simulate("change",this,t,!0)})),!1):void he.event.add(this,"beforeactivate._change",function(t){var e=t.target;Ae.test(e.nodeName)&&!he._data(e,"changeBubbles")&&(he.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||he.event.simulate("change",this.parentNode,t,!0)}),he._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return he.event.remove(this,"._change"),!Ae.test(this.nodeName)}}),he.support.focusinBubbles||he.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){he.event.simulate(e,t.target,he.event.fix(t),!0)};he.event.special[e]={setup:function(){0===i++&&Q.addEventListener(t,n,!0)},teardown:function(){0===--i&&Q.removeEventListener(t,n,!0)}}}),he.fn.extend({on:function(t,i,n,s,o){var a,r;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=e);for(a in t)this.on(a,i,n,t[a],o);return this}if(null==n&&null==s?(s=i,n=i=e):null==s&&("string"==typeof i?(s=n,n=e):(s=n,n=i,i=e)),s===!1)s=c;else if(!s)return this;return 1===o&&(r=s,s=function(t){return he().off(t),r.apply(this,arguments)},s.guid=r.guid||(r.guid=he.guid++)),this.each(function(){he.event.add(this,t,s,n,i)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,i,n){var s,o;if(t&&t.preventDefault&&t.handleObj)return s=t.handleObj,he(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof t){for(o in t)this.off(o,i,t[o]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=e),n===!1&&(n=c),this.each(function(){he.event.remove(this,t,n,i)})},trigger:function(t,e){return this.each(function(){he.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?he.event.trigger(t,e,i,!0):void 0}});var qe=/^.[^:#\[\.,]*$/,We=/^(?:parents|prev(?:Until|All))/,Be=he.expr.match.needsContext,Ue={children:!0,contents:!0,next:!0,prev:!0};he.fn.extend({find:function(t){var e,i=[],n=this,s=n.length;if("string"!=typeof t)return this.pushStack(he(t).filter(function(){for(e=0;s>e;e++)if(he.contains(n[e],this))return!0}));for(e=0;s>e;e++)he.find(t,n[e],i);return i=this.pushStack(s>1?he.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},has:function(t){var e,i=he(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(he.contains(this,i[e]))return!0})},not:function(t){return this.pushStack(d(this,t||[],!0))},filter:function(t){return this.pushStack(d(this,t||[],!1))},is:function(t){return!!d(this,"string"==typeof t&&Be.test(t)?he(t):t||[],!1).length},closest:function(t,e){for(var i,n=0,s=this.length,o=[],a=Be.test(t)||"string"!=typeof t?he(t,e||this.context):0;s>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&he.find.matchesSelector(i,t))){i=o.push(i);break}return this.pushStack(o.length>1?he.unique(o):o)},index:function(t){return t?"string"==typeof t?he.inArray(this[0],he(t)):he.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?he(t,e):he.makeArray(t&&t.nodeType?[t]:t),n=he.merge(this.get(),i);return this.pushStack(he.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),he.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null
},parents:function(t){return he.dir(t,"parentNode")},parentsUntil:function(t,e,i){return he.dir(t,"parentNode",i)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return he.dir(t,"nextSibling")},prevAll:function(t){return he.dir(t,"previousSibling")},nextUntil:function(t,e,i){return he.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return he.dir(t,"previousSibling",i)},siblings:function(t){return he.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return he.sibling(t.firstChild)},contents:function(t){return he.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:he.merge([],t.childNodes)}},function(t,e){he.fn[t]=function(i,n){var s=he.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=he.filter(n,s)),this.length>1&&(Ue[t]||(s=he.unique(s)),We.test(t)&&(s=s.reverse())),this.pushStack(s)}}),he.extend({filter:function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?he.find.matchesSelector(n,t)?[n]:[]:he.find.matches(t,he.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,i,n){for(var s=[],o=t[i];o&&9!==o.nodeType&&(n===e||1!==o.nodeType||!he(o).is(n));)1===o.nodeType&&s.push(o),o=o[i];return s},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var Ve="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ye=/ jQuery\d+="(?:null|\d+)"/g,Ke=new RegExp("<(?:"+Ve+")[\\s/>]","i"),Xe=/^\s+/,Qe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ze=/<([\w:]+)/,Ge=/<tbody/i,Je=/<|&#?\w+;/,ti=/<(?:script|style|link)/i,ei=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,ni=/^$|\/(?:java|ecma)script/i,si=/^true\/(.*)/,oi=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ai={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:he.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ri=p(Q),li=ri.appendChild(Q.createElement("div"));ai.optgroup=ai.option,ai.tbody=ai.tfoot=ai.colgroup=ai.caption=ai.thead,ai.th=ai.td,he.fn.extend({text:function(t){return he.access(this,function(t){return t===e?he.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Q).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=f(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=f(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?he.filter(t,this):this,s=0;null!=(i=n[s]);s++)e||1!==i.nodeType||he.cleanData(b(i)),i.parentNode&&(e&&he.contains(i.ownerDocument,i)&&v(b(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&he.cleanData(b(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&he.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return he.clone(this,t,e)})},html:function(t){return he.access(this,function(t){var i=this[0]||{},n=0,s=this.length;if(t===e)return 1===i.nodeType?i.innerHTML.replace(Ye,""):e;if(!("string"!=typeof t||ti.test(t)||!he.support.htmlSerialize&&Ke.test(t)||!he.support.leadingWhitespace&&Xe.test(t)||ai[(Ze.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Qe,"<$1></$2>");try{for(;s>n;n++)i=this[n]||{},1===i.nodeType&&(he.cleanData(b(i,!1)),i.innerHTML=t);i=0}catch(o){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=he.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(i){var n=t[e++],s=t[e++];s&&(n&&n.parentNode!==s&&(n=this.nextSibling),he(this).remove(),s.insertBefore(i,n))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){t=ne.apply([],t);var n,s,o,a,r,l,c=0,h=this.length,u=this,d=h-1,p=t[0],f=he.isFunction(p);if(f||!(1>=h||"string"!=typeof p||he.support.checkClone)&&ii.test(p))return this.each(function(n){var s=u.eq(n);f&&(t[0]=p.call(this,n,s.html())),s.domManip(t,e,i)});if(h&&(l=he.buildFragment(t,this[0].ownerDocument,!1,!i&&this),n=l.firstChild,1===l.childNodes.length&&(l=n),n)){for(a=he.map(b(l,"script"),m),o=a.length;h>c;c++)s=l,c!==d&&(s=he.clone(s,!0,!0),o&&he.merge(a,b(s,"script"))),e.call(this[c],s,c);if(o)for(r=a[a.length-1].ownerDocument,he.map(a,g),c=0;o>c;c++)s=a[c],ni.test(s.type||"")&&!he._data(s,"globalEval")&&he.contains(r,s)&&(s.src?he._evalUrl(s.src):he.globalEval((s.text||s.textContent||s.innerHTML||"").replace(oi,"")));l=n=null}return this}}),he.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){he.fn[t]=function(t){for(var i,n=0,s=[],o=he(t),a=o.length-1;a>=n;n++)i=n===a?this:this.clone(!0),he(o[n])[e](i),se.apply(s,i.get());return this.pushStack(s)}}),he.extend({clone:function(t,e,i){var n,s,o,a,r,l=he.contains(t.ownerDocument,t);if(he.support.html5Clone||he.isXMLDoc(t)||!Ke.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(li.innerHTML=t.outerHTML,li.removeChild(o=li.firstChild)),!(he.support.noCloneEvent&&he.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||he.isXMLDoc(t)))for(n=b(o),r=b(t),a=0;null!=(s=r[a]);++a)n[a]&&_(s,n[a]);if(e)if(i)for(r=r||b(t),n=n||b(o),a=0;null!=(s=r[a]);a++)y(s,n[a]);else y(t,o);return n=b(o,"script"),n.length>0&&v(n,!l&&b(t,"script")),n=r=s=null,o},buildFragment:function(t,e,i,n){for(var s,o,a,r,l,c,h,u=t.length,d=p(e),f=[],m=0;u>m;m++)if(o=t[m],o||0===o)if("object"===he.type(o))he.merge(f,o.nodeType?[o]:o);else if(Je.test(o)){for(r=r||d.appendChild(e.createElement("div")),l=(Ze.exec(o)||["",""])[1].toLowerCase(),h=ai[l]||ai._default,r.innerHTML=h[1]+o.replace(Qe,"<$1></$2>")+h[2],s=h[0];s--;)r=r.lastChild;if(!he.support.leadingWhitespace&&Xe.test(o)&&f.push(e.createTextNode(Xe.exec(o)[0])),!he.support.tbody)for(o="table"!==l||Ge.test(o)?"<table>"!==h[1]||Ge.test(o)?0:r:r.firstChild,s=o&&o.childNodes.length;s--;)he.nodeName(c=o.childNodes[s],"tbody")&&!c.childNodes.length&&o.removeChild(c);for(he.merge(f,r.childNodes),r.textContent="";r.firstChild;)r.removeChild(r.firstChild);r=d.lastChild}else f.push(e.createTextNode(o));for(r&&d.removeChild(r),he.support.appendChecked||he.grep(b(f,"input"),w),m=0;o=f[m++];)if((!n||-1===he.inArray(o,n))&&(a=he.contains(o.ownerDocument,o),r=b(d.appendChild(o),"script"),a&&v(r),i))for(s=0;o=r[s++];)ni.test(o.type||"")&&i.push(o);return r=null,d},cleanData:function(t,e){for(var i,n,s,o,a=0,r=he.expando,l=he.cache,c=he.support.deleteExpando,h=he.event.special;null!=(i=t[a]);a++)if((e||he.acceptData(i))&&(s=i[r],o=s&&l[s])){if(o.events)for(n in o.events)h[n]?he.event.remove(i,n):he.removeEvent(i,n,o.handle);l[s]&&(delete l[s],c?delete i[r]:typeof i.removeAttribute!==K?i.removeAttribute(r):i[r]=null,ee.push(s))}},_evalUrl:function(t){return he.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),he.fn.extend({wrapAll:function(t){if(he.isFunction(t))return this.each(function(e){he(this).wrapAll(t.call(this,e))});if(this[0]){var e=he(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return this.each(he.isFunction(t)?function(e){he(this).wrapInner(t.call(this,e))}:function(){var e=he(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=he.isFunction(t);return this.each(function(i){he(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){he.nodeName(this,"body")||he(this).replaceWith(this.childNodes)}).end()}});var ci,hi,ui,di=/alpha\([^)]*\)/i,pi=/opacity\s*=\s*([^)]*)/,fi=/^(top|right|bottom|left)$/,mi=/^(none|table(?!-c[ea]).+)/,gi=/^margin/,vi=new RegExp("^("+ue+")(.*)$","i"),yi=new RegExp("^("+ue+")(?!px)[a-z%]+$","i"),_i=new RegExp("^([+-])=("+ue+")","i"),bi={BODY:"block"},wi={position:"absolute",visibility:"hidden",display:"block"},xi={letterSpacing:0,fontWeight:400},ki=["Top","Right","Bottom","Left"],Ci=["Webkit","O","Moz","ms"];he.fn.extend({css:function(t,i){return he.access(this,function(t,i,n){var s,o,a={},r=0;if(he.isArray(i)){for(o=hi(t),s=i.length;s>r;r++)a[i[r]]=he.css(t,i[r],!1,o);return a}return n!==e?he.style(t,i,n):he.css(t,i)},t,i,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){k(this)?he(this).show():he(this).hide()})}}),he.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ui(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":he.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,n,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,r,l=he.camelCase(i),c=t.style;if(i=he.cssProps[l]||(he.cssProps[l]=x(c,l)),r=he.cssHooks[i]||he.cssHooks[l],n===e)return r&&"get"in r&&(o=r.get(t,!1,s))!==e?o:c[i];if(a=typeof n,"string"===a&&(o=_i.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(he.css(t,i)),a="number"),!(null==n||"number"===a&&isNaN(n)||("number"!==a||he.cssNumber[l]||(n+="px"),he.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),r&&"set"in r&&(n=r.set(t,n,s))===e)))try{c[i]=n}catch(h){}}},css:function(t,i,n,s){var o,a,r,l=he.camelCase(i);return i=he.cssProps[l]||(he.cssProps[l]=x(t.style,l)),r=he.cssHooks[i]||he.cssHooks[l],r&&"get"in r&&(a=r.get(t,!0,n)),a===e&&(a=ui(t,i,s)),"normal"===a&&i in xi&&(a=xi[i]),""===n||n?(o=parseFloat(a),n===!0||he.isNumeric(o)?o||0:a):a}}),t.getComputedStyle?(hi=function(e){return t.getComputedStyle(e,null)},ui=function(t,i,n){var s,o,a,r=n||hi(t),l=r?r.getPropertyValue(i)||r[i]:e,c=t.style;return r&&(""!==l||he.contains(t.ownerDocument,t)||(l=he.style(t,i)),yi.test(l)&&gi.test(i)&&(s=c.width,o=c.minWidth,a=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=r.width,c.width=s,c.minWidth=o,c.maxWidth=a)),l}):Q.documentElement.currentStyle&&(hi=function(t){return t.currentStyle},ui=function(t,i,n){var s,o,a,r=n||hi(t),l=r?r[i]:e,c=t.style;return null==l&&c&&c[i]&&(l=c[i]),yi.test(l)&&!fi.test(i)&&(s=c.left,o=t.runtimeStyle,a=o&&o.left,a&&(o.left=t.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=s,a&&(o.left=a)),""===l?"auto":l}),he.each(["height","width"],function(t,e){he.cssHooks[e]={get:function(t,i,n){return i?0===t.offsetWidth&&mi.test(he.css(t,"display"))?he.swap(t,wi,function(){return j(t,e,n)}):j(t,e,n):void 0},set:function(t,i,n){var s=n&&hi(t);return D(t,i,n?T(t,e,n,he.support.boxSizing&&"border-box"===he.css(t,"boxSizing",!1,s),s):0)}}}),he.support.opacity||(he.cssHooks.opacity={get:function(t,e){return pi.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,s=he.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===he.trim(o.replace(di,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=di.test(o)?o.replace(di,s):o+" "+s)}}),he(function(){he.support.reliableMarginRight||(he.cssHooks.marginRight={get:function(t,e){return e?he.swap(t,{display:"inline-block"},ui,[t,"marginRight"]):void 0}}),!he.support.pixelPosition&&he.fn.position&&he.each(["top","left"],function(t,e){he.cssHooks[e]={get:function(t,i){return i?(i=ui(t,e),yi.test(i)?he(t).position()[e]+"px":i):void 0}}})}),he.expr&&he.expr.filters&&(he.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!he.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||he.css(t,"display"))},he.expr.filters.visible=function(t){return!he.expr.filters.hidden(t)}),he.each({margin:"",padding:"",border:"Width"},function(t,e){he.cssHooks[t+e]={expand:function(i){for(var n=0,s={},o="string"==typeof i?i.split(" "):[i];4>n;n++)s[t+ki[n]+e]=o[n]||o[n-2]||o[0];return s}},gi.test(t)||(he.cssHooks[t+e].set=D)});var Di=/%20/g,Ti=/\[\]$/,ji=/\r?\n/g,Si=/^(?:submit|button|image|reset|file)$/i,$i=/^(?:input|select|textarea|keygen)/i;he.fn.extend({serialize:function(){return he.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=he.prop(this,"elements");return t?he.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!he(this).is(":disabled")&&$i.test(this.nodeName)&&!Si.test(t)&&(this.checked||!ei.test(t))}).map(function(t,e){var i=he(this).val();return null==i?null:he.isArray(i)?he.map(i,function(t){return{name:e.name,value:t.replace(ji,"\r\n")}}):{name:e.name,value:i.replace(ji,"\r\n")}}).get()}}),he.param=function(t,i){var n,s=[],o=function(t,e){e=he.isFunction(e)?e():null==e?"":e,s[s.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=he.ajaxSettings&&he.ajaxSettings.traditional),he.isArray(t)||t.jquery&&!he.isPlainObject(t))he.each(t,function(){o(this.name,this.value)});else for(n in t)N(n,t[n],i,o);return s.join("&").replace(Di,"+")},he.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){he.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),he.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Ni,Ei,Fi=he.now(),Mi=/\?/,Ii=/#.*$/,zi=/([?&])_=[^&]*/,Pi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ai=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Oi=/^(?:GET|HEAD)$/,Li=/^\/\//,Hi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Ri=he.fn.load,qi={},Wi={},Bi="*/".concat("*");try{Ei=X.href}catch(Ui){Ei=Q.createElement("a"),Ei.href="",Ei=Ei.href}Ni=Hi.exec(Ei.toLowerCase())||[],he.fn.load=function(t,i,n){if("string"!=typeof t&&Ri)return Ri.apply(this,arguments);var s,o,a,r=this,l=t.indexOf(" ");return l>=0&&(s=t.slice(l,t.length),t=t.slice(0,l)),he.isFunction(i)?(n=i,i=e):i&&"object"==typeof i&&(a="POST"),r.length>0&&he.ajax({url:t,type:a,dataType:"html",data:i}).done(function(t){o=arguments,r.html(s?he("<div>").append(he.parseHTML(t)).find(s):t)}).complete(n&&function(t,e){r.each(n,o||[t.responseText,e,t])}),this},he.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){he.fn[e]=function(t){return this.on(e,t)}}),he.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ei,type:"GET",isLocal:Ai.test(Ni[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":he.parseJSON,"text xml":he.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?M(M(t,he.ajaxSettings),e):M(he.ajaxSettings,t)},ajaxPrefilter:E(qi),ajaxTransport:E(Wi),ajax:function(t,i){function n(t,i,n,s){var o,u,y,_,w,k=i;2!==b&&(b=2,l&&clearTimeout(l),h=e,r=s||"",x.readyState=t>0?4:0,o=t>=200&&300>t||304===t,n&&(_=I(d,x,n)),_=z(d,_,x,o),o?(d.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(he.lastModified[a]=w),w=x.getResponseHeader("etag"),w&&(he.etag[a]=w)),204===t||"HEAD"===d.type?k="nocontent":304===t?k="notmodified":(k=_.state,u=_.data,y=_.error,o=!y)):(y=k,(t||!k)&&(k="error",0>t&&(t=0))),x.status=t,x.statusText=(i||k)+"",o?m.resolveWith(p,[u,k,x]):m.rejectWith(p,[x,k,y]),x.statusCode(v),v=e,c&&f.trigger(o?"ajaxSuccess":"ajaxError",[x,d,o?u:y]),g.fireWith(p,[x,k]),c&&(f.trigger("ajaxComplete",[x,d]),--he.active||he.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=e),i=i||{};var s,o,a,r,l,c,h,u,d=he.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?he(p):he.event,m=he.Deferred(),g=he.Callbacks("once memory"),v=d.statusCode||{},y={},_={},b=0,w="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!u)for(u={};e=Pi.exec(r);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?r:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return b||(t=_[i]=_[i]||t,y[t]=e),this},overrideMimeType:function(t){return b||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>b)for(e in t)v[e]=[v[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||w;return h&&h.abort(e),n(0,e),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,d.url=((t||d.url||Ei)+"").replace(Ii,"").replace(Li,Ni[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=he.trim(d.dataType||"*").toLowerCase().match(de)||[""],null==d.crossDomain&&(s=Hi.exec(d.url.toLowerCase()),d.crossDomain=!(!s||s[1]===Ni[1]&&s[2]===Ni[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(Ni[3]||("http:"===Ni[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=he.param(d.data,d.traditional)),F(qi,d,i,x),2===b)return x;c=d.global,c&&0===he.active++&&he.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Oi.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(Mi.test(a)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=zi.test(a)?a.replace(zi,"$1_="+Fi++):a+(Mi.test(a)?"&":"?")+"_="+Fi++)),d.ifModified&&(he.lastModified[a]&&x.setRequestHeader("If-Modified-Since",he.lastModified[a]),he.etag[a]&&x.setRequestHeader("If-None-Match",he.etag[a])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Bi+"; q=0.01":""):d.accepts["*"]);for(o in d.headers)x.setRequestHeader(o,d.headers[o]);if(d.beforeSend&&(d.beforeSend.call(p,x,d)===!1||2===b))return x.abort();w="abort";for(o in{success:1,error:1,complete:1})x[o](d[o]);if(h=F(Wi,d,i,x)){x.readyState=1,c&&f.trigger("ajaxSend",[x,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){x.abort("timeout")},d.timeout));try{b=1,h.send(y,n)}catch(k){if(!(2>b))throw k;n(-1,k)}}else n(-1,"No Transport");return x},getJSON:function(t,e,i){return he.get(t,e,i,"json")},getScript:function(t,i){return he.get(t,e,i,"script")}}),he.each(["get","post"],function(t,i){he[i]=function(t,n,s,o){return he.isFunction(n)&&(o=o||s,s=n,n=e),he.ajax({url:t,type:i,dataType:o,data:n,success:s})}}),he.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return he.globalEval(t),t}}}),he.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),he.ajaxTransport("script",function(t){if(t.crossDomain){var i,n=Q.head||he("head")[0]||Q.documentElement;return{send:function(e,s){i=Q.createElement("script"),i.async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,e||s(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(e,!0)}}}});var Vi=[],Yi=/(=)\?(?=&|$)|\?\?/;he.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Vi.pop()||he.expando+"_"+Fi++;return this[t]=!0,t}}),he.ajaxPrefilter("json jsonp",function(i,n,s){var o,a,r,l=i.jsonp!==!1&&(Yi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Yi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=he.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Yi,"$1"+o):i.jsonp!==!1&&(i.url+=(Mi.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return r||he.error(o+" was not called"),r[0]},i.dataTypes[0]="json",a=t[o],t[o]=function(){r=arguments},s.always(function(){t[o]=a,i[o]&&(i.jsonpCallback=n.jsonpCallback,Vi.push(o)),r&&he.isFunction(a)&&a(r[0]),r=a=e}),"script"):void 0});var Ki,Xi,Qi=0,Zi=t.ActiveXObject&&function(){var t;for(t in Ki)Ki[t](e,!0)};he.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&P()||A()}:P,Xi=he.ajaxSettings.xhr(),he.support.cors=!!Xi&&"withCredentials"in Xi,Xi=he.support.ajax=!!Xi,Xi&&he.ajaxTransport(function(i){if(!i.crossDomain||he.support.cors){var n;return{send:function(s,o){var a,r,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(r in i.xhrFields)l[r]=i.xhrFields[r];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");try{for(r in s)l.setRequestHeader(r,s[r])}catch(c){}l.send(i.hasContent&&i.data||null),n=function(t,s){var r,c,h,u;try{if(n&&(s||4===l.readyState))if(n=e,a&&(l.onreadystatechange=he.noop,Zi&&delete Ki[a]),s)4!==l.readyState&&l.abort();else{u={},r=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{h=l.statusText}catch(d){h=""}r||!i.isLocal||i.crossDomain?1223===r&&(r=204):r=u.text?200:404}}catch(p){s||o(-1,p)}u&&o(r,h,u,c)},i.async?4===l.readyState?setTimeout(n):(a=++Qi,Zi&&(Ki||(Ki={},he(t).unload(Zi)),Ki[a]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(e,!0)}}}});var Gi,Ji,tn=/^(?:toggle|show|hide)$/,en=new RegExp("^(?:([+-])=|)("+ue+")([a-z%]*)$","i"),nn=/queueHooks$/,sn=[q],on={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),s=en.exec(e),o=s&&s[3]||(he.cssNumber[t]?"":"px"),a=(he.cssNumber[t]||"px"!==o&&+n)&&en.exec(he.css(i.elem,t)),r=1,l=20;if(a&&a[3]!==o){o=o||a[3],s=s||[],a=+n||1;do r=r||".5",a/=r,he.style(i.elem,t,a+o);while(r!==(r=i.cur()/n)&&1!==r&&--l)}return s&&(a=i.start=+a||+n||0,i.unit=o,i.end=s[1]?a+(s[1]+1)*s[2]:+s[2]),i}]};he.Animation=he.extend(H,{tweener:function(t,e){he.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,s=t.length;s>n;n++)i=t[n],on[i]=on[i]||[],on[i].unshift(e)},prefilter:function(t,e){e?sn.unshift(t):sn.push(t)}}),he.Tween=W,W.prototype={constructor:W,init:function(t,e,i,n,s,o){this.elem=t,this.prop=i,this.easing=s||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(he.cssNumber[i]?"":"px")},cur:function(){var t=W.propHooks[this.prop];return t&&t.get?t.get(this):W.propHooks._default.get(this)},run:function(t){var e,i=W.propHooks[this.prop];return this.pos=e=this.options.duration?he.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):W.propHooks._default.set(this),this}},W.prototype.init.prototype=W.prototype,W.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=he.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){he.fx.step[t.prop]?he.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[he.cssProps[t.prop]]||he.cssHooks[t.prop])?he.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},W.propHooks.scrollTop=W.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},he.each(["toggle","show","hide"],function(t,e){var i=he.fn[e];he.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(B(e,!0),t,n,s)}}),he.fn.extend({fadeTo:function(t,e,i,n){return this.filter(k).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=he.isEmptyObject(t),o=he.speed(e,i,n),a=function(){var e=H(this,he.extend({},t),o);(s||he._data(this,"finish"))&&e.stop(!0)};return a.finish=a,s||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,i,n){var s=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=i,i=t,t=e),i&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=he.timers,a=he._data(this);if(i)a[i]&&a[i].stop&&s(a[i]);else for(i in a)a[i]&&a[i].stop&&nn.test(i)&&s(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));(e||!n)&&he.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=he._data(this),n=i[t+"queue"],s=i[t+"queueHooks"],o=he.timers,a=n?n.length:0;for(i.finish=!0,he.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;a>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),he.each({slideDown:B("show"),slideUp:B("hide"),slideToggle:B("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){he.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),he.speed=function(t,e,i){var n=t&&"object"==typeof t?he.extend({},t):{complete:i||!i&&e||he.isFunction(t)&&t,duration:t,easing:i&&e||e&&!he.isFunction(e)&&e};return n.duration=he.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in he.fx.speeds?he.fx.speeds[n.duration]:he.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){he.isFunction(n.old)&&n.old.call(this),n.queue&&he.dequeue(this,n.queue)},n},he.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},he.timers=[],he.fx=W.prototype.init,he.fx.tick=function(){var t,i=he.timers,n=0;for(Gi=he.now();n<i.length;n++)t=i[n],t()||i[n]!==t||i.splice(n--,1);i.length||he.fx.stop(),Gi=e},he.fx.timer=function(t){t()&&he.timers.push(t)&&he.fx.start()},he.fx.interval=13,he.fx.start=function(){Ji||(Ji=setInterval(he.fx.tick,he.fx.interval))},he.fx.stop=function(){clearInterval(Ji),Ji=null},he.fx.speeds={slow:600,fast:200,_default:400},he.fx.step={},he.expr&&he.expr.filters&&(he.expr.filters.animated=function(t){return he.grep(he.timers,function(e){return t===e.elem}).length}),he.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){he.offset.setOffset(this,t,e)});var i,n,s={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return i=a.documentElement,he.contains(i,o)?(typeof o.getBoundingClientRect!==K&&(s=o.getBoundingClientRect()),n=U(a),{top:s.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:s.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):s},he.offset={setOffset:function(t,e,i){var n=he.css(t,"position");"static"===n&&(t.style.position="relative");var s,o,a=he(t),r=a.offset(),l=he.css(t,"top"),c=he.css(t,"left"),h=("absolute"===n||"fixed"===n)&&he.inArray("auto",[l,c])>-1,u={},d={};h?(d=a.position(),s=d.top,o=d.left):(s=parseFloat(l)||0,o=parseFloat(c)||0),he.isFunction(e)&&(e=e.call(t,i,r)),null!=e.top&&(u.top=e.top-r.top+s),null!=e.left&&(u.left=e.left-r.left+o),"using"in e?e.using.call(t,u):a.css(u)}},he.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===he.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),he.nodeName(t[0],"html")||(i=t.offset()),i.top+=he.css(t[0],"borderTopWidth",!0),i.left+=he.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-he.css(n,"marginTop",!0),left:e.left-i.left-he.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Z;t&&!he.nodeName(t,"html")&&"static"===he.css(t,"position");)t=t.offsetParent;return t||Z})}}),he.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n=/Y/.test(i);he.fn[t]=function(s){return he.access(this,function(t,s,o){var a=U(t);return o===e?a?i in a?a[i]:a.document.documentElement[s]:t[s]:void(a?a.scrollTo(n?he(a).scrollLeft():o,n?o:he(a).scrollTop()):t[s]=o)},t,s,arguments.length,null)}}),he.each({Height:"height",Width:"width"},function(t,i){he.each({padding:"inner"+t,content:i,"":"outer"+t},function(n,s){he.fn[s]=function(s,o){var a=arguments.length&&(n||"boolean"!=typeof s),r=n||(s===!0||o===!0?"margin":"border");return he.access(this,function(i,n,s){var o;return he.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+t],o["scroll"+t],i.body["offset"+t],o["offset"+t],o["client"+t])):s===e?he.css(i,n,r):he.style(i,n,s,r)},i,a?s:e,a,null)}})}),he.fn.size=function(){return this.length},he.fn.andSelf=he.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=he:(t.jQuery=t.$=he,"function"==typeof define&&define.amd&&define("jquery",[],function(){return he}))}(window),function(){var t=this,e=t._,i={},n=Array.prototype,s=Object.prototype,o=Function.prototype,a=n.push,r=n.slice,l=n.concat,c=s.toString,h=s.hasOwnProperty,u=n.forEach,d=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,y=n.indexOf,_=n.lastIndexOf,b=Array.isArray,w=Object.keys,x=o.bind,k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):t._=k,k.VERSION="1.5.2";var C=k.each=k.forEach=function(t,e,n){if(null!=t)if(u&&t.forEach===u)t.forEach(e,n);else if(t.length===+t.length){for(var s=0,o=t.length;o>s;s++)if(e.call(n,t[s],s,t)===i)return}else for(var a=k.keys(t),s=0,o=a.length;o>s;s++)if(e.call(n,t[a[s]],a[s],t)===i)return};k.map=k.collect=function(t,e,i){var n=[];return null==t?n:d&&t.map===d?t.map(e,i):(C(t,function(t,s,o){n.push(e.call(i,t,s,o))}),n)};var D="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),p&&t.reduce===p)return n&&(e=k.bind(e,n)),s?t.reduce(e,i):t.reduce(e);if(C(t,function(t,o,a){s?i=e.call(n,i,t,o,a):(i=t,s=!0)}),!s)throw new TypeError(D);return i},k.reduceRight=k.foldr=function(t,e,i,n){var s=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return n&&(e=k.bind(e,n)),s?t.reduceRight(e,i):t.reduceRight(e);var o=t.length;if(o!==+o){var a=k.keys(t);o=a.length}if(C(t,function(r,l,c){l=a?a[--o]:--o,s?i=e.call(n,i,t[l],l,c):(i=t[l],s=!0)}),!s)throw new TypeError(D);return i},k.find=k.detect=function(t,e,i){var n;return T(t,function(t,s,o){return e.call(i,t,s,o)?(n=t,!0):void 0}),n},k.filter=k.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(C(t,function(t,s,o){e.call(i,t,s,o)&&n.push(t)}),n)},k.reject=function(t,e,i){return k.filter(t,function(t,n,s){return!e.call(i,t,n,s)},i)},k.every=k.all=function(t,e,n){e||(e=k.identity);var s=!0;return null==t?s:g&&t.every===g?t.every(e,n):(C(t,function(t,o,a){return(s=s&&e.call(n,t,o,a))?void 0:i}),!!s)};var T=k.some=k.any=function(t,e,n){e||(e=k.identity);var s=!1;return null==t?s:v&&t.some===v?t.some(e,n):(C(t,function(t,o,a){return s||(s=e.call(n,t,o,a))?i:void 0
}),!!s)};k.contains=k.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):T(t,function(t){return t===e})},k.invoke=function(t,e){var i=r.call(arguments,2),n=k.isFunction(e);return k.map(t,function(t){return(n?e:t[e]).apply(t,i)})},k.pluck=function(t,e){return k.map(t,function(t){return t[e]})},k.where=function(t,e,i){return k.isEmpty(e)?i?void 0:[]:k[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},k.findWhere=function(t,e){return k.where(t,e,!0)},k.max=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return C(t,function(t,s,o){var a=e?e.call(i,t,s,o):t;a>n.computed&&(n={value:t,computed:a})}),n.value},k.min=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return C(t,function(t,s,o){var a=e?e.call(i,t,s,o):t;a<n.computed&&(n={value:t,computed:a})}),n.value},k.shuffle=function(t){var e,i=0,n=[];return C(t,function(t){e=k.random(i++),n[i-1]=n[e],n[e]=t}),n},k.sample=function(t,e,i){return arguments.length<2||i?t[k.random(t.length-1)]:k.shuffle(t).slice(0,Math.max(0,e))};var j=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(t,e,i){var n=j(e);return k.pluck(k.map(t,function(t,e,s){return{value:t,index:e,criteria:n.call(i,t,e,s)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var S=function(t){return function(e,i,n){var s={},o=null==i?k.identity:j(i);return C(e,function(i,a){var r=o.call(n,i,a,e);t(s,r,i)}),s}};k.groupBy=S(function(t,e,i){(k.has(t,e)?t[e]:t[e]=[]).push(i)}),k.indexBy=S(function(t,e,i){t[e]=i}),k.countBy=S(function(t,e){k.has(t,e)?t[e]++:t[e]=1}),k.sortedIndex=function(t,e,i,n){i=null==i?k.identity:j(i);for(var s=i.call(n,e),o=0,a=t.length;a>o;){var r=o+a>>>1;i.call(n,t[r])<s?o=r+1:a=r}return o},k.toArray=function(t){return t?k.isArray(t)?r.call(t):t.length===+t.length?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:r.call(t,0,e)},k.initial=function(t,e,i){return r.call(t,0,t.length-(null==e||i?1:e))},k.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:r.call(t,Math.max(t.length-e,0))},k.rest=k.tail=k.drop=function(t,e,i){return r.call(t,null==e||i?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var $=function(t,e,i){return e&&k.every(t,k.isArray)?l.apply(i,t):(C(t,function(t){k.isArray(t)||k.isArguments(t)?e?a.apply(i,t):$(t,e,i):i.push(t)}),i)};k.flatten=function(t,e){return $(t,e,[])},k.without=function(t){return k.difference(t,r.call(arguments,1))},k.uniq=k.unique=function(t,e,i,n){k.isFunction(e)&&(n=i,i=e,e=!1);var s=i?k.map(t,i,n):t,o=[],a=[];return C(s,function(i,n){(e?n&&a[a.length-1]===i:k.contains(a,i))||(a.push(i),o.push(t[n]))}),o},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(t){var e=r.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.indexOf(e,t)>=0})})},k.difference=function(t){var e=l.apply(n,r.call(arguments,1));return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){for(var t=k.max(k.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=k.pluck(arguments,""+i);return e},k.object=function(t,e){if(null==t)return{};for(var i={},n=0,s=t.length;s>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},k.indexOf=function(t,e,i){if(null==t)return-1;var n=0,s=t.length;if(i){if("number"!=typeof i)return n=k.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,s+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;s>n;n++)if(t[n]===e)return n;return-1},k.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(_&&t.lastIndexOf===_)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var s=n?i:t.length;s--;)if(t[s]===e)return s;return-1},k.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),s=0,o=new Array(n);n>s;)o[s++]=t,t+=i;return o};var N=function(){};k.bind=function(t,e){var i,n;if(x&&t.bind===x)return x.apply(t,r.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return i=r.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(r.call(arguments)));N.prototype=t.prototype;var s=new N;N.prototype=null;var o=t.apply(s,i.concat(r.call(arguments)));return Object(o)===o?o:s}},k.partial=function(t){var e=r.call(arguments,1);return function(){return t.apply(this,e.concat(r.call(arguments)))}},k.bindAll=function(t){var e=r.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return C(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var i={};return e||(e=k.identity),function(){var n=e.apply(this,arguments);return k.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},k.delay=function(t,e){var i=r.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(r.call(arguments,1)))},k.throttle=function(t,e,i){var n,s,o,a=null,r=0;i||(i={});var l=function(){r=i.leading===!1?0:new Date,a=null,o=t.apply(n,s)};return function(){var c=new Date;r||i.leading!==!1||(r=c);var h=e-(c-r);return n=this,s=arguments,0>=h?(clearTimeout(a),a=null,r=c,o=t.apply(n,s)):a||i.trailing===!1||(a=setTimeout(l,h)),o}},k.debounce=function(t,e,i){var n,s,o,a,r;return function(){o=this,s=arguments,a=new Date;var l=function(){var c=new Date-a;e>c?n=setTimeout(l,e-c):(n=null,i||(r=t.apply(o,s)))},c=i&&!n;return n||(n=setTimeout(l,e)),c&&(r=t.apply(o,s)),r}},k.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},k.wrap=function(t,e){return function(){var i=[t];return a.apply(i,arguments),e.apply(this,i)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},k.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},k.keys=w||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)k.has(t,i)&&e.push(i);return e},k.values=function(t){for(var e=k.keys(t),i=e.length,n=new Array(i),s=0;i>s;s++)n[s]=t[e[s]];return n},k.pairs=function(t){for(var e=k.keys(t),i=e.length,n=new Array(i),s=0;i>s;s++)n[s]=[e[s],t[e[s]]];return n},k.invert=function(t){for(var e={},i=k.keys(t),n=0,s=i.length;s>n;n++)e[t[i[n]]]=i[n];return e},k.functions=k.methods=function(t){var e=[];for(var i in t)k.isFunction(t[i])&&e.push(i);return e.sort()},k.extend=function(t){return C(r.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},k.pick=function(t){var e={},i=l.apply(n,r.call(arguments,1));return C(i,function(i){i in t&&(e[i]=t[i])}),e},k.omit=function(t){var e={},i=l.apply(n,r.call(arguments,1));for(var s in t)k.contains(i,s)||(e[s]=t[s]);return e},k.defaults=function(t){return C(r.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var E=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var s=c.call(t);if(s!=c.call(e))return!1;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=i.length;o--;)if(i[o]==t)return n[o]==e;var a=t.constructor,r=e.constructor;if(a!==r&&!(k.isFunction(a)&&a instanceof a&&k.isFunction(r)&&r instanceof r))return!1;i.push(t),n.push(e);var l=0,h=!0;if("[object Array]"==s){if(l=t.length,h=l==e.length)for(;l--&&(h=E(t[l],e[l],i,n)););}else{for(var u in t)if(k.has(t,u)&&(l++,!(h=k.has(e,u)&&E(t[u],e[u],i,n))))break;if(h){for(u in e)if(k.has(e,u)&&!l--)break;h=!l}}return i.pop(),n.pop(),h};k.isEqual=function(t,e){return E(t,e,[],[])},k.isEmpty=function(t){if(null==t)return!0;if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=b||function(t){return"[object Array]"==c.call(t)},k.isObject=function(t){return t===Object(t)},C(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(t){return"function"==typeof t}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return h.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.times=function(t,e,i){for(var n=Array(Math.max(0,t)),s=0;t>s;s++)n[s]=e.call(i,s);return n},k.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var F={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};F.unescape=k.invert(F.escape);var M={escape:new RegExp("["+k.keys(F.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(F.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return null==e?"":(""+e).replace(M[t],function(e){return F[t][e]})}}),k.result=function(t,e){if(null==t)return void 0;var i=t[e];return k.isFunction(i)?i.call(t):i},k.mixin=function(t){C(k.functions(t),function(e){var i=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),O.call(this,i.apply(k,t))}})};var I=0;k.uniqueId=function(t){var e=++I+"";return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var z=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},A=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(t,e,i){var n;i=k.defaults({},i,k.templateSettings);var s=new RegExp([(i.escape||z).source,(i.interpolate||z).source,(i.evaluate||z).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(s,function(e,i,n,s,r){return a+=t.slice(o,r).replace(A,function(t){return"\\"+P[t]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(a+="';\n"+s+"\n__p+='"),o=r+e.length,e}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(r){throw r.source=a,r}if(e)return n(e,k);var l=function(t){return n.call(this,t,k)};return l.source="function("+(i.variable||"obj")+"){\n"+a+"}",l},k.chain=function(t){return k(t).chain()};var O=function(t){return this._chain?k(t).chain():t};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];k.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],O.call(this,i)}}),C(["concat","join","slice"],function(t){var e=n[t];k.prototype[t]=function(){return O.call(this,e.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(t){return function(){var e;return e||t._}}(this)),function(){{var t,e=this,i=e.Backbone,n=[],s=(n.push,n.slice);n.splice}t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.1.0";var o=e._;o||"undefined"==typeof require||(o=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(t,e,i){if(!l(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!l(this,"once",t,[e,i])||!e)return this;var n=this,s=o.once(function(){n.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,i)},off:function(t,e,i){var n,s,a,r,c,h,u,d;if(!this._events||!l(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(r=t?[t]:o.keys(this._events),c=0,h=r.length;h>c;c++)if(t=r[c],a=this._events[t]){if(this._events[t]=n=[],e||i)for(u=0,d=a.length;d>u;u++)s=a[u],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&n.push(s);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!l(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&c(i,e),n&&c(n,arguments),this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((n={})[t._listenId]=t);for(var a in n)t=n[a],t.off(e,i,this),(s||o.isEmpty(t._events))&&delete this._listeningTo[a];return this}},r=/\s+/,l=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(n));return!1}if(r.test(i)){for(var o=i.split(r),a=0,l=o.length;l>a;a++)t[e].apply(t,[o[a]].concat(n));return!1}return!0},c=function(t,e){var i,n=-1,s=t.length,o=e[0],a=e[1],r=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,o);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,o,a);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,o,a,r);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};o.each(h,function(t,e){a[e]=function(e,i,n){var s=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=o.uniqueId("l"));return s[a]=e,n||"object"!=typeof i||(n=this),e[t](i,n,this),this}}),a.bind=a.on,a.unbind=a.off,o.extend(t,a);var u=t.Model=function(t,e){var i=t||{};e||(e={}),this.cid=o.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=o.defaults({},i,o.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};o.extend(u.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return o.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var n,s,a,r,l,c,h,u;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;a=i.unset,l=i.silent,r=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=o.clone(this.attributes),this.changed={}),u=this.attributes,h=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(n in s)e=s[n],o.isEqual(u[n],e)||r.push(n),o.isEqual(h[n],e)?delete this.changed[n]:this.changed[n]=e,a?delete u[n]:u[n]=e;if(!l){r.length&&(this._pending=!0);for(var d=0,p=r.length;p>d;d++)this.trigger("change:"+r[d],this,u[r[d]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,o.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!o.isEmpty(this.changed):o.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1;var e,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var s in t)o.isEqual(n[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),void e.trigger("sync",e,n,t)):!1},P(this,t),this.sync("read",this,t)},save:function(t,e,i){var n,s,a,r=this.attributes;if(null==t||"object"==typeof t?(n=t,i=e):(n={})[t]=e,i=o.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=o.extend({},r,n)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(t){l.attributes=r;var e=l.parse(t,i);return i.wait&&(e=o.extend(n||{},e)),o.isObject(e)&&!l.set(e,i)?!1:(c&&c(l,t,i),void l.trigger("sync",l,t,i))},P(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=n),a=this.sync(s,this,i),n&&i.wait&&(this.attributes=r),a},destroy:function(t){t=t?o.clone(t):{};var e=this,i=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(s){(t.wait||e.isNew())&&n(),i&&i(e,s,t),e.isNew()||e.trigger("sync",e,s,t)},this.isNew())return t.success(),!1;P(this,t);var s=this.sync("delete",this,t);return t.wait||n(),s},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||z();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},o.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=o.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,o.extend(e,{validationError:i})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];o.each(d,function(t){u.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.attributes),o[t].apply(o,e)}});var p=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,o.extend({silent:!0},e))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};o.extend(p.prototype,a,{model:u,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.extend({merge:!1},e,m))},remove:function(t,e){var i=!o.isArray(t);t=i?[t]:o.clone(t),e||(e={});var n,s,a,r;for(n=0,s=t.length;s>n;n++)r=t[n]=this.get(t[n]),r&&(delete this._byId[r.id],delete this._byId[r.cid],a=this.indexOf(r),this.models.splice(a,1),this.length--,e.silent||(e.index=a,r.trigger("remove",r,this,e)),this._removeReference(r));return i?t[0]:t},set:function(t,e){e=o.defaults({},e,f),e.parse&&(t=this.parse(t,e));var i=!o.isArray(t);t=i?t?[t]:[]:o.clone(t);var n,s,a,r,l,c,h,d=e.at,p=this.model,m=this.comparator&&null==d&&e.sort!==!1,g=o.isString(this.comparator)?this.comparator:null,v=[],y=[],_={},b=e.add,w=e.merge,x=e.remove,k=!m&&b&&x?[]:!1;for(n=0,s=t.length;s>n;n++){if(l=t[n],a=l instanceof u?r=l:l[p.prototype.idAttribute],c=this.get(a))x&&(_[c.cid]=!0),w&&(l=l===r?r.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e),m&&!h&&c.hasChanged(g)&&(h=!0)),t[n]=c;else if(b){if(r=t[n]=this._prepareModel(l,e),!r)continue;v.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)}k&&k.push(c||r)}if(x){for(n=0,s=this.length;s>n;++n)_[(r=this.models[n]).cid]||y.push(r);y.length&&this.remove(y,e)}if(v.length||k&&k.length)if(m&&(h=!0),this.length+=v.length,null!=d)for(n=0,s=v.length;s>n;n++)this.models.splice(d+n,0,v[n]);else{k&&(this.models.length=0);var C=k||v;for(n=0,s=C.length;s>n;n++)this.models.push(C[n])}if(h&&this.sort({silent:!0}),!e.silent){for(n=0,s=v.length;s>n;n++)(r=v[n]).trigger("add",r,this,e);(h||k&&k.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),t=this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,o.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,o.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return s.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return o.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),o.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(o.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var s=t.reset?"reset":"set";i[s](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},P(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?o.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,n=e.success;return e.success=function(t,e,s){s.wait&&i.add(t,s),n&&n(t,e,s)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof u)return t.collection||(t.collection=this),t;e=e?o.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];o.each(g,function(t){p.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.models),o[t].apply(o,e)}});var v=["groupBy","countBy","sortBy"];o.each(v,function(t){p.prototype[t]=function(e,i){var n=o.isFunction(e)?e:function(t){return t.get(e)};return o[t](this.models,n,i)}});var y=t.View=function(t){this.cid=o.uniqueId("view"),t||(t={}),o.extend(this,o.pick(t,b)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},_=/^(\S+)\s*(.*)$/,b=["model","collection","el","id","attributes","className","tagName","events"];o.extend(y.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=o.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(o.isFunction(i)||(i=this[t[e]]),i){var n=e.match(_),s=n[1],a=n[2];i=o.bind(i,this),s+=".delegateEvents"+this.cid,""===a?this.$el.on(s,i):this.$el.on(s,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(o.result(this,"el"),!1);else{var e=o.extend({},o.result(this,"attributes"));this.id&&(e.id=o.result(this,"id")),this.className&&(e["class"]=o.result(this,"className"));var i=t.$("<"+o.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,n){var s=x[e];o.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:s,dataType:"json"};if(n.url||(a.url=o.result(i,"url")||z()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),n.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){a.type="POST",n.emulateJSON&&(a.data._method=s);var r=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),r?r.apply(this,arguments):void 0}}"GET"===a.type||n.emulateJSON||(a.processData=!1),"PATCH"===a.type&&w&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(o.extend(a,n));return i.trigger("request",i,l,n),l};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,D=/(\(\?)?:\w+/g,T=/\*\w+/g,j=/[\-{}\[\]+?.,\\\^$|#\s]/g;o.extend(k.prototype,a,{initialize:function(){},route:function(e,i,n){o.isRegExp(e)||(e=this._routeToRegExp(e)),o.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var s=this;return t.history.route(e,function(o){var a=s._extractParameters(e,o);n&&n.apply(s,a),s.trigger.apply(s,["route:"+i].concat(a)),s.trigger("route",i,a),t.history.trigger("route",s,i,a)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=o.result(this,"routes");for(var t,e=o.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(j,"\\$&").replace(C,"(?:$1)?").replace(D,function(t,e){return e?t:"([^/]+)"}).replace(T,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return o.map(i,function(t){return t?decodeURIComponent(t):null})}});var S=t.History=function(){this.handlers=[],o.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,N=/^\/+|\/+$/g,E=/msie [\w.]+/,F=/\/$/,M=/[?#].*$/;S.started=!1,o.extend(S.prototype,a,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(F,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace($,"")},start:function(e){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=o.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),n=document.documentMode,s=E.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(N,"/"),s&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location,r=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!r)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&r&&a.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),S.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),o.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!S.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(M,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),t.history=new S;var I=function(t,e){var i,n=this;i=t&&o.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},o.extend(i,n,e);var s=function(){this.constructor=i};return s.prototype=n.prototype,i.prototype=new s,t&&o.extend(i.prototype,t),i.__super__=n.prototype,i};u.extend=p.extend=k.extend=y.extend=S.extend=I;var z=function(){throw new Error('A "url" property or function must be specified')},P=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}};t.View=function(t){return t.extend({constructor:function(e){this.options=e||{},t.apply(this,arguments)}})}(t.View)}.call(this),define("backbone",["underscore","jquery"],function(t){return function(){var e;return e||t.Backbone}}(this)),function(t,e){if("function"==typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(t,i){return e(t,i)});else if("undefined"!=typeof exports){var i=require("backbone"),n=require("underscore");module.exports=e(i,n)}else e(t.Backbone,t._)}(this,function(t,e){var i=t.Wreqr,n=t.Wreqr={};return t.Wreqr.VERSION="1.3.1",t.Wreqr.noConflict=function(){return t.Wreqr=i,this},n.Handlers=function(t,e){var i=function(t){this.options=t,this._wreqrHandlers={},e.isFunction(this.initialize)&&this.initialize(t)};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events,{setHandlers:function(t){e.each(t,function(t,i){var n=null;e.isObject(t)&&!e.isFunction(t)&&(n=t.context,t=t.callback),this.setHandler(i,t,n)},this)},setHandler:function(t,e,i){var n={callback:e,context:i};this._wreqrHandlers[t]=n,this.trigger("handler:add",t,e,i)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(e)return function(){var t=Array.prototype.slice.apply(arguments);
return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),i}(t,e),n.CommandStorage=function(){var i=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(i.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){var i=this.getCommands(t);i.instances.push(e)},clearCommands:function(t){var e=this.getCommands(t);e.instances=[]}}),i}(),n.Commands=function(t){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var i=Array.prototype.slice.call(arguments);t.Handlers.prototype.constructor.apply(this,i)},execute:function(t,e){t=arguments[0],e=Array.prototype.slice.call(arguments,1),this.hasHandler(t)?this.getHandler(t).apply(this,e):this.storage.addCommand(t,e)},_executeCommands:function(t,i,n){var s=this.storage.getCommands(t);e.each(s.instances,function(t){i.apply(n,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var i,n=t.storageType||this.storageType;i=e.isFunction(n)?new n:n,this.storage=i}})}(n),n.RequestResponse=function(t){return t.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.hasHandler(t)?this.getHandler(t).apply(this,e):void 0}})}(n),n.EventAggregator=function(t,e){var i=function(){};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events),i}(t,e),n.Channel=function(){var i=function(e){this.vent=new t.Wreqr.EventAggregator,this.reqres=new t.Wreqr.RequestResponse,this.commands=new t.Wreqr.Commands,this.channelName=e};return e.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(t,e){return this._connect("vent",t,e),this},connectCommands:function(t,e){return this._connect("commands",t,e),this},connectRequests:function(t,e){return this._connect("reqres",t,e),this},_connect:function(t,i,n){if(i){n=n||this;var s="vent"===t?"on":"setHandler";e.each(i,function(i,o){this[t][s](o,e.bind(i,n))},this)}}}),i}(n),n.radio=function(t){var i=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};e.extend(i.prototype,{channel:function(t){if(!t)throw new Error("Channel must receive a name");return this._getChannel(t)},_getChannel:function(e){var i=this._channels[e];return i||(i=new t.Channel(e),this._channels[e]=i),i},_proxyMethods:function(){e.each(["vent","commands","reqres"],function(t){e.each(n[t],function(e){this[t][e]=s(this,t,e)},this)},this)}});var n={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},s=function(t,e,i){return function(n){var s=t._getChannel(n)[e],o=Array.prototype.slice.call(arguments,1);return s[i].apply(s,o)}};return new i}(n),t.Wreqr}),function(t,e){if("object"==typeof exports){var i=require("underscore"),n=require("backbone");module.exports=e(i,n)}else"function"==typeof define&&define.amd&&define("backbone.babysitter",["underscore","backbone"],e)}(this,function(t,e){"option strict";return e.ChildViewContainer=function(t,e){var i=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(i.prototype,{add:function(t,e){var i=t.cid;return this._views[i]=t,t.model&&(this._indexByModel[t.model.cid]=i),e&&(this._indexByCustom[e]=i),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var i=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,function(t,e){return t===i?(delete this._indexByCustom[e],!0):void 0},this),delete this._views[i],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,i){e.each(this._views,function(n){e.isFunction(n[t])&&n[t].apply(n,i||[])})},_updateLength:function(){this.length=e.size(this._views)}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return e.each(n,function(t){i.prototype[t]=function(){var i=e.values(this._views),n=[i].concat(e.toArray(arguments));return e[t].apply(e,n)}}),i}(e,t),e.ChildViewContainer}),function(t,e){if("object"==typeof exports){var i=require("underscore"),n=require("backbone"),s=require("backbone.wreqr"),o=require("backbone.babysitter");module.exports=e(i,n,s,o)}else"function"==typeof define&&define.amd&&define("marionette",["underscore","backbone","backbone.wreqr","backbone.babysitter"],e)}(this,function(t,e){!function(t,e,i){function n(t){return a.call(t)}function s(t,e){var i=new Error(t);throw i.name=e||"Error",i}var o={};e.Marionette=o,o.$=e.$;var a=Array.prototype.slice;return o.extend=e.Model.extend,o.getOption=function(t,e){if(t&&e){var i;return i=t.options&&e in t.options&&void 0!==t.options[e]?t.options[e]:t[e]}},o.normalizeMethods=function(t){var e,n={};return i.each(t,function(t,s){e=t,i.isFunction(e)||(e=this[e]),e&&(n[s]=e)},this),n},o.triggerMethod=function(){function t(t,e,i){return i.toUpperCase()}var e=/(^|:)(\w)/gi,n=function(n){var s="on"+n.replace(e,t),o=this[s];return i.isFunction(this.trigger)&&this.trigger.apply(this,arguments),i.isFunction(o)?o.apply(this,i.tail(arguments)):void 0};return n}(),o.MonitorDOMRefresh=function(t){function e(t){t._isShown=!0,s(t)}function n(t){t._isRendered=!0,s(t)}function s(t){t._isShown&&t._isRendered&&o(t)&&i.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}function o(e){return t.contains(e.el)}return function(t){t.listenTo(t,"show",function(){e(t)}),t.listenTo(t,"render",function(){n(t)})}}(document.documentElement),function(t){function e(t,e,n,o){var a=o.split(/\s+/);i.each(a,function(i){var o=t[i];o||s("Method '"+i+"' was configured as an event handler, but does not exist."),t.listenTo(e,n,o,t)})}function n(t,e,i,n){t.listenTo(e,i,n,t)}function o(t,e,n,s){var o=s.split(/\s+/);i.each(o,function(i){var s=t[i];t.stopListening(e,n,s,t)})}function a(t,e,i,n){t.stopListening(e,i,n,t)}function r(t,e,n,s,o){e&&n&&(i.isFunction(n)&&(n=n.call(t)),i.each(n,function(n,a){i.isFunction(n)?s(t,e,a,n):o(t,e,a,n)}))}t.bindEntityEvents=function(t,i,s){r(t,i,s,n,e)},t.unbindEntityEvents=function(t,e,i){r(t,e,i,a,o)}}(o),o.Callbacks=function(){this._deferred=o.$.Deferred(),this._callbacks=[]},i.extend(o.Callbacks.prototype,{add:function(t,e){this._callbacks.push({cb:t,ctx:e}),this._deferred.done(function(i,n){e&&(i=e),t.call(i,n)})},run:function(t,e){this._deferred.resolve(e,t)},reset:function(){var t=this._callbacks;this._deferred=o.$.Deferred(),this._callbacks=[],i.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),o.Controller=function(t){this.triggerMethod=o.triggerMethod,this.options=t||{},i.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,i.extend(o.Controller.prototype,e.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),o.Region=function(t){if(this.options=t||{},this.el=o.getOption(this,"el"),!this.el){var e=new Error("An 'el' must be specified for a region.");throw e.name="NoElError",e}if(this.initialize){var i=Array.prototype.slice.apply(arguments);this.initialize.apply(this,i)}},i.extend(o.Region,{buildRegion:function(t,e){var n="string"==typeof t,s="string"==typeof t.selector,o="undefined"==typeof t.regionType,a="function"==typeof t;if(!a&&!n&&!s)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var r,l;n&&(r=t),t.selector&&(r=t.selector,delete t.selector),a&&(l=t),!a&&o&&(l=e),t.regionType&&(l=t.regionType,delete t.regionType),(n||a)&&(t={}),t.el=r;var c=new l(t);return t.parentEl&&(c.getEl=function(e){var n=t.parentEl;return i.isFunction(n)&&(n=n()),n.find(e)}),c}}),i.extend(o.Region.prototype,e.Events,{show:function(t){this.ensureEl();var e=t.isClosed||i.isUndefined(t.$el),n=t!==this.currentView;n&&this.close(),t.render(),(n||e)&&this.open(t),this.currentView=t,o.triggerMethod.call(this,"show",t),o.triggerMethod.call(t,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(t){return o.$(t)},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close?t.close():t.remove&&t.remove(),o.triggerMethod.call(this,"close",t),delete this.currentView)},attachView:function(t){this.currentView=t},reset:function(){this.close(),delete this.$el}}),o.Region.extend=o.extend,o.RegionManager=function(t){var e=t.Controller.extend({constructor:function(e){this._regions={},t.Controller.prototype.constructor.call(this,e)},addRegions:function(t,e){var n={};return i.each(t,function(t,s){"string"==typeof t&&(t={selector:t}),t.selector&&(t=i.defaults({},t,e));var o=this.addRegion(s,t);n[s]=o},this),n},addRegion:function(e,n){var s,o=i.isObject(n),a=i.isString(n),r=!!n.selector;return s=a||o&&r?t.Region.buildRegion(n,t.Region):i.isFunction(n)?t.Region.buildRegion(n,t.Region):n,this._store(e,s),this.triggerMethod("region:add",e,s),s},get:function(t){return this._regions[t]},removeRegion:function(t){var e=this._regions[t];this._remove(t,e)},removeRegions:function(){i.each(this._regions,function(t,e){this._remove(e,t)},this)},closeRegions:function(){i.each(this._regions,function(t){t.close()},this)},close:function(){this.removeRegions();var e=Array.prototype.slice.call(arguments);t.Controller.prototype.close.apply(this,e)},_store:function(t,e){this._regions[t]=e,this._setLength()},_remove:function(t,e){e.close(),delete this._regions[t],this._setLength(),this.triggerMethod("region:remove",t,e)},_setLength:function(){this.length=i.size(this._regions)}}),n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return i.each(n,function(t){e.prototype[t]=function(){var e=i.values(this._regions),n=[e].concat(i.toArray(arguments));return i[t].apply(i,n)}}),e}(o),o.TemplateCache=function(t){this.templateId=t},i.extend(o.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new o.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=n(arguments),i=e.length;if(i>0)for(t=0;i>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),i.extend(o.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var e=o.$(t).html();return e&&0!==e.length||s("Could not find template: '"+t+"'","NoTemplateError"),e},compileTemplate:function(t){return i.template(t)}}),o.Renderer={render:function(t,e){if(!t){var i=new Error("Cannot render the template since it's false, null or undefined.");throw i.name="TemplateNotFoundError",i}var n;return(n="function"==typeof t?t:o.TemplateCache.get(t))(e)}},o.View=e.View.extend({constructor:function(t){i.bindAll(this,"render");var n=Array.prototype.slice.apply(arguments);this.options=i.extend({},i.result(this,"options"),i.isFunction(t)?t.call(this):t),this.events=this.normalizeUIKeys(i.result(this,"events")),e.View.prototype.constructor.apply(this,n),o.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:o.triggerMethod,normalizeMethods:o.normalizeMethods,getTemplate:function(){return o.getOption(this,"template")},mixinTemplateHelpers:function(t){t=t||{};var e=o.getOption(this,"templateHelpers");return i.isFunction(e)&&(e=e.call(this)),i.extend(t,e)},normalizeUIKeys:function(t){return"undefined"!=typeof t?(i.each(i.keys(t),function(e){var i=e.split("@ui.");2===i.length&&(t[i[0]+this.ui[i[1]]]=t[e],delete t[e])},this),t):void 0},configureTriggers:function(){if(this.triggers){var t={},e=this.normalizeUIKeys(i.result(this,"triggers"));return i.each(e,function(e,n){var s=i.isObject(e),o=s?e.event:e;t[n]=function(t){if(t){var i=t.preventDefault,n=t.stopPropagation,a=s?e.preventDefault:i,r=s?e.stopPropagation:n;a&&i&&i.apply(t),r&&n&&n.apply(t)}var l={view:this,model:this.model,collection:this.collection};this.triggerMethod(o,l)}},this),t}},delegateEvents:function(t){this._delegateDOMEvents(t),o.bindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.bindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(t){t=t||this.events,i.isFunction(t)&&(t=t.call(this));var n={},s=this.configureTriggers();i.extend(n,t,s),e.View.prototype.delegateEvents.call(this,n)},undelegateEvents:function(){var t=Array.prototype.slice.call(arguments);e.View.prototype.undelegateEvents.apply(this,t),o.unbindEntityEvents(this,this.model,o.getOption(this,"modelEvents")),o.unbindEntityEvents(this,this.collection,o.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var t=this.triggerMethod("before:close");t!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=i.result(this,"_uiBindings");this.ui={},i.each(i.keys(t),function(e){var i=t[e];this.ui[e]=this.$(i)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(i.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),o.ItemView=o.View.extend({constructor:function(){o.View.prototype.constructor.apply(this,n(arguments))},serializeData:function(){var t={};return this.model?t=this.model.toJSON():this.collection&&(t={items:this.collection.toJSON()}),t},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var t=this.serializeData();t=this.mixinTemplateHelpers(t);var e=this.getTemplate(),i=o.Renderer.render(e,t);return this.$el.html(i),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),o.View.prototype.close.apply(this,n(arguments)),this.triggerMethod("item:closed"))}}),o.CollectionView=o.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),o.View.prototype.constructor.apply(this,n(arguments)),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this.appendBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerShowBufferedChildren:function(){this._isShown&&(i.each(this._bufferedChildren,function(t){o.triggerMethod.call(t,"show")}),this._bufferedChildren=[])},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(t){this.closeEmptyView();var e=this.getItemView(t),i=this.collection.indexOf(t);this.addItemView(t,e,i)},onShowCalled:function(){this.children.each(function(t){o.triggerMethod.call(t,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.isEmpty(this.collection)?this.showEmptyView():this.showCollection(),this.endBuffering()},showCollection:function(){var t;this.collection.each(function(e,i){t=this.getItemView(e),this.addItemView(e,t,i)},this)},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this._showingEmptyView=!0;var i=new e.Model;this.addItemView(i,t,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return o.getOption(this,"emptyView")},getItemView:function(){var t=o.getOption(this,"itemView");return t||s("An `itemView` must be specified","NoItemViewError"),t},addItemView:function(t,e,n){var s=o.getOption(this,"itemViewOptions");i.isFunction(s)&&(s=s.call(this,t,n));var a=this.buildItemView(t,e,s);return this.addChildViewEventForwarding(a),this.triggerMethod("before:item:added",a),this.children.add(a),this.renderItemView(a,n),this._isShown&&!this.isBuffering&&o.triggerMethod.call(a,"show"),this.triggerMethod("after:item:added",a),a},addChildViewEventForwarding:function(t){var e=o.getOption(this,"itemViewEventPrefix");this.listenTo(t,"all",function(){var s=n(arguments),a=s[0],r=this.normalizeMethods(this.getItemEvents());s[0]=e+":"+a,s.splice(1,0,t),"undefined"!=typeof r&&i.isFunction(r[a])&&r[a].apply(this,s),o.triggerMethod.apply(this,s)},this)},getItemEvents:function(){return i.isFunction(this.itemEvents)?this.itemEvents.call(this):this.itemEvents},renderItemView:function(t,e){t.render(),this.appendHtml(this,t,e)},buildItemView:function(t,e,n){var s=i.extend({model:t},n);return new e(s)},removeItemView:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},removeChildView:function(t){t&&(this.stopListening(t),t.close?t.close():t.remove&&t.remove(),this.children.remove(t)),this.triggerMethod("item:removed",t)},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},appendBuffer:function(t,e){t.$el.append(e)},appendHtml:function(t,e){t.isBuffering?(t.elBuffer.appendChild(e.el),t._bufferedChildren.push(e)):t.$el.append(e.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),o.View.prototype.close.apply(this,n(arguments)))},closeChildren:function(){this.children.each(function(t){this.removeChildView(t)},this),this.checkEmpty()}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.prototype.constructor.apply(this,n(arguments))},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))})},getItemView:function(){var t=o.getOption(this,"itemView")||this.constructor;return t||s("An `itemView` must be specified","NoItemViewError"),t},serializeData:function(){var t={};return this.model&&(t=this.model.toJSON()),t},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var t=this.renderModel();return this.$el.html(t),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(this.triggerMethod("composite:collection:before:render"),o.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t);var e=this.getTemplate();return o.Renderer.render(e,t)},appendBuffer:function(t,e){var i=this.getItemViewContainer(t);i.append(e)},appendHtml:function(t,e){if(t.isBuffering)t.elBuffer.appendChild(e.el),t._bufferedChildren.push(e);else{var i=this.getItemViewContainer(t);i.append(e.el)}},getItemViewContainer:function(t){if("$itemViewContainer"in t)return t.$itemViewContainer;var e,n=o.getOption(t,"itemViewContainer");if(n){var a=i.isFunction(n)?n.call(this):n;e=t.$(a),e.length<=0&&s("The specified `itemViewContainer` was not found: "+t.itemViewContainer,"ItemViewContainerMissingError")}else e=t.$el;return t.$itemViewContainer=e,e},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),o.Layout=o.ItemView.extend({regionType:o.Region,constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.prototype.constructor.call(this,t)},render:function(){this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions();var t=Array.prototype.slice.apply(arguments),e=o.ItemView.prototype.render.apply(this,t);return e},close:function(){if(!this.isClosed){this.regionManager.close();var t=Array.prototype.slice.apply(arguments);o.ItemView.prototype.close.apply(this,t)}},addRegion:function(t,e){var i={};return i[t]=e,this._buildRegions(i)[t]},addRegions:function(t){return this.regions=i.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return delete this.regions[t],this.regionManager.removeRegion(t)},_buildRegions:function(t){var e=this,i={regionType:o.getOption(this,"regionType"),parentEl:function(){return e.$el}};return this.regionManager.addRegions(t,i)},_initializeRegions:function(t){var e;this._initRegionManager(),e=i.isFunction(this.regions)?this.regions(t):this.regions||{},this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(t){t.reset()})},_initRegionManager:function(){this.regionManager=new o.RegionManager,this.listenTo(this.regionManager,"region:add",function(t,e){this[t]=e,this.trigger("region:add",t,e)}),this.listenTo(this.regionManager,"region:remove",function(t,e){delete this[t],this.trigger("region:remove",t,e)})}}),o.AppRouter=e.Router.extend({constructor:function(t){e.Router.prototype.constructor.apply(this,n(arguments)),this.options=t||{};var i=o.getOption(this,"appRoutes"),s=this._getController();this.processAppRoutes(s,i)},appRoute:function(t,e){var i=this._getController();this._addAppRoute(i,t,e)},processAppRoutes:function(t,e){if(e){var n=i.keys(e).reverse();i.each(n,function(i){this._addAppRoute(t,i,e[i])},this)}},_getController:function(){return o.getOption(this,"controller")},_addAppRoute:function(t,e,n){var s=t[n];if(!s)throw new Error("Method '"+n+"' was not found on the controller");this.route(e,n,i.bind(s,t))}}),o.Application=function(t){this._initRegionManager(),this._initCallbacks=new o.Callbacks,this.vent=new e.Wreqr.EventAggregator,this.commands=new e.Wreqr.Commands,this.reqres=new e.Wreqr.RequestResponse,this.submodules={},i.extend(this,t),this.triggerMethod=o.triggerMethod},i.extend(o.Application.prototype,e.Events,{execute:function(){var t=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,t)},request:function(){var t=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,t)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("initialize:before",t),this._initCallbacks.run(t,this),this.triggerMethod("initialize:after",t),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(t){this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},module:function(t,e){var i=o.Module;e&&(i=e.moduleClass||i);var s=n(arguments);return s.unshift(this),i.create.apply(i,s)},_initRegionManager:function(){this._regionManager=new o.RegionManager,this.listenTo(this._regionManager,"region:add",function(t,e){this[t]=e}),this.listenTo(this._regionManager,"region:remove",function(t){delete this[t]})}}),o.Application.extend=o.extend,o.Module=function(t,e,n){this.moduleName=t,this.options=i.extend({},this.options,n),this.initialize=n.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,this.startWithParent=!0,this.triggerMethod=o.triggerMethod,i.isFunction(this.initialize)&&this.initialize(this.options,t,e)},o.Module.extend=o.extend,i.extend(o.Module.prototype,e.Events,{initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(i.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,o.triggerMethod.call(this,"before:stop"),i.each(this.submodules,function(t){t.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),o.triggerMethod.call(this,"stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,n){if(t){var s=i.flatten([this,this.app,e,o,o.$,i,n]);t.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks}}),i.extend(o.Module,{create:function(t,e,s){var o=t,a=n(arguments);a.splice(0,3),e=e.split(".");var r=e.length,l=[];return l[r-1]=s,i.each(e,function(e,i){var n=o;o=this._getModule(n,e,t,s),this._addModuleDefinition(n,o,l[i],a)},this),o},_getModule:function(t,e,n,s){var a=o.Module,r=i.extend({},s);s&&(a=s.moduleClass||a);var l=t[e];return l||(l=new a(e,n,r),t[e]=l,t.submodules[e]=l),l},_addModuleDefinition:function(t,e,n,s){var o,a;i.isFunction(n)?(o=n,a=!0):i.isObject(n)?(o=n.define,a="undefined"!=typeof n.startWithParent?n.startWithParent:!0):a=!0,o&&e.addDefinition(o,s),e.startWithParent=e.startWithParent&&a,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),o}(this,e,t);return e.Marionette}),!function(t){t(function(){t.support.transition=function(){var t=function(){var t,e=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in i)if(void 0!==e.style[t])return i[t]}();return t&&{end:t}}()})}(window.jQuery),!function(t){var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.prototype.close=function(e){function i(){n.trigger("closed").remove()}var n,s=t(this),o=s.attr("data-target");o||(o=s.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),n=t(o),e&&e.preventDefault(),n.length||(n=s.hasClass("alert")?s:s.parent()),n.trigger(e=t.Event("close")),e.isDefaultPrevented()||(n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.on(t.support.transition.end,i):i())};var n=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var n=t(this),s=n.data("alert");s||n.data("alert",s=new i(this)),"string"==typeof e&&s[e].call(n)})},t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.alert.data-api",e,i.prototype.close)}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.button.defaults,i)};e.prototype.setState=function(t){var e="disabled",i=this.$element,n=i.data(),s=i.is("input")?"val":"html";t+="Text",n.resetText||i.data("resetText",i[s]()),i[s](n[t]||this.options[t]),setTimeout(function(){"loadingText"==t?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)},e.prototype.toggle=function(){var t=this.$element.closest('[data-toggle="buttons-radio"]');t&&t.find(".active").removeClass("active"),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=function(i){return this.each(function(){var n=t(this),s=n.data("button"),o="object"==typeof i&&i;s||n.data("button",s=new e(this,o)),"toggle"==i?s.toggle():i&&s.setState(i)})},t.fn.button.defaults={loadingText:"loading..."},t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.button.data-api","[data-toggle^=button]",function(e){var i=t(e.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle")})}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,"hover"==this.options.pause&&this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};e.prototype={cycle:function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(e){var i=this.getActiveIndex(),n=this;if(!(e>this.$items.length-1||0>e))return this.sliding?this.$element.one("slid",function(){n.to(e)}):i==e?this.pause().cycle():this.slide(e>i?"next":"prev",t(this.$items[e]))},pause:function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition.end&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){return this.sliding?void 0:this.slide("next")},prev:function(){return this.sliding?void 0:this.slide("prev")},slide:function(e,i){var n,s=this.$element.find(".item.active"),o=i||s[e](),a=this.interval,r="next"==e?"left":"right",l="next"==e?"first":"last",c=this;if(this.sliding=!0,a&&this.pause(),o=o.length?o:this.$element.find(".item")[l](),n=t.Event("slide",{relatedTarget:o[0],direction:r}),!o.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var e=t(c.$indicators.children()[c.getActiveIndex()]);e&&e.addClass("active")})),t.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(n),n.isDefaultPrevented())return;o.addClass(e),o[0].offsetWidth,s.addClass(r),o.addClass(r),this.$element.one(t.support.transition.end,function(){o.removeClass([e,r].join(" ")).addClass("active"),s.removeClass(["active",r].join(" ")),c.sliding=!1,setTimeout(function(){c.$element.trigger("slid")},0)})}else{if(this.$element.trigger(n),n.isDefaultPrevented())return;s.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return a&&this.cycle(),this}}};var i=t.fn.carousel;t.fn.carousel=function(i){return this.each(function(){var n=t(this),s=n.data("carousel"),o=t.extend({},t.fn.carousel.defaults,"object"==typeof i&&i),a="string"==typeof i?i:o.slide;s||n.data("carousel",s=new e(this,o)),"number"==typeof i?s.to(i):a?s[a]():o.interval&&s.pause().cycle()})},t.fn.carousel.defaults={interval:5e3,pause:"hover"},t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this},t(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(e){var i,n,s=t(this),o=t(s.attr("data-target")||(i=s.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),a=t.extend({},o.data(),s.data());o.carousel(a),(n=s.attr("data-slide-to"))&&o.data("carousel").pause().to(n).cycle(),e.preventDefault()
})}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.collapse.defaults,i),this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.prototype={constructor:e,dimension:function(){var t=this.$element.hasClass("width");return t?"width":"height"},show:function(){var e,i,n,s;if(!this.transitioning&&!this.$element.hasClass("in")){if(e=this.dimension(),i=t.camelCase(["scroll",e].join("-")),n=this.$parent&&this.$parent.find("> .accordion-group > .in"),n&&n.length){if(s=n.data("collapse"),s&&s.transitioning)return;n.collapse("hide"),s||n.data("collapse",null)}this.$element[e](0),this.transition("addClass",t.Event("show"),"shown"),t.support.transition&&this.$element[e](this.$element[0][i])}},hide:function(){var e;!this.transitioning&&this.$element.hasClass("in")&&(e=this.dimension(),this.reset(this.$element[e]()),this.transition("removeClass",t.Event("hide"),"hidden"),this.$element[e](0))},reset:function(t){var e=this.dimension();return this.$element.removeClass("collapse")[e](t||"auto")[0].offsetWidth,this.$element[null!==t?"addClass":"removeClass"]("collapse"),this},transition:function(e,i,n){var s=this,o=function(){"show"==i.type&&s.reset(),s.transitioning=0,s.$element.trigger(n)};this.$element.trigger(i),i.isDefaultPrevented()||(this.transitioning=1,this.$element[e]("in"),t.support.transition&&this.$element.hasClass("collapse")?this.$element.one(t.support.transition.end,o):o())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var i=t.fn.collapse;t.fn.collapse=function(i){return this.each(function(){var n=t(this),s=n.data("collapse"),o=t.extend({},t.fn.collapse.defaults,n.data(),"object"==typeof i&&i);s||n.data("collapse",s=new e(this,o)),"string"==typeof i&&s[i]()})},t.fn.collapse.defaults={toggle:!0},t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.collapse.data-api","[data-toggle=collapse]",function(e){var i,n=t(this),s=n.attr("data-target")||e.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),o=t(s).data("collapse")?"toggle":n.data();n[t(s).hasClass("in")?"addClass":"removeClass"]("collapsed"),t(s).collapse(o)})}(window.jQuery),!function(t){function e(){t(".dropdown-backdrop").remove(),t(n).each(function(){i(t(this)).removeClass("open")})}function i(e){var i,n=e.attr("data-target");return n||(n=e.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),i=n&&t(n),i&&i.length||(i=e.parent()),i}var n="[data-toggle=dropdown]",s=function(e){var i=t(e).on("click.dropdown.data-api",this.toggle);t("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};s.prototype={constructor:s,toggle:function(){var n,s,o=t(this);if(!o.is(".disabled, :disabled"))return n=i(o),s=n.hasClass("open"),e(),s||("ontouchstart"in document.documentElement&&t('<div class="dropdown-backdrop"/>').insertBefore(t(this)).on("click",e),n.toggleClass("open")),o.focus(),!1},keydown:function(e){var s,o,a,r,l;if(/(38|40|27)/.test(e.keyCode)&&(s=t(this),e.preventDefault(),e.stopPropagation(),!s.is(".disabled, :disabled"))){if(a=i(s),r=a.hasClass("open"),!r||r&&27==e.keyCode)return 27==e.which&&a.find(n).focus(),s.click();o=t("[role=menu] li:not(.divider):visible a",a),o.length&&(l=o.index(o.filter(":focus")),38==e.keyCode&&l>0&&l--,40==e.keyCode&&l<o.length-1&&l++,~l||(l=0),o.eq(l).focus())}}};var o=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var i=t(this),n=i.data("dropdown");n||i.data("dropdown",n=new s(this)),"string"==typeof e&&n[e].call(i)})},t.fn.dropdown.Constructor=s,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=o,this},t(document).on("click.dropdown.data-api",e).on("click.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.dropdown.data-api",n,s.prototype.toggle).on("keydown.dropdown.data-api",n+", [role=menu]",s.prototype.keydown)}(window.jQuery),!function(t){var e=function(e,i){this.options=i,this.$element=t(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};e.prototype={constructor:e,updateModalPosition:function(){var e=this;e.$element.css({"margin-top":function(){return t(window).scrollTop()}})},toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,i=t.Event("show");this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var i=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),i&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),i?e.$element.one(t.support.transition.end,function(){e.$element.focus().trigger("shown")}):e.$element.focus().trigger("shown")}),e.updateModalPosition())},hide:function(e){e&&e.preventDefault();e=t.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),t.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var e=this;t(document).on("focusin.modal",function(t){e.$element[0]===t.target||e.$element.has(t.target).length||e.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end),e.hideModal()},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i),e.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&i;if(this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?t.proxy(this.$element[0].focus,this.$element[0]):t.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e):e()):e&&e()}};var i=t.fn.modal;t.fn.modal=function(i){return this.each(function(){var n=t(this),s=n.data("modal"),o=t.extend({},t.fn.modal.defaults,n.data(),"object"==typeof i&&i);s||n.data("modal",s=new e(this,o)),"string"==typeof i?s[i]():o.show&&s.show()})},t.fn.modal.defaults={backdrop:"static",keyboard:!0,show:!0},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),n=i.attr("href"),s=t(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},s.data(),i.data());e.preventDefault(),s.modal(o).one("hide",function(){i.focus()})})}(window.jQuery),!function(t){var e=function(t,e){this.init("tooltip",t,e)};e.prototype={constructor:e,init:function(e,i,n){var s,o,a,r,l;for(this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.enabled=!0,a=this.options.trigger.split(" "),l=a.length;l--;)r=a[l],"click"==r?this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this)):"manual"!=r&&(s="hover"==r?"mouseenter":"focus",o="hover"==r?"mouseleave":"blur",this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(o+"."+this.type,this.options.selector,t.proxy(this.leave,this)));this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){return e=t.extend({},t.fn[this.type].defaults,this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},enter:function(e){var i,n=t.fn[this.type].defaults,s={};return this._options&&t.each(this._options,function(t,e){n[t]!=e&&(s[t]=e)},this),i=t(e.currentTarget)[this.type](s).data(this.type),i.options.delay&&i.options.delay.show?(clearTimeout(this.timeout),i.hoverState="in",void(this.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show))):i.show()},leave:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),i.options.delay&&i.options.delay.hide?(i.hoverState="out",void(this.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide))):i.hide()},show:function(){var e,i,n,s,o,a,r=t.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(r),r.isDefaultPrevented())return;switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),o="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,e.detach().css({top:0,left:0,display:"block"}),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),i=this.getPosition(),n=e[0].offsetWidth,s=e[0].offsetHeight,o){case"bottom":a={top:i.top+i.height,left:i.left+i.width/2-n/2};break;case"top":a={top:i.top-s,left:i.left+i.width/2-n/2};break;case"left":a={top:i.top+i.height/2-s/2,left:i.left-n};break;case"right":a={top:i.top+i.height/2-s/2,left:i.left+i.width}}this.applyPlacement(a,o),this.$element.trigger("shown")}},applyPlacement:function(t,e){var i,n,s,o,a=this.tip(),r=a[0].offsetWidth,l=a[0].offsetHeight;a.offset(t).addClass(e).addClass("in"),i=a[0].offsetWidth,n=a[0].offsetHeight,"top"==e&&n!=l&&(t.top=t.top+l-n,o=!0),"bottom"==e||"top"==e?(s=0,t.left<0&&(s=-2*t.left,t.left=0,a.offset(t),i=a[0].offsetWidth,n=a[0].offsetHeight),this.replaceArrow(s-r+i,i,"left")):this.replaceArrow(n-l,n,"top"),o&&a.offset(t)},replaceArrow:function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},hide:function(){function e(){var e=setTimeout(function(){i.off(t.support.transition.end).detach()},500);i.one(t.support.transition.end,function(){clearTimeout(e),i.detach()})}var i=this.tip(),n=t.Event("hide");return this.$element.trigger(n),n.isDefaultPrevented()?void 0:(i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?e():i.detach(),this.$element.trigger("hidden"),this)},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},getTitle:function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},tip:function(){return this.$tip=this.$tip||t(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var i=e?t(e.currentTarget)[this.type](this._options).data(this.type):this;i.tip().hasClass("in")?i.hide():i.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var n=t(this),s=n.data("tooltip"),o="object"==typeof i&&i;s||n.data("tooltip",s=new e(this,o)),"string"==typeof i&&s[i]()})},t.fn.tooltip.Constructor=e,t.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(window.jQuery),!function(t){var e=function(t,e){this.init("popover",t,e)};e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:e,setContent:function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"html":"text"](i),t.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var t,e=this.$element,i=this.options;return t=("function"==typeof i.content?i.content.call(e[0]):i.content)||e.attr("data-content")},tip:function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var i=t.fn.popover;t.fn.popover=function(i){return this.each(function(){var n=t(this),s=n.data("popover"),o="object"==typeof i&&i;s||n.data("popover",s=new e(this,o)),"string"==typeof i&&s[i]()})},t.fn.popover.Constructor=e,t.fn.popover.defaults=t.extend({},t.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(window.jQuery),!function(t){function e(e,i){var n,s=t.proxy(this.process,this),o=t(t(e).is("body")?window:e);this.options=t.extend({},t.fn.scrollspy.defaults,i),this.$scrollElement=o.on("scroll.scroll-spy.data-api",s),this.selector=(this.options.target||(n=t(e).attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=t("body"),this.refresh(),this.process()}e.prototype={constructor:e,refresh:function(){var e,i=this;this.offsets=t([]),this.targets=t([]),e=this.$body.find(this.selector).map(function(){var e=t(this),n=e.data("target")||e.attr("href"),s=/^#\w/.test(n)&&t(n);return s&&s.length&&[[s.position().top+(!t.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),n]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},process:function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=i-this.$scrollElement.height(),s=this.offsets,o=this.targets,a=this.activeTarget;if(e>=n)return a!=(t=o.last()[0])&&this.activate(t);for(t=s.length;t--;)a!=o[t]&&e>=s[t]&&(!s[t+1]||e<=s[t+1])&&this.activate(o[t])},activate:function(e){var i,n;this.activeTarget=e,t(this.selector).parent(".active").removeClass("active"),n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parent("li").addClass("active"),i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate")}};var i=t.fn.scrollspy;t.fn.scrollspy=function(i){return this.each(function(){var n=t(this),s=n.data("scrollspy"),o="object"==typeof i&&i;s||n.data("scrollspy",s=new e(this,o)),"string"==typeof i&&s[i]()})},t.fn.scrollspy.Constructor=e,t.fn.scrollspy.defaults={offset:10},t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);e.scrollspy(e.data())})})}(window.jQuery),!function(t){var e=function(e){this.element=t(e)};e.prototype={constructor:e,show:function(){var e,i,n,s=this.element,o=s.closest("ul:not(.dropdown-menu)"),a=s.attr("data-target");a||(a=s.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,"")),s.parent("li").hasClass("active")||(e=o.find(".active:last a")[0],n=t.Event("show",{relatedTarget:e}),s.trigger(n),n.isDefaultPrevented()||(i=t(a),this.activate(s.parent("li"),o),this.activate(i,i.parent(),function(){s.trigger({type:"shown",relatedTarget:e})})))},activate:function(e,i,n){function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),n&&n()}var o=i.find("> .active"),a=n&&t.support.transition&&o.hasClass("fade");a?o.one(t.support.transition.end,s):s(),o.removeClass("in")}};var i=t.fn.tab;t.fn.tab=function(i){return this.each(function(){var n=t(this),s=n.data("tab");s||n.data("tab",s=new e(this)),"string"==typeof i&&s[i]()})},t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=i,this},t(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t(this).tab("show")})}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=t(this.options.menu),this.shown=!1,this.listen()};e.prototype={constructor:e,select:function(){var t=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var e=t.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:e.top+e.height,left:e.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var e;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(e=t.isFunction(this.source)?this.source(this.query,t.proxy(this.process,this)):this.source,e?this.process(e):this)},process:function(e){var i=this;return e=t.grep(e,function(t){return i.matcher(t)}),e=this.sorter(e),e.length?this.render(e.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e,i=[],n=[],s=[];e=t.shift();)e.toLowerCase().indexOf(this.query.toLowerCase())?~e.indexOf(this.query)?n.push(e):s.push(e):i.push(e);return i.concat(n,s)},highlighter:function(t){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return t.replace(new RegExp("("+e+")","ig"),function(t,e){return"<strong>"+e+"</strong>"})},render:function(e){var i=this;return e=t(e).map(function(e,n){return e=t(i.options.item).attr("data-value",n),e.find("a").html(i.highlighter(n)),e[0]}),e.first().addClass("active"),this.$menu.html(e),this},next:function(){var e=this.$menu.find(".active").removeClass("active"),i=e.next();i.length||(i=t(this.$menu.find("li")[0])),i.addClass("active")},prev:function(){var t=this.$menu.find(".active").removeClass("active"),e=t.prev();e.length||(e=this.$menu.find("li").last()),e.addClass("active")},listen:function(){this.$element.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",t.proxy(this.keydown,this)),this.$menu.on("click",t.proxy(this.click,this)).on("mouseenter","li",t.proxy(this.mouseenter,this)).on("mouseleave","li",t.proxy(this.mouseleave,this))},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next()}t.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~t.inArray(e.keyCode,[40,38,9,13,27]),this.move(e)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.stopPropagation(),t.preventDefault()},focus:function(){this.focused=!0},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),t(e.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var i=t.fn.typeahead;t.fn.typeahead=function(i){return this.each(function(){var n=t(this),s=n.data("typeahead"),o="object"==typeof i&&i;s||n.data("typeahead",s=new e(this,o)),"string"==typeof i&&s[i]()})},t.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},t.fn.typeahead.Constructor=e,t.fn.typeahead.noConflict=function(){return t.fn.typeahead=i,this},t(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var e=t(this);e.data("typeahead")||e.typeahead(e.data())})}(window.jQuery),!function(t){var e=function(e,i){this.options=t.extend({},t.fn.affix.defaults,i),this.$window=t(window).on("scroll.affix.data-api",t.proxy(this.checkPosition,this)).on("click.affix.data-api",t.proxy(function(){setTimeout(t.proxy(this.checkPosition,this),1)},this)),this.$element=t(e),this.checkPosition()};e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e,i=t(document).height(),n=this.$window.scrollTop(),s=this.$element.offset(),o=this.options.offset,a=o.bottom,r=o.top,l="affix affix-top affix-bottom";"object"!=typeof o&&(a=r=o),"function"==typeof r&&(r=o.top()),"function"==typeof a&&(a=o.bottom()),e=null!=this.unpin&&n+this.unpin<=s.top?!1:null!=a&&s.top+this.$element.height()>=i-a?"bottom":null!=r&&r>=n?"top":!1,this.affixed!==e&&(this.affixed=e,this.unpin="bottom"==e?s.top-n:null,this.$element.removeClass(l).addClass("affix"+(e?"-"+e:"")))}};var i=t.fn.affix;t.fn.affix=function(i){return this.each(function(){var n=t(this),s=n.data("affix"),o="object"==typeof i&&i;s||n.data("affix",s=new e(this,o)),"string"==typeof i&&s[i]()})},t.fn.affix.Constructor=e,t.fn.affix.defaults={offset:0},t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),i=e.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),e.affix(i)})})}(window.jQuery),define("bootstrap",["jquery"],function(){}),function(t){var e=function(e,i){if(this.$element=t(e),this.$note=t('<div class="alert"></div>'),this.options=t.extend(!0,{},t.fn.notify.defaults,i,this.$element.data()),this.options.transition?"fade"==this.options.transition?this.$note.addClass("in").addClass(this.options.transition):this.$note.addClass(this.options.transition):this.$note.addClass("fade").addClass("in"),this.$note.addClass(this.options.type?"alert-"+this.options.type:"alert-success"),this.options.message&&("string"==typeof this.options.message?this.$note.html(this.options.message):"object"==typeof this.options.message&&(this.options.message.html?this.$note.html(this.options.message.html):this.options.message.text&&this.$note.text(this.options.message.text))),this.options.closable){var n=t('<a href="javascript:;" class="close pull-right">&times;</a>');t(n).on("click",t.proxy(onClose,this)),t(n).on("keydown",t.proxy(onClose,this)),this.$note.prepend(n),0===t(".notify-backdrop").length&&t('<div class="notify-backdrop fade in"></div>').appendTo("body")}if(this.options.uncloseable)0===t(".notify-backdrop").length&&t('<div class="notify-backdrop fade in"></div>').appendTo("body");else if(!this.options.closable){var s=t(".notify-backdrop");s.length>0&&s.remove()}return this};onClose=function(e){if(e)if(e.preventDefault(),"keydown"===e.type){if(13!==e.keyCode)return}else if("click"!==e.type)return;this.options.onClose(),t(this.$note).remove(),t(".notify-backdrop").remove(),this.options.onClosed()},e.prototype.show=function(){this.options.fadeOut.enabled&&this.$note.delay(this.options.fadeOut.delay||2e3).fadeOut("slow",t.proxy(onClose,this)),this.$element.empty().append(this.$note),this.$note.alert(),this.$note.find(".close").focus()},e.prototype.hide=function(){this.options.fadeOut.enabled?this.$note.delay(this.options.fadeOut.delay||2e3).fadeOut("slow",t.proxy(onClose,this)):onClose.call(this)},t.fn.notify=function(t){return new e(this,t)},t.fn.notify.defaults={type:"success",closable:!0,transition:"fade",fadeOut:{enabled:!0},uncloseable:!1,message:null,onClose:function(){},onClosed:function(){}}}(window.jQuery),define("notify",["bootstrap"],function(){}),define("core/utils",["require","jquery","underscore","notify"],function(t){var e=t("jquery"),i=t("underscore");return t("notify"),{ajax:function(t,n){var s=e.Deferred();return"object"==typeof t&&(n=t,t=void 0),n=i.defaults(n||{},{dataType:"json"}),s.xhr=e.ajax(t,n).done(function(t){0===+t.code?s.resolve(t.data,t):s.reject(t.msg,t)}).fail(function(){s.reject("网络错误。",{code:-1,msg:"网络错误。"})}),s},validMobile:function(t){return/^((\+86)|(86))?(1)\d{10}$/.test(""+t)},validPhone:function(t){return/^(\(\d{3,4}\)|\d{3,4}(-|\s)?)?\d{7,8}(-\d{1,4})?$/.test(""+t)},validPostalCode:function(t){return/^\d{6}$/.test(""+t)},getFormData:function(t){var i=t.serializeArray(),n={};return e.map(i,function(t){n[t.name]=t.value}),n},focus:function(t){if(t){var i=e(document).scrollLeft(),n=e(document).scrollTop();t.focus(),window.scrollTo(i,n)}},highlight:function(t,n){if(2===arguments.length){var s=e(n),o=!1;s.find("a").each(function(n,s){var a=e(s),r=[];a.attr("href").indexOf(t.params)>=0&&!o?(a.parents("li").first().addClass("active"),o=!0):r.push(a),i.each(r,function(t){t.parents("li").removeClass("active")})})}},parse:function(t,e){if(e=e||{},0===+t.code){if(!i.isFunction(e.success))return t.data;e.success(t.data)}else{if(!i.isFunction(e.fail))return void this.errorNotify(t.msg);e.fail(t)}},userAborted:function(t){return 0===t.status||0===t.readyState},handleAjaxError:function(t){var e=this;return function(n){e.userAborted(n)||(t&&i.isFunction(t)?t(n):e.errorNotify("出错啦，请重试。"))}},getStaticUrl:function(t,n){var s=this;if(!i.isUndefined(t))return s.urlData=s.urlData||{},s._titleMap=s._titleMap||{homepage:"店铺主页",usercenter:"会员主页",history:"历史消息"},s.urlData&&s.urlData[t]?n(s.urlData[t],s._titleMap[t]):void e.getJSON(window._global.url.www+"/showcase/shop/url.json",{type:t},function(e){if(0===+e.code){var i=s.urlData[t]=e.data.short_url;n(i,s._titleMap[t])}else s.errorNotify(e.msg||"出错啦。")}).fail(function(){s.errorNotify("出错啦")})},onlyNumber:function(t,e){var n=Number(t);if(!isNaN(n))return i.isUndefined(e)?n:n.toFixed(e)},fetchTemplateData:function(t){if(this._templateData)return this.clearNotify(),t(this._templateData),this._templateData;var i=this;e.getJSON(window._global.url.www+"/showcase/shop/defaultcategorytag.json",function(e){return 0===+e.code?(i._templateData=e.data,i.clearNotify(),t(i._templateData),i._templateData):void i.errorNotify("获取模板出错，重新试试看。")})},getTemplateData:function(){return this._templateData},myriadNum:function(t,e){return e=e||"W",t>1e4?(t/1e4).toFixed(1)+e:t},isRetina:function(){return window.devicePixelRatio>1}(),getTimestamp:function(t){var e;return e="string"==typeof t?new Date(t):"object"==typeof t?t:new Date,Math.round(e/1e3)},wbLength:function(t){var i,n=0,s=0;if("string"!=typeof t)return!1;i=""===e.trim(t)?"":t;var o=/http:\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/gi;return i=i.replace(o,"我是一个超链接占位符"),i=i.replace(/[\x21-\x7f]/gi,function(){return s++,""}),n=Math.ceil(i.length+s/2)},getSelectedText:function(t){return t?"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName?"ERROR: Only Support input & textarea.":window.getSelection?t.value.substr(t.selectionStart,t.selectionEnd-t.selectionStart):document.selection.createRange().text:"ERROR: el(input or textarea) is need."},insertText:function(t,e){if("INPUT"===t.tagName||"TEXTAREA"===t.tagName)if(document.selection){t.focus();var i=document.selection.createRange();i.text=e,i.collapse(),i.select()}else if(t.selectionStart||"0"==t.selectionStart){var n=t.selectionStart,s=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(s,t.value.length),t.selectionStart=t.selectionEnd=n+e.length}else t.value+=e},fullfillImage:function(t,e){return t?(e=e||"",t.match(/https?:\/\//i)?t.match(window._global.url.imgqn)?t+e:t:window._global.url.imgqn+"/"+t+e):void 0},toggleBr:function(t,i){var n=e.trim(t);return n?n="undefined"==typeof i||i?n.replace(" ","<br />"):n.replace("<br />"," "):!1},successNotify:function(t,n,s){s=s||{},!i.isFunction(n)&&i.isObject(n)&&i.extend(s,n),e(".js-notifications").notify({transition:"fade",closable:s.closeable||!1,message:t,type:"success",fadeOut:{enabled:i.isUndefined(s.fade)?!0:s.fade,delay:s.delay||2e3},uncloseable:s.uncloseable||!1,onClosed:function(){"function"==typeof n&&n()}}).show()},clearNotify:function(){e(".js-notifications").empty(),e(".notify-backdrop").remove()},errorNotify:function(t,i){e(".js-notifications").notify({transition:"fade",closable:!0,message:t,type:"error",fadeOut:{enabled:!1},onClosed:function(){"function"==typeof i&&i()}}).show()},getParameterByName:function(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+t+"=([^&#]*)",n=new RegExp(i),s=n.exec(e?e:window.location.search);return null===s?"":decodeURIComponent(s[1].replace(/\+/g," "))},getCurrentDay:function(t){t=t||new Date;var e=t.getMonth()+1;e=1===e.toString().length?"0"+e:e;var i=t.getDate();return i=1===i.toString().length?"0"+i:i,t.getFullYear()+"-"+e+"-"+i},getFullTime:function(t){function e(t){return 1===t.toString().length?"0"+t:t}t=t||new Date;var i=t.getMonth()+1;i=e(i);var n=t.getDate();n=e(n);var s=t.getHours();s=e(s);var o=t.getMinutes();o=e(o);var a=t.getSeconds();return a=e(a),t.getFullYear()+"-"+i+"-"+n+" "+s+":"+o+":"+a},toggleButton:function(t,i){var n=e(".form-actions .btn");n.each(i?function(){e(this).button("reset")}:function(){var i=e(this);i.button(i.attr("onclick").indexOf(t)>=0?"loading":"disabling")})},getUrlParam:function(t,e){var i=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n="router"===e?window.location.href:window.location.search,s=n.substr(1).match(i);return null!==s?window.unescape(s[2]):null},editUrlParam:function(t,e,i){var n,s=window.location.href,o=window.location.search;if(""!==o){var a,r,l;if(a=o.search(t),-1!=a){r=o.substr(0,a),l=o.substr(a);var c=l.search("&");-1!=c?(l=l.substr(c),n=window.location.pathname+r+t+"="+e+l):n=window.location.pathname+r+t+"="+e}else n=s+"&"+t+"="+e}else n=s+"?"+t+"="+e;if(""===e&&i){var h,u,d;if(h=n.indexOf(t),-1!=h){u=n.substr(0,h),d=n.substr(h);var p=d.search("&");-1!=p?(d=d.substr(p+1),n=u+d):(u=n.substr(0,h-1),n=u)}}return n},isIE6:function(){return e.browser.msie&&"6.0"==e.browser.version?!0:!1},isIOS:function(){var t=/(iPad|iPhone|iPod)/gi;return t.test(navigator.userAgent)},isChrome:function(){return-1!==window.navigator.userAgent.indexOf("Chrome")?!0:!1},trim:function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},lTrim:function(t){return t.replace(/(^\s*)/g,"")},rTrim:function(t){return t.replace(/(\s*$)/g,"")},isNumber:function(t){var e=t.which?t.which:t.keyCode;return 45!=e&&46!=e&&43!=e&&e>31&&(48>e||e>57)?!1:!0},getStrLength:function(t){t=e.kdt.util.trim(t);var i=t.length;return i},calculateStrLength:function(t){for(var e=0,i=0;i<t.length;i++)t.charCodeAt(i)>255?e+=3:e++;return e},substring4ChAndEn:function(t,i){for(var n=t.substring(0,2*i);e.kdt.util.getStrLength(n)>i;)n=n.substring(0,n.length-1);
return n},ellipse:function(t,i){var n=2*e.kdt.util.getStrLength(t)>i;return t&&n?t.replace(new RegExp("([\\s\\S]{"+i+"})[\\s\\S]*"),"$1..."):t},isEmpty:function(t){return""!==e.trim(t)?!1:!0},urlCheck:function(t){return-1==t.indexOf("://")?"http://"+t:t},AddZero:function(t){return t>=0&&10>t?"0"+t:t+""},twoDecimal:function(t){return isNaN(t)?t:Number(t).toFixed(2)},transEntity:function(t){return t.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},countdown:function(t,i,n){e(t).text(i),--i>=0?setTimeout(function(){e.kdt.countdown(t,i,n)},1e3):n()},str_replace:function(t,e,i,n){var s=0,o=0,a="",r="",l=0,c=0,h=[].concat(t),u=[].concat(e),d=i,p="[object Array]"===Object.prototype.toString.call(u),f="[object Array]"===Object.prototype.toString.call(d);for(d=[].concat(d),n&&(this.window[n]=0),s=0,l=d.length;l>s;s++)if(""!==d[s])for(o=0,c=h.length;c>o;o++)a=d[s]+"",r=p?void 0!==u[o]?u[o]:"":u[0],d[s]=a.split(h[o]).join(r),n&&d[s]!==a&&(this.window[n]+=(a.length-d[s].length)/h[o].length);return f?d:d[0]},addParameter:function(t,i){var n=t.split("#");t=n[0];for(var s in i)if(i.hasOwnProperty(s)){if(""===e.trim(i[s]))continue;if(t.indexOf("?")<0)t+="?"+e.trim(s)+"="+e.trim(i[s]);else{var o={},a=t.split("?");e.each(a[1].split("&"),function(t,i){var n=i.split("=");""!==e.trim(n[1])&&(o[n[0]]=n[1])}),e.each(i,function(t,i){""!==e.trim(i)&&(o[t]=i)});var r=[];e.each(o,function(t,e){r.push(t+"="+e)}),t=a[0]+"?"+r.join("&")}}return 2===n.length&&(t+="#"+n[1]),t},deparam:function(t){var i={};return t?(t=t.replace(/\|[^:]+:/gi,"&"),e.each(t.replace(/\+/g," ").split("&"),function(t,n){var s=n.split("="),o=decodeURIComponent(s[0]);if(!o)return i;var a=decodeURIComponent(s[1]||""),r=o.split("]["),l=r.length-1,c=0,h=i;if(r[0].indexOf("[")>=0&&/\]$/.test(r[l])?(r[l]=r[l].replace(/\]$/,""),r=r.shift().split("[").concat(r),l++):l=0,l)for(;l>=c;c++)o=""!==r[c]?r[c]:h.length,l>c?h=h[o]=h[o]||(isNaN(r[c+1])?{}:[]):h[o]=a;else e.isArray(i[o])?i[o].push(a):i[o]=o in i?[i[o],a]:a}),i):i},keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},navActive:function(t,i){var n=e(".ui-nav");if(n.length>0)return e("li.active",n).removeClass("active"),void e(t).addClass("active");var s=e.extend(i,{navBlock:".third-nav__links"});e(s.navBlock).children("li.active").removeClass("active"),t&&e(t).addClass("active")},sidebarNavActive:function(t){var i=e("aside.ui-sidebar");i.find("li.active").removeClass("active"),e(t).addClass("active")},rgb2hex:function(t){function e(t){return("0"+parseInt(t,10).toString(16)).slice(-2)}return t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+e(t[1])+e(t[2])+e(t[3])},fixedButton:function(t,n){var s=e(".app-design .app-actions .form-actions"),o=e(".app-design .pin"),a=function(){var t=e(window).scrollTop()+e(window).height(),i=o.offset().top+o.outerHeight()+80;if(t>i)s.css({position:"static"});else{var n;n=e(".js-notify .alert").length>0&&"block"===e(".js-notify").css("display")?e(window).height()-e(".js-notify").position().top:0,s.css({position:"fixed",bottom:n,width:"850px",boxSizing:"border-box",zIndex:100})}};a(),t.listenTo(n,"done",function(){a()});var r=i.throttle(a,100);s.length>0&&window.addEventListener("scroll",r,!1)},REG:{url:/^(https?|ftp|weixin):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,tel:/^(tel|callto):\/\/[-\s\d,]+$/i},ANIMITION_END:"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",Cache:{},updateModel:function(t){var n,s,o,a,r,l,c=e(t.target),h=this;if(h.model&&(o=(c.attr("name")||"").split("[")[0])){if(n=(c.attr("type")||"").toLowerCase(),a="checkbox"===n?c.prop("checked"):"radio"===n?h.$("[name="+c.attr("name")+"]:checked").val():c.val(),s=(c.data("type")||"").toLowerCase(),s=s||("checkbox"===n?"number":"string"),s=s.substring(0,1).toUpperCase()+s.substring(1),r=t.target&&t.target.tagName.toLowerCase(),"select"===r&&(l=!!c.attr("multiple")),i.isFunction(window[s])&&("select"===r&&l?null!==a&&(a=i.map(a,function(t){return window[s](t)})):a=window[s](a)),this.model.set(o,a,{validate:!1}),this.model.validate&&"no"!==c.data("validate")){var u={};u[o]=a,this.model.validate(u)}t.stopPropagation()}}}}),define("components/delay_hover/com",["require","jquery","underscore"],function(t){var e=t("jquery"),i=t("underscore"),n={initialize:function(t){var i=e.extend({},{showDelayTime:200,hideDelayTime:200,destroyPop:!0,targetElem:"",popElem:"",showCallback:null,hideCallback:null},t);this.timeout=null,this.outPop=!0,this.outTarget=!0,this.events(i)},events:function(t){var i=this;e("body").on("mouseover",t.targetElem,function(){i.showPop(t)}).on("mouseout",t.targetElem,function(){clearTimeout(i.timeout),i.outTarget=!0,i.hidePop(t)}),e("body").on("mouseover",t.popElem,function(){i.outPop=!1}).on("mouseout",t.popElem,function(){clearTimeout(i.timeout),i.outPop=!0,i.hidePop(t)})},showPop:function(t){var n=this;n.outTarget=!1,n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(function(){i.isFunction(t.showCallback)&&t.showCallback(),t.destroyPop&&e(t.popElem).remove()},t.showDelayTime)},hidePop:function(t){var n=this;n.timeout=setTimeout(function(){n.outTarget&&n.outPop&&(i.isFunction(t.hideCallback)?t.hideCallback():e(t.popElem).hide())},t.hideDelayTime)}};return function(t){n.initialize(t)}}),define("text",{load:function(t){throw new Error("Dynamic load not allowed: "+t)}}),define("text!components/page_help/templates/help.html",[],function(){return'<% if (templateType === \'btn\') { %>\n    <div id="js-page-help-open-btn" class="ui-page-help-open-btn">\n        帮助•客服\n    </div>\n<% } else if (templateType === \'content\') { %>\n    <div id="js-page-help-container" class="ui-page-help-container">\n        <div class="js-page-help-content ui-page-help-content loading">\n        </div>\n        <div class="js-page-help-btn-action ui-page-help-btn-action">\n            <a href="<%= _global.url.www %>/service/faq" class="ui-btn ui-btn-primary" target="_blank">进入帮助中心</a>\n            <a class="ui-btn" target="_blank" href="http://help.im.koudaitong.com">在线客服</a>\n            <% if (_global.kdt_id === 1) { %>\n                <a href="<%= _global.url.cp %>/tools/help/edit?id=<%= pageId %>" target="_blank" class="ui-page-help-edit">编辑</a>\n            <% } %>\n        </div>\n    </div>\n<% } %>\n'}),define("components/page_help/config",[],function(){return{index_dashboard:"index_dashboard",weixin_dashboard:"weixin_dashboard",weixin_message:"messages_my",messages_multiple:"messages_multiple_txt",messages_history:"messages_history_list",messages_multiple_delay:"messages_multiple_list",weixin_news_list:"news_list",weixin_news_create_1:"news_create_1",weixin_news_create_0:"news_create_0",autoreply_normal:"autoreply_normal",autoreply_default:"autoreply_default",autoreply_hosting:"autoreply_hosting",autoreply_activity:"autoreply_index_activity",autoreply_tail:"autoreply_index_tail",autoreply_scan:"autoreply_scan",shop_menu:"shop_menu_edit",sinaweibo_not_verify:"sinaweibo_not_verify",sinaweibo_timeline_index:"sinaweibo_timeline_index",sinaweibo_timeline_my:"sinaweibo_timeline_my",sinaweibo_timeline_byme:"sinaweibo_timeline_byme",sinaweibo_timeline_tome:"sinaweibo_timeline_tome",sinaweibo_timeline_mentions:"sinaweibo_timeline_mentions",sinaweibo_timeline_subscribe:"sinaweibo_timeline_subscribe",sinaweibo_message:"sinaweibo_message",sinaweibo_autoreply:"sinaweibo_autoreply",sinaweibo_articles:"sinaweibo_articles",sinaweibo_schedule:"sinaweibo_schedule",sinaweibo_autoreply_concerned:"sinaweibo_autoreply_concerned",sinaweibo_autoreply_at:"sinaweibo_autoreply_at",fans_dashboard:"fans_dashboard",fans_level:"fans_rule_index_level",fans_tag:"fans_rule_index_tag",fans_points_rule:"fans_rule_index_points",fans_search_basic:"fans_search_basic",fans_search_level:"fans_search_level",fans_search_behavior:"fans_search_behavior",fans_third:"fans_third",showcase_dashboard:"showcase_dashboard",showcase_feature:"feature_list",showcase_feature_create:"feature_create",showcase_category:"category_list",showcase_category_create:"category_create",showcase_homepage:"shop_homepage_edit",showcase_homepage_my_url:"showcase_homepage_my_url",showcase_homepage_list:"shop_homepage_list",showcase_usercenter:"shop_center_edit",showcase_shopnav:"shopnav",showcase_ad:"showcase_ad",showcase_component:"component_list",showcase_component_create:"component_create",showcase_homepage_domain:"shop_homepage_domain",showcase_attachment:"attachment_my_all",showcase_goods:"goods_list_on",showcase_goods_create:"goods_create",showcase_tag:"tag_list",showcase_tag_create:"tag_create",showcase_material:"material_list",showcase_paipai:"showcase_paipai",trade_dashboard:"trade_dashboard",trade_order_all:"order_normal",trade_order_complain:"order_complain",trade_order_selffetch:"trade_order_selffetch",trade_order_star:"trade_order_star",trade_order_gift:"trade_order_gift",trade_order_codpay:"trade_order_codpay",trade_order_peerpay:"trade_order_peerpay",trade_order_detail:"trade_order_detail",trade_paipai_order_detail:"trade_paipai_order_detail",trade_paipai_order_list:"trade_paipai_order_list",trade_freight:"trade_freight",trade_setting:"trade_setting",trade_selffetch:"trade_selffetch",trade_gift:"trade_gift",trade_peerpay:"trade_peerpay",trade_settlement_income:"trade_settlement_income",trade_settlement_withdrawal:"trade_settlement_withdrawal",trade_settlement_inoutdetail:"trade_settlement_inoutdetail",trade_settlement_withdrawallog:"trade_settlement_withdrawallog",trade_unionpay_withdraw:"trade_unionpay_withdraw",trade_unionpay_inoutdetail:"trade_unionpay_inoutdetail",trade_unionpay_withdrawlog:"trade_unionpay_withdrawlog",ump_dashboard:"ump_dashboard",ump_coupon:"ump_coupon",apps_open_api:"apps_open_api",apps_third:"apps_third",apps_checkin:"apps_checkin",apps_vote:"apps_vote",apps_vote_create:"apps_vote_create",apps_goods_search:"autoreply_index_search",apps_cards:"apps_cards",apps_wheel:"apps_wheel",apps_crazy_guess:"activity_list_type_7",apps_animals:"activity_list_type_4",apps_random:"activity_list_type_6",stat_dashboard:"stat_dashboard",stat_fans_count:"stat_fans_count",stat_layer:"stat_layer",stat_baseinfo:"stat_baseinfo",stat_behavior:"stat_behavior",stat_interact:"stat_interact",stat_multiple:"stat_multiple",stat_pagedata:"stat_pagedata",stat_pagerank:"stat_pagerank",stat_pvperday:"stat_pvperday",stat_goods:"stat_goods",stat_order:"stat_order",stat_qrcode:"stat_qrcode",setting_store:"setting_store",setting_weixin:"setting_weixin",setting_weibo:"setting_weibo",setting_admin:"setting_admin",setting_team:"setting_team",setting_payment_wxpay:"setting_payment_wxpay",setting_payment_alipay:"setting_payment_alipay",setting_payment_umpay:"setting_payment_umpay",setting_payment_cod:"setting_payment_cod",task_team:"task_team"}}),define("components/page_help/help",["require","jquery","underscore","components/delay_hover/com","text!components/page_help/templates/help.html","components/page_help/config"],function(t){var e=t("jquery"),i=t("underscore"),n=t("components/delay_hover/com"),s=t("text!components/page_help/templates/help.html"),o=t("components/page_help/config"),a={showBtn:"#js-page-help-open-btn",helpWrap:"#js-page-help-container",helpContent:"#js-page-help-container .js-page-help-content",helpBtnWrap:"#js-page-help-container .js-page-help-btn-action"},r={init:function(t){return this.pageId=t,t?(0===e(a.showBtn).size()&&this.appendBtn(),e(a.helpWrap).size()>0&&e(a.helpWrap).remove(),this.appendContent(),this.events(),void this.fetch(this.pageId)):(e(a.showBtn).remove(),void e(a.helpWrap).remove())},appendBtn:function(){e("body").append(i.template(s,{templateType:"btn"}))},appendContent:function(){e("body").append(i.template(s,{templateType:"content",pageId:this.pageId}))},fetch:function(t){var i=this,n=window._global.url.www+"/common/pagehelp/help",s="本页面暂时没有帮助。",o="";e.get(n,{id:t},function(t){o=t||s,e(a.helpContent).removeClass("loading").html(o),i.helpSize(),i.renderLink()})},events:function(){var t=this;n({destroyPop:!1,targetElem:a.showBtn,popElem:a.helpWrap,showCallback:function(){t.showHelp()},hideCallback:function(){t.hideHelp()}}),e(window).on("resize",function(){t.helpSize()})},hideHelp:function(){e(a.helpWrap).animate({right:-320},300)},showHelp:function(){e(a.helpWrap).animate({right:0},300)},renderLink:function(){e("a",e(a.helpContent)).attr("target","_blank")},helpSize:function(){e(a.helpContent).css({height:"100%"});var t=e(a.helpWrap).outerHeight(),i=e(a.helpBtnWrap).outerHeight()+40,n=e(window).height()-40,s=t>=n?n-i:t-i;e(a.helpContent).css({height:s}),e(a.helpWrap).css({"margin-bottom":-(s/2)-53})}};return function(t,i){var n=o[t],s=e.extend({hasPageHelp:!0},i);s.hasPageHelp&&r.init(n)}}),function(t){"object"==typeof exports?module.exports=t(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backboneValidate",["backbone","underscore"],t)}(function(t,e){return t.Validation=function(e){var i={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(t,e){return c[i.labelFormatter](t,e)},format:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return e.replace(/\{(\d+)\}/g,function(e,i){return"undefined"!=typeof t[i]?t[i]:e})}},s=function(i,n,o){return n=n||{},o=o||"",e.each(i,function(e,a){i.hasOwnProperty(a)&&(e&&"object"==typeof e&&!(e instanceof Array||e instanceof Date||e instanceof RegExp||e instanceof t.Model||e instanceof t.Collection)?s(e,n,o+a+"."):n[o+a]=e)}),n},o=function(){var t=function(t){return e.reduce(e.keys(t.validation||{}),function(t,e){return t[e]=void 0,t},{})},o=function(t,i){var n=t.validation?t.validation[i]||{}:{};return(e.isFunction(n)||e.isString(n))&&(n={fn:n}),e.isArray(n)||(n=[n]),e.reduce(n,function(t,i){return e.each(e.without(e.keys(i),"msg"),function(e){t.push({fn:h[e],val:i[e],msg:i.msg})}),t},[])},r=function(t,i,s,a){return e.reduce(o(t,i),function(o,r){var l=e.extend({},n,h),c=r.fn.call(l,s,i,r.val,t,a);return c===!1||o===!1?!1:c&&!o?r.msg||c:o},"")},l=function(t,i){var n,o={},a=!0,l=e.clone(i),c=s(i);return e.each(c,function(e,i){n=r(t,i,e,l),n&&(o[i]=n,a=!1)}),{invalidAttrs:o,isValid:a}},c=function(i,n){return{preValidate:function(t,i){return r(this,t,i,e.extend({},this.attributes))},isValid:function(t){var i=s(this.attributes);return e.isString(t)?!r(this,t,i[t],e.extend({},this.attributes)):e.isArray(t)?e.reduce(t,function(t,n){return t&&!r(this,n,i[n],e.extend({},this.attributes))},!0,this):(t===!0&&this.validate(),this.validation?this._isValid:!0)},validate:function(o,a){var r=this,c=!o,h=e.extend({},n,a),u=t(r),d=e.extend({},u,r.attributes,o),p=s(o||d),f=l(r,d);return r._isValid=f.isValid,e.each(u,function(t,e){var n=f.invalidAttrs.hasOwnProperty(e);n||h.valid(i,e,h.selector)}),e.each(u,function(t,e){var n=f.invalidAttrs.hasOwnProperty(e),s=p.hasOwnProperty(e);n&&(s||c)&&h.invalid(i,e,f.invalidAttrs[e],h.selector)}),e.defer(function(){r.trigger("validated",r._isValid,r,f.invalidAttrs),r.trigger("validated:"+(r._isValid?"valid":"invalid"),r,f.invalidAttrs)}),!h.forceUpdate&&e.intersection(e.keys(f.invalidAttrs),e.keys(p)).length>0?f.invalidAttrs:void 0}}},u=function(t,i,n){e.extend(i,c(t,n))},d=function(t){delete t.validate,delete t.preValidate,delete t.isValid},p=function(t){u(this.view,t,this.options)},f=function(t){d(t)};return{version:"0.8.0",configure:function(t){e.extend(i,t)},bind:function(t,n){var s=t.model,o=t.collection;if(n=e.extend({},i,a,n),"undefined"==typeof s&&"undefined"==typeof o)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";s?u(t,s,n):o&&(o.each(function(e){u(t,e,n)}),o.bind("add",p,{view:t,options:n}),o.bind("remove",f))},unbind:function(t){var e=t.model,i=t.collection;e&&d(t.model),i&&(i.each(function(t){d(t)}),i.unbind("add",p),i.unbind("remove",f))},mixin:c(null,i)}}(),a=o.callbacks={valid:function(t,e,i){t.$("["+i+'~="'+e+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(t,e,i,n){t.$("["+n+'~="'+e+'"]').addClass("invalid").attr("data-error",i)}},r=o.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp|weixin):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},l=o.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},c=o.labelFormatters={none:function(t){return t},sentenceCase:function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toUpperCase():" "+t.toLowerCase()}).replace("_"," ")},label:function(t,e){return e.labels&&e.labels[t]||c.sentenceCase(t,e)}},h=o.validators=function(){var t=String.prototype.trim?function(t){return null===t?"":String.prototype.trim.call(t)}:function(t){var e=/^\s+/,i=/\s+$/;return null===t?"":t.toString().replace(e,"").replace(i,"")},i=function(t){return e.isNumber(t)||e.isString(t)&&t.match(r.number)},n=function(i){return!(e.isNull(i)||e.isUndefined(i)||e.isString(i)&&""===t(i)||e.isArray(i)&&e.isEmpty(i))};return{fn:function(t,i,n,s,o){return e.isString(n)&&(n=s[n]),n.call(s,t,i,o)},required:function(t,i,s,o,a){var r=e.isFunction(s)?s.call(o,t,i,a):s;return r||n(t)?r&&!n(t)?this.format(l.required,this.formatLabel(i,o)):void 0:!1},acceptance:function(t,i,n,s){return"true"===t||e.isBoolean(t)&&t!==!1?void 0:this.format(l.acceptance,this.formatLabel(i,s))},min:function(t,e,n,s){return!i(t)||n>t?this.format(l.min,this.formatLabel(e,s),n):void 0},max:function(t,e,n,s){return!i(t)||t>n?this.format(l.max,this.formatLabel(e,s),n):void 0},range:function(t,e,n,s){return!i(t)||t<n[0]||t>n[1]?this.format(l.range,this.formatLabel(e,s),n[0],n[1]):void 0},length:function(e,i,s,o){return n(e)&&t(e).length===s?void 0:this.format(l.length,this.formatLabel(i,o),s)},minLength:function(e,i,s,o){return!n(e)||t(e).length<s?this.format(l.minLength,this.formatLabel(i,o),s):void 0},maxLength:function(e,i,s,o){return!n(e)||t(e).length>s?this.format(l.maxLength,this.formatLabel(i,o),s):void 0},rangeLength:function(e,i,s,o){return!n(e)||t(e).length<s[0]||t(e).length>s[1]?this.format(l.rangeLength,this.formatLabel(i,o),s[0],s[1]):void 0},oneOf:function(t,i,n,s){return e.include(n,t)?void 0:this.format(l.oneOf,this.formatLabel(i,s),n.join(", "))},equalTo:function(t,e,i,n,s){return t!==s[i]?this.format(l.equalTo,this.formatLabel(e,n),this.formatLabel(i,n)):void 0},pattern:function(t,e,i,s){return n(t)&&t.toString().match(r[i]||i)?void 0:this.format(l.pattern,this.formatLabel(e,s),i)}}}();return o}(e),t.Validation}),define("core/event",["backbone.wreqr"],function(){return window.NC?window.NC:(window.NC=new Backbone.Wreqr.EventAggregator,window.NC)}),define("components/backtop/1.0.0/backtop",["require","jquery","underscore"],function(t){function e(){i(window).scrollTop()>150?s.parent().removeClass("hide"):s.parent().addClass("hide")}var i=t("jquery"),n=t("underscore"),s=i(".js-back-to-top");s.length<=0||(i(window).on("scroll",n.throttle(e,100)),s.on("click",function(t){window.scrollTo(0,0),t.preventDefault(),t.stopPropagation()}))}),define("core/auth",["require","jquery","core/utils"],function(t){var e=t("jquery"),i=t("core/utils");e(document).on("click",".js-no-auth",function(t){t.preventDefault(),i.errorNotify("客服账号没有操作权限。如有问题，请联系店铺高级管理员。")})}),define("common",["jquery","underscore","core/event","components/backtop/1.0.0/backtop","core/auth"],function(t,e){return t.ajaxPrefilter(function(t){if(window._global.online_debug===!0&&window._global.debug===!0){var e=t.url;if(e.indexOf("?")>0){var i=e.split("?"),n=i[1].split("&");n.push("debug="+window._global.debug),e=i[0]+"?"+n.join("&")}else e+="?debug="+window._global.debug;t.url=e}}),t(function(){var i=window,n=function(){var e=i.innerHeight,n=t("aside.sidebar"),s=e-66;n.css({minHeight:s})};n();var s=e.throttle(n,500);t(i).resize(s)}),t}),function(t,e){function i(e,i){var s,o,a,r=e.nodeName.toLowerCase();return"area"===r?(s=e.parentNode,o=s.name,e.href&&o&&"map"===s.nodeName.toLowerCase()?(a=t("img[usemap=#"+o+"]")[0],!!a&&n(a)):!1):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r?e.href||i:i)&&n(e)}function n(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var s=0,o=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var n,s,o=t(this[0]);o.length&&o[0]!==document;){if(n=o.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(s=parseInt(o.css("zIndex"),10),!isNaN(s)&&0!==s))return s;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return i(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var n=t.attr(e,"tabindex"),s=isNaN(n);return(s||n>=0)&&i(e,!s)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,n){function s(e,i,n,s){return t.each(o,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var o="Width"===n?["Left","Right"]:["Top","Bottom"],a=n.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(i){return i===e?r["inner"+n].call(this):this.each(function(){t(this).css(a,s(this,i)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?r["outer"+n].call(this,e):this.each(function(){t(this).css(a,s(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,n){var s,o=t.ui[e].prototype;for(s in n)o.plugins[s]=o.plugins[s]||[],o.plugins[s].push([i,n[s]])},call:function(t,e,i){var n,s=t.plugins[e];if(s&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(n=0;n<s.length;n++)t.options[s[n][0]]&&s[n][1].apply(t.element,i)}},hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",s=!1;return e[n]>0?!0:(e[n]=1,s=e[n]>0,e[n]=0,s)}})}(jQuery),function(t,e){var i=0,n=Array.prototype.slice,s=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(o){}s(e)},t.widget=function(e,i,n){var s,o,a,r,l={},c=e.split(".")[0];e=e.split(".")[1],s=c+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[c]=t[c]||{},o=t[c][e],a=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=s,e=n.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(l[e]=n)}),a.prototype=t.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix:e},l,{constructor:a,namespace:c,widgetName:e,widgetFullName:s}),o?(t.each(o._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a)},t.widget.extend=function(i){for(var s,o,a=n.call(arguments,1),r=0,l=a.length;l>r;r++)for(s in a[r])o=a[r][s],a[r].hasOwnProperty(s)&&o!==e&&(i[s]=t.isPlainObject(o)?t.isPlainObject(i[s])?t.widget.extend({},i[s],o):t.widget.extend({},o):o);return i},t.widget.bridge=function(i,s){var o=s.prototype.widgetFullName||i;t.fn[i]=function(a){var r="string"==typeof a,l=n.call(arguments,1),c=this;return a=!r&&l.length?t.widget.extend.apply(null,[a].concat(l)):a,this.each(r?function(){var n,s=t.data(this,o);return s?t.isFunction(s[a])&&"_"!==a.charAt(0)?(n=s[a].apply(s,l),n!==s&&n!==e?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+a+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+a+"'")}:function(){var e=t.data(this,o);e?e.option(a||{})._init():t.data(this,o,new s(a,this))}),c}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var s,o,a,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},s=i.split("."),i=s.shift(),s.length){for(o=r[i]=t.widget.extend({},this.options[i]),a=0;a<s.length-1;a++)o[s[a]]=o[s[a]]||{},o=o[s[a]];if(i=s.pop(),n===e)return o[i]===e?null:o[i];o[i]=n}else{if(n===e)return this.options[i]===e?null:this.options[i];r[i]=n}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this
},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var s,o=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,function(n,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,h=l[2];h?s.delegate(h,c,r):i.bind(c,r)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,o,a=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,s,o){"string"==typeof s&&(s={effect:s});var a,r=s?s===!0||"number"==typeof s?i:s.effect||i:e;s=s||{},"number"==typeof s&&(s={duration:s}),a=!t.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),a&&t.effects&&t.effects.effect[r]?n[e](s):r!==e&&n[r]?n[r](s.duration,s.easing,o):n.queue(function(i){t(this)[e](),o&&o.call(n[0]),i()})}})}(jQuery),function(t){var e=!1;t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,s=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return s&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(t,e){function i(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function n(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var o,a=Math.max,r=Math.abs,l=Math.round,c=/left|center|right/,h=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(o!==e)return o;var i,n,s=t("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return t("body").append(s),i=a.offsetWidth,s.css("overflow","scroll"),n=a.offsetWidth,i===n&&(n=s[0].clientWidth),s.remove(),o=i-n},getScrollInfo:function(e){var i=e.isWindow?"":e.element.css("overflow-x"),n=e.isWindow?"":e.element.css("overflow-y"),s="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:s?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]);return{element:i,isWindow:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return f.apply(this,arguments);e=t.extend({},e);var o,p,m,g,v,y,_=t(e.of),b=t.position.getWithinInfo(e.within),w=t.position.getScrollInfo(b),x=(e.collision||"flip").split(" "),k={};return y=s(_),_[0].preventDefault&&(e.at="left top"),p=y.width,m=y.height,g=y.offset,v=t.extend({},g),t.each(["my","at"],function(){var t,i,n=(e[this]||"").split(" ");1===n.length&&(n=c.test(n[0])?n.concat(["center"]):h.test(n[0])?["center"].concat(n):["center","center"]),n[0]=c.test(n[0])?n[0]:"center",n[1]=h.test(n[1])?n[1]:"center",t=u.exec(n[0]),i=u.exec(n[1]),k[this]=[t?t[0]:0,i?i[0]:0],e[this]=[d.exec(n[0])[0],d.exec(n[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?v.left+=p:"center"===e.at[0]&&(v.left+=p/2),"bottom"===e.at[1]?v.top+=m:"center"===e.at[1]&&(v.top+=m/2),o=i(k.at,p,m),v.left+=o[0],v.top+=o[1],this.each(function(){var s,c,h=t(this),u=h.outerWidth(),d=h.outerHeight(),f=n(this,"marginLeft"),y=n(this,"marginTop"),C=u+f+n(this,"marginRight")+w.width,D=d+y+n(this,"marginBottom")+w.height,T=t.extend({},v),j=i(k.my,h.outerWidth(),h.outerHeight());"right"===e.my[0]?T.left-=u:"center"===e.my[0]&&(T.left-=u/2),"bottom"===e.my[1]?T.top-=d:"center"===e.my[1]&&(T.top-=d/2),T.left+=j[0],T.top+=j[1],t.support.offsetFractions||(T.left=l(T.left),T.top=l(T.top)),s={marginLeft:f,marginTop:y},t.each(["left","top"],function(i,n){t.ui.position[x[i]]&&t.ui.position[x[i]][n](T,{targetWidth:p,targetHeight:m,elemWidth:u,elemHeight:d,collisionPosition:s,collisionWidth:C,collisionHeight:D,offset:[o[0]+j[0],o[1]+j[1]],my:e.my,at:e.at,within:b,elem:h})}),e.using&&(c=function(t){var i=g.left-T.left,n=i+p-u,s=g.top-T.top,o=s+m-d,l={target:{element:_,left:g.left,top:g.top,width:p,height:m},element:{element:h,left:T.left,top:T.top,width:u,height:d},horizontal:0>n?"left":i>0?"right":"center",vertical:0>o?"top":s>0?"bottom":"middle"};u>p&&r(i+n)<p&&(l.horizontal="center"),d>m&&r(s+o)<m&&(l.vertical="middle"),l.important=a(r(i),r(n))>a(r(s),r(o))?"horizontal":"vertical",e.using.call(this,t,l)}),h.offset(t.extend(T,{using:c}))})},t.ui.position={fit:{left:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollLeft:n.offset.left,o=n.width,r=t.left-e.collisionPosition.marginLeft,l=s-r,c=r+e.collisionWidth-o-s;e.collisionWidth>o?l>0&&0>=c?(i=t.left+l+e.collisionWidth-o-s,t.left+=l-i):t.left=c>0&&0>=l?s:l>c?s+o-e.collisionWidth:s:l>0?t.left+=l:c>0?t.left-=c:t.left=a(t.left-r,t.left)},top:function(t,e){var i,n=e.within,s=n.isWindow?n.scrollTop:n.offset.top,o=e.within.height,r=t.top-e.collisionPosition.marginTop,l=s-r,c=r+e.collisionHeight-o-s;e.collisionHeight>o?l>0&&0>=c?(i=t.top+l+e.collisionHeight-o-s,t.top+=l-i):t.top=c>0&&0>=l?s:l>c?s+o-e.collisionHeight:s:l>0?t.top+=l:c>0?t.top-=c:t.top=a(t.top-r,t.top)}},flip:{left:function(t,e){var i,n,s=e.within,o=s.offset.left+s.scrollLeft,a=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,c=t.left-e.collisionPosition.marginLeft,h=c-l,u=c+e.collisionWidth-a-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>h?(i=t.left+d+p+f+e.collisionWidth-a-o,(0>i||i<r(h))&&(t.left+=d+p+f)):u>0&&(n=t.left-e.collisionPosition.marginLeft+d+p+f-l,(n>0||r(n)<u)&&(t.left+=d+p+f))},top:function(t,e){var i,n,s=e.within,o=s.offset.top+s.scrollTop,a=s.height,l=s.isWindow?s.scrollTop:s.offset.top,c=t.top-e.collisionPosition.marginTop,h=c-l,u=c+e.collisionHeight-a-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];0>h?(n=t.top+p+f+m+e.collisionHeight-a-o,t.top+p+f+m>h&&(0>n||n<r(h))&&(t.top+=p+f+m)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+m-l,t.top+p+f+m>u&&(i>0||r(i)<u)&&(t.top+=p+f+m))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,s,o,a=document.getElementsByTagName("body")[0],r=document.createElement("div");e=document.createElement(a?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in n)e.style[o]=n[o];e.appendChild(r),i=a||document.documentElement,i.insertBefore(e,i.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",s=t(r).offset().left,t.support.offsetFractions=s>10&&11>s,e.innerHTML="",i.removeChild(e)}()}(jQuery),function(t){t.widget("ui.draggable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",e,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"original"!==this.options.helper||t.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,s=this.options;return s.containment?"window"===s.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===s.containment?void(this.containment=[0,0,t(document).width()-this.helperProportions.width-this.margins.left,(t(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):s.containment.constructor===Array?void(this.containment=s.containment):("parent"===s.containment&&(s.containment=this.helper[0].parentNode),i=t(s.containment),n=i[0],void(n&&(e="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i))):void(this.containment=null)},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()}),{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*n}},_generatePosition:function(e){var i,n,s,o,a=this.options,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=e.pageX,c=e.pageY;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),a.grid&&(s=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=i?s-this.offset.click.top>=i[1]||s-this.offset.click.top>i[3]?s:s-this.offset.click.top>=i[1]?s-a.grid[1]:s+a.grid[1]:s,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var n=t(this).data("ui-draggable"),s=n.options,o=t.extend({},i,{item:n.element});n.sortables=[],t(s.connectToSortable).each(function(){var i=t.data(this,"ui-sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",e,o))})},stop:function(e,i){var n=t(this).data("ui-draggable"),s=t.extend({},i,{item:n.element});t.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,s))})},drag:function(e,i){var n=t(this).data("ui-draggable"),s=this;t.each(n.sortables,function(){var o=!1,a=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,t.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(s).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",e),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",e),n.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),i=t(this).data("ui-draggable").options;e.css("cursor")&&(i._cursor=e.css("cursor")),e.css("cursor",i.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var n=t(i.helper),s=t(this).data("ui-draggable").options;n.css("opacity")&&(s._opacity=n.css("opacity")),n.css("opacity",s.opacity)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var i=t(this).data("ui-draggable"),n=i.options,s=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop+n.scrollSpeed:e.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-e.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft+n.scrollSpeed:e.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(document).scrollTop()<n.scrollSensitivity?s=t(document).scrollTop(t(document).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<n.scrollSensitivity&&(s=t(document).scrollTop(t(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(document).scrollLeft()<n.scrollSensitivity?s=t(document).scrollLeft(t(document).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<n.scrollSensitivity&&(s=t(document).scrollLeft(t(document).scrollLeft()+n.scrollSpeed)))),s!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),i=e.options;e.snapElements=[],t(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=t(this),n=i.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(e,i){var n,s,o,a,r,l,c,h,u,d,p=t(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=i.offset.left,v=g+p.helperProportions.width,y=i.offset.top,_=y+p.helperProportions.height;for(u=p.snapElements.length-1;u>=0;u--)r=p.snapElements[u].left,l=r+p.snapElements[u].width,c=p.snapElements[u].top,h=c+p.snapElements[u].height,r-m>v||g>l+m||c-m>_||y>h+m||!t.contains(p.snapElements[u].item.ownerDocument,p.snapElements[u].item)?(p.snapElements[u].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(c-_)<=m,s=Math.abs(h-y)<=m,o=Math.abs(r-v)<=m,a=Math.abs(l-g)<=m,n&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),s&&(i.position.top=p._convertPositionTo("relative",{top:h,left:0}).top-p.margins.top),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r-p.helperProportions.width}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),d=n||s||o||a,"outer"!==f.snapMode&&(n=Math.abs(c-y)<=m,s=Math.abs(h-_)<=m,o=Math.abs(r-g)<=m,a=Math.abs(l-v)<=m,n&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),s&&(i.position.top=p._convertPositionTo("relative",{top:h-p.helperProportions.height,left:0}).top-p.margins.top),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[u].snapping&&(n||s||o||a||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=n||s||o||a||d)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,i=this.data("ui-draggable").options,n=t.makeArray(t(i.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});n.length&&(e=parseInt(t(n[0]).css("zIndex"),10)||0,t(n).each(function(i){t(this).css("zIndex",e+i)}),this.css("zIndex",e+n.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var n=t(i.helper),s=t(this).data("ui-draggable").options;n.css("zIndex")&&(s._zIndex=n.css("zIndex")),n.css("zIndex",s.zIndex)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}t.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(i)?i:function(t){return t.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},t.ui.ddmanager.droppables[e.scope]=t.ui.ddmanager.droppables[e.scope]||[],t.ui.ddmanager.droppables[e.scope].push(this),e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,i=t.ui.ddmanager.droppables[this.options.scope];e<i.length;e++)i[e]===this&&i.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){"accept"===e&&(this.accept=t.isFunction(i)?i:function(t){return t.is(i)}),t.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,s=!1;return n&&(n.currentItem||n.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"ui-droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope===n.options.scope&&e.accept.call(e.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(s=!0,!1):void 0}),s?!1:this.accept.call(this.element[0],n.currentItem||n.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}
}}),t.ui.intersect=function(t,i,n){if(!i.offset)return!1;var s,o,a=(t.positionAbs||t.position.absolute).left,r=a+t.helperProportions.width,l=(t.positionAbs||t.position.absolute).top,c=l+t.helperProportions.height,h=i.offset.left,u=h+i.proportions.width,d=i.offset.top,p=d+i.proportions.height;switch(n){case"fit":return a>=h&&u>=r&&l>=d&&p>=c;case"intersect":return h<a+t.helperProportions.width/2&&r-t.helperProportions.width/2<u&&d<l+t.helperProportions.height/2&&c-t.helperProportions.height/2<p;case"pointer":return s=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,o=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(o,d,i.proportions.height)&&e(s,h,i.proportions.width);case"touch":return(l>=d&&p>=l||c>=d&&p>=c||d>l&&c>p)&&(a>=h&&u>=a||r>=h&&u>=r||h>a&&r>u);default:return!1}},t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var n,s,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;n<o.length;n++)if(!(o[n].options.disabled||e&&!o[n].accept.call(o[n].element[0],e.currentItem||e.element))){for(s=0;s<r.length;s++)if(r[s]===o[n].element[0]){o[n].proportions.height=0;continue t}o[n].visible="none"!==o[n].element.css("display"),o[n].visible&&("mousedown"===a&&o[n]._activate.call(o[n],i),o[n].offset=o[n].element.offset(),o[n].proportions={width:o[n].element[0].offsetWidth,height:o[n].element[0].offsetHeight})}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,s,o,a=t.ui.intersect(e,this,this.options.tolerance),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(s=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t.data(this,"ui-droppable").options.scope===s}),o.length&&(n=t.data(o[0],"ui-droppable"),n.greedyChild="isover"===r)),n&&"isover"===r&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),n&&"isout"===r&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}}}(jQuery),function(t){function e(t){return parseInt(t,10)||0}function i(t){return!isNaN(parseInt(t,10))}t.widget("ui.resizable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,i,n,s,o,a=this,r=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;i<e.length;i++)n=t.trim(e[i]),o="ui-resizable-"+n,s=t("<div class='ui-resizable-handle "+o+"'></div>"),s.css({zIndex:r.zIndex}),"se"===n&&s.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(s);this._renderAxis=function(e){var i,n,s,o;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=t(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),s=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(s,o),this._proportionallyResize()),t(this.handles[i]).length},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(s=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=s&&s[1]?s[1]:"se")}),r.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(t(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){r.disabled||a.resizing||(t(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,n,s=!1;for(i in this.handles)n=t(this.handles[i])[0],(n===e.target||t.contains(n,e.target))&&(s=!0);return!this.options.disabled&&s},_mouseStart:function(i){var n,s,o,a=this.options,r=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:r.top,left:r.left}),this._renderProxy(),n=e(this.helper.css("left")),s=e(this.helper.css("top")),a.containment&&(n+=t(a.containment).scrollLeft()||0,s+=t(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:s},this.size=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:n,top:s},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===o?this.axis+"-resize":o),l.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(e){var i,n=this.helper,s={},o=this.originalMousePosition,a=this.axis,r=this.position.top,l=this.position.left,c=this.size.width,h=this.size.height,u=e.pageX-o.left||0,d=e.pageY-o.top||0,p=this._change[a];return p?(i=p.apply(this,[e,u,d]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),this.position.top!==r&&(s.top=this.position.top+"px"),this.position.left!==l&&(s.left=this.position.left+"px"),this.size.width!==c&&(s.width=this.size.width+"px"),this.size.height!==h&&(s.height=this.size.height+"px"),n.css(s),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,n,s,o,a,r,l,c=this.options,h=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),s=n&&t.ui.hasScroll(i[0],"left")?0:h.sizeDiff.height,o=n?0:h.sizeDiff.width,a={width:h.helper.width()-o,height:h.helper.height()-s},r=parseInt(h.element.css("left"),10)+(h.position.left-h.originalPosition.left)||null,l=parseInt(h.element.css("top"),10)+(h.position.top-h.originalPosition.top)||null,c.animate||this.element.css(t.extend(a,{top:l,left:r})),h.helper.height(h.size.height),h.helper.width(h.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(t){var e,n,s,o,a,r=this.options;a={minWidth:i(r.minWidth)?r.minWidth:0,maxWidth:i(r.maxWidth)?r.maxWidth:1/0,minHeight:i(r.minHeight)?r.minHeight:0,maxHeight:i(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||t)&&(e=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,n=a.maxHeight*this.aspectRatio,o=a.maxWidth/this.aspectRatio,e>a.minWidth&&(a.minWidth=e),s>a.minHeight&&(a.minHeight=s),n<a.maxWidth&&(a.maxWidth=n),o<a.maxHeight&&(a.maxHeight=o)),this._vBoundaries=a},_updateCache:function(t){this.offset=this.helper.offset(),i(t.left)&&(this.position.left=t.left),i(t.top)&&(this.position.top=t.top),i(t.height)&&(this.size.height=t.height),i(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,n=this.size,s=this.axis;return i(t.height)?t.width=t.height*this.aspectRatio:i(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(n.width-t.width),t.top=null),"nw"===s&&(t.top=e.top+(n.height-t.height),t.left=e.left+(n.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,n=this.axis,s=i(t.width)&&e.maxWidth&&e.maxWidth<t.width,o=i(t.height)&&e.maxHeight&&e.maxHeight<t.height,a=i(t.width)&&e.minWidth&&e.minWidth>t.width,r=i(t.height)&&e.minHeight&&e.minHeight>t.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,h=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return a&&(t.width=e.minWidth),r&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),o&&(t.height=e.maxHeight),a&&h&&(t.left=l-e.minWidth),s&&h&&(t.left=l-e.maxWidth),r&&u&&(t.top=c-e.minHeight),o&&u&&(t.top=c-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var t,e,i,n,s,o=this.helper||this.element;for(t=0;t<this._proportionallyResizeElements.length;t++){if(s=this._proportionallyResizeElements[t],!this.borderDif)for(this.borderDif=[],i=[s.css("borderTopWidth"),s.css("borderRightWidth"),s.css("borderBottomWidth"),s.css("borderLeftWidth")],n=[s.css("paddingTop"),s.css("paddingRight"),s.css("paddingBottom"),s.css("paddingLeft")],e=0;e<i.length;e++)this.borderDif[e]=(parseInt(i[e],10)||0)+(parseInt(n[e],10)||0);s.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,n=this.originalPosition;return{left:n.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize,s=this.originalPosition;return{top:s.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).data("ui-resizable"),n=i.options,s=i._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),a=o&&t.ui.hasScroll(s[0],"left")?0:i.sizeDiff.height,r=o?0:i.sizeDiff.width,l={width:i.size.width-r,height:i.size.height-a},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,h=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,h&&c?{top:h,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};s&&s.length&&t(s[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i,n,s,o,a,r,l,c=t(this).data("ui-resizable"),h=c.options,u=c.element,d=h.containment,p=d instanceof t?d.get(0):/parent/.test(d)?u.parent().get(0):d;p&&(c.containerElement=t(p),/document/.test(d)||d===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(i=t(p),n=[],t(["Top","Right","Left","Bottom"]).each(function(t,s){n[t]=e(i.css("padding"+s))}),c.containerOffset=i.offset(),c.containerPosition=i.position(),c.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]},s=c.containerOffset,o=c.containerSize.height,a=c.containerSize.width,r=t.ui.hasScroll(p,"left")?p.scrollWidth:a,l=t.ui.hasScroll(p)?p.scrollHeight:o,c.parentData={element:p,left:s.left,top:s.top,width:r,height:l}))},resize:function(e){var i,n,s,o,a=t(this).data("ui-resizable"),r=a.options,l=a.containerOffset,c=a.position,h=a._aspectRatio||e.shiftKey,u={top:0,left:0},d=a.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),c.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-u.left),h&&(a.size.height=a.size.width/a.aspectRatio),a.position.left=r.helper?l.left:0),c.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),h&&(a.size.width=a.size.height*a.aspectRatio),a.position.top=a._helper?l.top:0),a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top,i=Math.abs((a._helper?a.offset.left-u.left:a.offset.left-u.left)+a.sizeDiff.width),n=Math.abs((a._helper?a.offset.top-u.top:a.offset.top-l.top)+a.sizeDiff.height),s=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),s&&o&&(i-=a.parentData.left),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,h&&(a.size.height=a.size.width/a.aspectRatio)),n+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-n,h&&(a.size.width=a.size.height*a.aspectRatio))},stop:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.containerOffset,s=e.containerPosition,o=e.containerElement,a=t(e.helper),r=a.offset(),l=a.outerWidth()-e.sizeDiff.width,c=a.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(o.css("position"))&&t(this).css({left:r.left-s.left-n.left,width:l,height:c}),e._helper&&!i.animate&&/static/.test(o.css("position"))&&t(this).css({left:r.left-s.left-n.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,n=function(e){t(e).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):t.each(i.alsoResize,function(t){n(t)})},resize:function(e,i){var n=t(this).data("ui-resizable"),s=n.options,o=n.originalSize,a=n.originalPosition,r={height:n.size.height-o.height||0,width:n.size.width-o.width||0,top:n.position.top-a.top||0,left:n.position.left-a.left||0},l=function(e,n){t(e).each(function(){var e=t(this),s=t(this).data("ui-resizable-alsoresize"),o={},a=n&&n.length?n:e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(a,function(t,e){var i=(s[e]||0)+(r[e]||0);i&&i>=0&&(o[e]=i||null)}),e.css(o)})};"object"!=typeof s.alsoResize||s.alsoResize.nodeType?l(s.alsoResize):t.each(s.alsoResize,function(t,e){l(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.size,s=e.originalSize,o=e.originalPosition,a=e.axis,r="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=r[0]||1,c=r[1]||1,h=Math.round((n.width-s.width)/l)*l,u=Math.round((n.height-s.height)/c)*c,d=s.width+h,p=s.height+u,f=i.maxWidth&&i.maxWidth<d,m=i.maxHeight&&i.maxHeight<p,g=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=r,g&&(d+=l),v&&(p+=c),f&&(d-=l),m&&(p-=c),/^(se|s|e)$/.test(a)?(e.size.width=d,e.size.height=p):/^(ne)$/.test(a)?(e.size.width=d,e.size.height=p,e.position.top=o.top-u):/^(sw)$/.test(a)?(e.size.width=d,e.size.height=p,e.position.left=o.left-h):(e.size.width=d,e.size.height=p,e.position.top=o.top-u,e.position.left=o.left-h)}})}(jQuery),function(t){t.widget("ui.selectable",t.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),t(e.target).parents().addBack().each(function(){var n,s=t.data(this,"selectable-item");return s?(n=!e.metaKey&&!e.ctrlKey||!s.$element.hasClass("ui-selected"),s.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),s.unselecting=!n,s.selecting=n,s.selected=n,n?i._trigger("selecting",e,{selecting:s.element}):i._trigger("unselecting",e,{unselecting:s.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,s=this.options,o=this.opos[0],a=this.opos[1],r=e.pageX,l=e.pageY;return o>r&&(i=r,r=o,o=i),a>l&&(i=l,l=a,a=i),this.helper.css({left:o,top:a,width:r-o,height:l-a}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),c=!1;i&&i.element!==n.element[0]&&("touch"===s.tolerance?c=!(i.left>r||i.right<o||i.top>l||i.bottom<a):"fit"===s.tolerance&&(c=i.left>o&&i.right<r&&i.top>a&&i.bottom<l),c?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),t(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}function i(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var n=null,s=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(n=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(n=t(e.target)),n&&(!this.options.handle||i||(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(s=!0)}),s))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,i,n){var s,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,s,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-t(document).scrollTop()<a.scrollSensitivity?r=t(document).scrollTop(t(document).scrollTop()-a.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<a.scrollSensitivity&&(r=t(document).scrollTop(t(document).scrollTop()+a.scrollSpeed)),e.pageX-t(document).scrollLeft()<a.scrollSensitivity?r=t(document).scrollLeft(t(document).scrollLeft()-a.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<a.scrollSensitivity&&(r=t(document).scrollLeft(t(document).scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],s=n.item[0],o=this._intersectsWithPointer(n),o&&n.instance===this.currentContainer&&s!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==s&&!t.contains(this.placeholder[0],s)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],s):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,s=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))
}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,s=n+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,l=r+t.height,c=this.offset.click.top,h=this.offset.click.left,u="x"===this.options.axis||n+c>r&&l>n+c,d="y"===this.options.axis||e+h>o&&a>e+h,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:o<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&r<n+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var i="x"===this.options.axis||e(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||e(this.positionAbs.left+this.offset.click.left,t.left,t.width),s=i&&n,o=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(t){var i=e(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=e(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&n||"left"===o&&!n:s&&("down"===s&&i||"up"===s&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,n,s,o,a=[],r=[],l=this._connectWith();if(l&&e)for(i=l.length-1;i>=0;i--)for(s=t(l[i]),n=s.length-1;n>=0;n--)o=t.data(s[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&r.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(r.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=r.length-1;i>=0;i--)r[i][0].each(function(){a.push(this)});return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,s,o,a,r,l,c,h=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(s=t(d[i]),n=s.length-1;n>=0;n--)o=t.data(s[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],n=0,c=r.length;c>n;n++)l=t(r[n]),l.data(this.widgetName+"-item",a),h.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,s,o;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(s=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=s.outerWidth(),n.height=s.outerHeight()),o=s.offset(),n.left=o.left,n.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,n=e.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),s=t("<"+n+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(s)}):"img"===n&&s.attr("src",e.currentItem.attr("src")),i||s.css("visibility","hidden"),s},update:function(t,s){(!i||n.forcePlaceholderSize)&&(s.height()||s.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),s.width()||s.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_contactContainers:function(n){var s,o,a,r,l,c,h,u,d,p,f=null,m=null;for(s=this.containers.length-1;s>=0;s--)if(!t.contains(this.currentItem[0],this.containers[s].element[0]))if(this._intersectsWith(this.containers[s].containerCache)){if(f&&t.contains(this.containers[s].element[0],f.element[0]))continue;f=this.containers[s],m=s}else this.containers[s].containerCache.over&&(this.containers[s]._trigger("out",n,this._uiHash(this)),this.containers[s].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",n,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(a=1e4,r=null,p=f.floating||i(this.currentItem),l=p?"left":"top",c=p?"width":"height",h=this.positionAbs[l]+this.offset.click[l],o=this.items.length-1;o>=0;o--)t.contains(this.containers[m].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(!p||e(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height))&&(u=this.items[o].item.offset()[l],d=!1,Math.abs(u-h)>Math.abs(u+this.items[o][c]-h)&&(d=!0,u+=this.items[o][c]),Math.abs(u-h)<a&&(a=Math.abs(u-h),r=this.items[o],this.direction=d?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;r?this._rearrange(n,r,null,!0):this._rearrange(n,null,this.containers[m].element,!0),this._trigger("change",n,this._uiHash()),this.containers[m]._trigger("change",n,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",n,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,s=this.options;"parent"===s.containment&&(s.containment=this.helper[0].parentNode),("document"===s.containment||"window"===s.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===s.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===s.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.containment)||(e=t(s.containment)[0],i=t(s.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:s.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*n}},_generatePosition:function(e){var i,n,s=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),s.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/s.grid[1])*s.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-s.grid[1]:i+s.grid[1]:i,n=this.originalPageX+Math.round((o-this.originalPageX)/s.grid[0])*s.grid[0],o=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-s.grid[0]:n+s.grid[0]:n)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay(function(){s===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)e||n.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}(jQuery),function(t,e){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"&lang; ",nextText:"&rang; ",currentText:"Today",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"Wk",dateFormat:"yy-mm-dd",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){t.datepicker._isDisabledDatepicker(o.inline?e.parent()[0]:o.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))})}function s(e,i){t.extend(e,i);for(var n in i)null==i[n]&&(e[n]=i[n]);return e}t.extend(t.ui,{datepicker:{version:"1.10.3"}});var o,a="datepicker";t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return s(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,s,o;n=e.nodeName.toLowerCase(),s="div"===n||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),s),o.settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,o):s&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var s=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,a,i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,s,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[r?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),("focus"===n||"both"===n)&&e.focus(this._showDatepicker),("button"===n||"both"===n)&&(s=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:s,title:s}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:s,title:s}):s)),e[r?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,s,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,n=0,s=0;s<t.length;s++)t[s].length>i&&(i=t[s].length,n=s);return n},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,a,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,o,r){var l,c,h,u,d,p=this._dialogInst;return p||(this.uuid+=1,l="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},t.data(this._dialogInput[0],a,p)),s(p.settings,o||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=r?r.length?r:[r.pageX,r.pageY]:null,this._pos||(c=document.documentElement.clientWidth,h=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+u,h/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],a,p),this},_destroyDatepicker:function(e){var i,n=t(e),s=t.data(e,a);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,a),"input"===i?(s.append.remove(),s.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,n,s=t(e),o=t.data(e,a);s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(n=s.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,n,s=t(e),o=t.data(e,a);s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(n=s.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,a)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,n,o){var a,r,l,c,h=this._getInst(i);return 2===arguments.length&&"string"==typeof n?"defaults"===n?t.extend({},t.datepicker._defaults):h?"all"===n?t.extend({},h.settings):this._get(h,n):null:(a=n||{},"string"==typeof n&&(a={},a[n]=o),void(h&&(this._curInst===h&&this._hideDatepicker(),r=this._getDateDatepicker(i,!0),l=this._getMinMaxDate(h,"min"),c=this._getMinMaxDate(h,"max"),s(h.settings,a),null!==l&&a.dateFormat!==e&&a.minDate===e&&(h.settings.minDate=this._formatDate(h,l)),null!==c&&a.dateFormat!==e&&a.maxDate===e&&(h.settings.maxDate=this._formatDate(h,c)),"disabled"in a&&(a.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(t(i),h),this._autoSize(h),this._setDate(h,r),this._updateAlternate(h),this._updateDatepicker(h))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,s,o=t.datepicker._getInst(e.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return s=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),s[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,s[0]),i=t.datepicker._get(o,"onSelect"),i?(n=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[n,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,s=t.datepicker._getInst(e.target);return t.datepicker._get(s,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(s,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(e){var i,n=t.datepicker._getInst(e.target);if(n.input.val()!==n.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,t.datepicker._getFormatConfig(n)),i&&(t.datepicker._setDateFromField(n),t.datepicker._updateAlternate(n),t.datepicker._updateDatepicker(n))}catch(s){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,o,a,r,l,c;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(i,"beforeShow"),o=n?n.apply(e,[e,i]):{},o!==!1&&(s(i.settings,o),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),a=!1,t(e).parents().each(function(){return a|="fixed"===t(this).css("position"),!a}),r={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),r=t.datepicker._checkOffset(i,r,a),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":a?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.zIndex(t(e).zIndex()+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,o=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,n=this._getNumberOfMonths(e),s=n[1],a=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&e.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",a*s+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var s=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?s-a:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+s>l&&l>s?Math.abs(i.left+s-l):0),i.top-=Math.min(i.top,i.top+o>c&&c>o?Math.abs(o+r):0),i},_findPos:function(e){for(var i,n=this._getInst(e),s=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[s?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,n,s,o,r=this._curInst;!r||e&&r!==t.data(e,a)||this._datepickerShowing&&(i=this._get(r,"showAnim"),n=this._get(r,"duration"),s=function(){t.datepicker._tidyDialog(r)},t.effects&&(t.effects.effect[i]||t.effects[i])?r.dpDiv.hide(i,t.datepicker._get(r,"showOptions"),n,s):r.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,s),i||s(),this._datepickerShowing=!1,o=this._get(r,"onClose"),o&&o.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)
},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==n)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var s=t(e),o=this._getInst(s[0]);this._isDisabledDatepicker(s[0])||(this._adjustInstDate(o,i+("M"===n?this._get(o,"showCurrentAtPos"):0),n),this._updateDatepicker(o))},_gotoToday:function(e){var i,n=t(e),s=this._getInst(n[0]);this._get(s,"gotoCurrent")&&s.currentDay?(s.selectedDay=s.currentDay,s.drawMonth=s.selectedMonth=s.currentMonth,s.drawYear=s.selectedYear=s.currentYear):(i=new Date,s.selectedDay=i.getDate(),s.drawMonth=s.selectedMonth=i.getMonth(),s.drawYear=s.selectedYear=i.getFullYear()),this._notifyChange(s),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var s=t(e),o=this._getInst(s[0]);o["selected"+("M"===n?"Month":"Year")]=o["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(s)},_selectDay:function(e,i,n,s){var o,a=t(e);t(s).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=t("a",s).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=n,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,s=t(e),o=this._getInst(s[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),n=this._get(o,"onSelect"),n?n.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,s,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),s=this.formatDate(i,n,this._getFormatConfig(e)),t(o).each(function(){t(this).val(s)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var s,o,a,r,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,h="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,d=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,_=!1,b=function(t){var i=s+1<e.length&&e.charAt(s+1)===t;return i&&s++,i},w=function(t){var e=b(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,s=new RegExp("^\\d{1,"+n+"}"),o=i.substring(l).match(s);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},x=function(e,n,s){var o=-1,a=t.map(b(e)?s:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(a,function(t,e){var n=e[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(o=e[0],l+=n.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},k=function(){if(i.charAt(l)!==e.charAt(s))throw"Unexpected literal at position "+l;l++};for(s=0;s<e.length;s++)if(_)"'"!==e.charAt(s)||b("'")?k():_=!1;else switch(e.charAt(s)){case"d":v=w("d");break;case"D":x("D",u,d);break;case"o":y=w("o");break;case"m":g=w("m");break;case"M":g=x("M",p,f);break;case"y":m=w("y");break;case"@":r=new Date(w("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((w("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":b("'")?k():_=!0;break;default:k()}if(l<i.length&&(a=i.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(h>=m?0:-100)),y>-1)for(g=1,v=y;;){if(o=this._getDaysInMonth(m,g-1),o>=v)break;g++,v-=o}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var n,s=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},c=function(t,e,i){var n=""+e;if(l(t))for(;n.length<i;)n="0"+n;return n},h=function(t,e,i,n){return l(t)?n[e]:i[e]},u="",d=!1;if(e)for(n=0;n<t.length;n++)if(d)"'"!==t.charAt(n)||l("'")?u+=t.charAt(n):d=!1;else switch(t.charAt(n)){case"d":u+=c("d",e.getDate(),2);break;case"D":u+=h("D",e.getDay(),s,o);break;case"o":u+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=c("m",e.getMonth()+1,2);break;case"M":u+=h("M",e.getMonth(),a,r);break;case"y":u+=l("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":d=!0;break;default:u+=t.charAt(n)}return u},_possibleChars:function(t){var e,i="",n=!1,s=function(i){var n=e+1<t.length&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;e<t.length;e++)if(n)"'"!==t.charAt(e)||s("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":s("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,s=this._getDefaultDate(t),o=s,a=this._getFormatConfig(t);try{o=this.parseDate(i,n,a)||s}catch(r){n=e?"":n}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=n?o.getDate():0,t.currentMonth=n?o.getMonth():0,t.currentYear=n?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var s=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(n){}for(var s=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=s.getFullYear(),a=s.getMonth(),r=s.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,c=l.exec(i);c;){switch(c[2]||"d"){case"d":case"D":r+=parseInt(c[1],10);break;case"w":case"W":r+=7*parseInt(c[1],10);break;case"m":case"M":a+=parseInt(c[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(c[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a))}c=l.exec(i)}return new Date(o,a,r)},a=null==i||""===i?n:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?n:s(i):new Date(i.getTime());return a=a&&"Invalid Date"===a.toString()?n:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,s=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),s===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,s,o,a,r,l,c,h,u,d,p,f,m,g,v,y,_,b,w,x,k,C,D,T,j,S,$,N,E,F,M,I,z,P,A,O,L,H=new Date,R=this._daylightSavingAdjust(new Date(H.getFullYear(),H.getMonth(),H.getDate())),q=this._get(t,"isRTL"),W=this._get(t,"showButtonPanel"),B=this._get(t,"hideIfNoPrevNext"),U=this._get(t,"navigationAsDateFormat"),V=this._getNumberOfMonths(t),Y=this._get(t,"showCurrentAtPos"),K=this._get(t,"stepMonths"),X=1!==V[0]||1!==V[1],Q=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(t,"min"),G=this._getMinMaxDate(t,"max"),J=t.drawMonth-Y,te=t.drawYear;if(0>J&&(J+=12,te--),G)for(e=this._daylightSavingAdjust(new Date(G.getFullYear(),G.getMonth()-V[0]*V[1]+1,G.getDate())),e=Z&&Z>e?Z:e;this._daylightSavingAdjust(new Date(te,J,1))>e;)J--,0>J&&(J=11,te--);for(t.drawMonth=J,t.drawYear=te,i=this._get(t,"prevText"),i=U?this.formatDate(i,this._daylightSavingAdjust(new Date(te,J-K,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,te,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(q?"e":"w")+"'>"+i+"</span></a>":B?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(q?"e":"w")+"'>"+i+"</span></a>",s=this._get(t,"nextText"),s=U?this.formatDate(s,this._daylightSavingAdjust(new Date(te,J+K,1)),this._getFormatConfig(t)):s,o=this._canAdjustMonth(t,1,te,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(q?"w":"e")+"'>"+s+"</span></a>":B?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(q?"w":"e")+"'>"+s+"</span></a>",a=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?Q:R,a=U?this.formatDate(a,r,this._getFormatConfig(t)):a,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=W?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(q?l:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(q?"":l)+"</div>":"",h=parseInt(this._get(t,"firstDay"),10),h=isNaN(h)?0:h,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),y=this._get(t,"selectOtherMonths"),_=this._getDefaultDate(t),b="",x=0;x<V[0];x++){for(k="",this.maxRows=4,C=0;C<V[1];C++){if(D=this._daylightSavingAdjust(new Date(te,J,t.selectedDay)),T=" ui-corner-all",j="",X){if(j+="<div class='ui-datepicker-group",V[1]>1)switch(C){case 0:j+=" ui-datepicker-group-first",T=" ui-corner-"+(q?"right":"left");break;case V[1]-1:j+=" ui-datepicker-group-last",T=" ui-corner-"+(q?"left":"right");break;default:j+=" ui-datepicker-group-middle",T=""}j+="'>"}for(j+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===x?q?o:n:"")+(/all|right/.test(T)&&0===x?q?n:o:"")+this._generateMonthYearHeader(t,J,te,Z,G,x>0||C>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",S=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)$=(w+h)%7,S+="<th"+((w+h+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[$]+"'>"+p[$]+"</span></th>";for(j+=S+"</tr></thead><tbody>",N=this._getDaysInMonth(te,J),te===t.selectedYear&&J===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,N)),E=(this._getFirstDayOfMonth(te,J)-h+7)%7,F=Math.ceil((E+N)/7),M=X&&this.maxRows>F?this.maxRows:F,this.maxRows=M,I=this._daylightSavingAdjust(new Date(te,J,1-E)),z=0;M>z;z++){for(j+="<tr>",P=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(I)+"</td>":"",w=0;7>w;w++)A=g?g.apply(t.input?t.input[0]:null,[I]):[!0,""],O=I.getMonth()!==J,L=O&&!y||!A[0]||Z&&Z>I||G&&I>G,P+="<td class='"+((w+h+6)%7>=5?" ui-datepicker-week-end":"")+(O?" ui-datepicker-other-month":"")+(I.getTime()===D.getTime()&&J===t.selectedMonth&&t._keyEvent||_.getTime()===I.getTime()&&_.getTime()===D.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(O&&!v?"":" "+A[1]+(I.getTime()===Q.getTime()?" "+this._currentClass:"")+(I.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(O&&!v||!A[2]?"":" title='"+A[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(O&&!v?"&#xa0;":L?"<span class='ui-state-default'>"+I.getDate()+"</span>":"<a class='ui-state-default"+(I.getTime()===R.getTime()?" ui-state-highlight":"")+(I.getTime()===Q.getTime()?" ui-state-active":"")+(O?" ui-priority-secondary":"")+"' href='#'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I);j+=P+"</tr>"}J++,J>11&&(J=0,te++),j+="</tbody></table>"+(X?"</div>"+(V[0]>0&&C===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=j}b+=k}return b+=c,t._keyEvent=!1,b},_generateMonthYearHeader:function(t,e,i,n,s,o,a,r){var l,c,h,u,d,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),y=this._get(t,"showMonthAfterYear"),_="<div class='ui-datepicker-title'>",b="";if(o||!g)b+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=s&&s.getFullYear()===i,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",h=0;12>h;h++)(!l||h>=n.getMonth())&&(!c||h<=s.getMonth())&&(b+="<option value='"+h+"'"+(h===e?" selected='selected'":"")+">"+r[h]+"</option>");b+="</select>"}if(y||(_+=b+(!o&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!v)_+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),m=Math.max(f,p(u[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=s?Math.min(m,s.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",_+=t.yearshtml,t.yearshtml=null}return _+=this._get(t,"yearSuffix"),y&&(_+=(!o&&g&&v?"":"&#xa0;")+b),_+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),s=t.drawMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(n,s))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,s,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),s=i&&i>e?i:e;return n&&s>n?n:s},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var s=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,n+(0>e?e:s[0]*s[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,n,s=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,r=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=n),i[1].match(/[+\-].*/)&&(r+=n)),(!s||e.getTime()>=s.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!r||e.getFullYear()<=r)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var s=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),s,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.10.3"}(jQuery),function(t){var e=5;t.widget("ui.slider",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",a=[];for(i=n.values&&n.values.length||1,s.length>i&&(s.slice(i).remove(),s=s.slice(0,i)),e=s.length;i>e;e++)a.push(o);this.handles=s.add(t(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=t([])},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,s,o,a,r,l,c,h=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),s=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(n-h.values(e));(s>i||s===i&&(e===h._lastChangedValue||h.values(e)===u.min))&&(s=i,o=t(this),a=e)}),r=this._start(e,a),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,o.addClass("ui-state-active").focus(),l=o.offset(),c=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:e.pageX-l.left-o.width()/2,top:e.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,s,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/e,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),s=this._valueMax()-this._valueMin(),o=this._valueMin()+n*s,this._trimAlignValue(o)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,s,o;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>n||1===e&&n>i)&&(i=n),i!==this.values(e)&&(s=this.values(),s[e]=i,o=this._trigger("slide",t,{handle:this.handles[e],value:i,values:s}),n=this.values(e?0:1),o!==!1&&this.values(e,i,!0))):i!==this.value()&&(o=this._trigger("slide",t,{handle:this.handles[e],value:i}),o!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,s,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,s=arguments[0],o=0;o<n.length;o+=1)n[o]=this._trimAlignValue(s[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var n,s=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(s=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;s>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,n,s,o,a=this.options.range,r=this.options,l=this,c=this._animateOff?!1:r.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,h["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[c?"animate":"css"](h,r.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},r.animate),1===n&&l.range[c?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},r.animate),1===n&&l.range[c?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(n=this.value(),s=this._valueMin(),o=this._valueMax(),i=o!==s?(n-s)/(o-s)*100:0,h["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](h,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(i){var n,s,o,a,r=t(i.target).data("ui-slider-handle-index");switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(i.target).addClass("ui-state-active"),n=this._start(i,r),n===!1))return}switch(a=this.options.step,s=o=this.options.values&&this.options.values.length?this.values(r):this.value(),i.keyCode){case t.ui.keyCode.HOME:o=this._valueMin();break;case t.ui.keyCode.END:o=this._valueMax();break;case t.ui.keyCode.PAGE_UP:o=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;o=this._trimAlignValue(s+a);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;o=this._trimAlignValue(s-a)}this._slide(i,r,o)},click:function(t){t.preventDefault()},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}})}(jQuery),function(t){function e(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),s=t.inArray(i,n);-1!==s&&n.splice(s,1),e.removeData("ui-tooltip-id"),n=t.trim(n.join(" ")),n?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")}var n=0;t.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var n=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){n._updateContent(e)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,n){var s=t.Event("blur");s.target=s.currentTarget=n[0],e.close(s,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each(function(){var e,n=t(this);n.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,s=this,o=e?e.type:null;return"string"==typeof n?this._open(e,t,n):(i=n.call(t[0],function(i){t.data("ui-tooltip-open")&&s._delay(function(){e&&(e.type=o),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(i,n,s){function o(t){c.of=t,a.is(":hidden")||a.position(c)}var a,r,l,c=t.extend({},this.options.position);if(s){if(a=this._find(n),a.length)return void a.find(".ui-tooltip-content").html(s);n.is("[title]")&&(i&&"mouseover"===i.type?n.attr("title",""):n.removeAttr("title")),a=this._tooltip(n),e(n,a.attr("id")),a.find(".ui-tooltip-content").html(s),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:o}),o(i)):a.position(t.extend({of:n},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.show&&this.options.show.delay&&(l=this.delayedShow=setInterval(function(){a.is(":visible")&&(o(c.of),clearInterval(l))
},t.fx.interval)),this._trigger("open",i,{tooltip:a}),r={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=n[0],this.close(i,!0)}},remove:function(){this._removeTooltip(a)}},i&&"mouseover"!==i.type||(r.mouseleave="close"),i&&"focusin"!==i.type||(r.focusout="close"),this._on(!0,n,r)}},close:function(e){var n=this,s=t(e?e.currentTarget:this.element),o=this._find(s);this.closing||(clearInterval(this.delayedShow),s.data("ui-tooltip-title")&&s.attr("title",s.data("ui-tooltip-title")),i(s),o.stop(!0),this._hide(o,this.options.hide,function(){n._removeTooltip(t(this))}),s.removeData("ui-tooltip-open"),this._off(s,"mouseleave focusout keyup"),s[0]!==this.element[0]&&this._off(s,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:o}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+n++,s=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(s),s.appendTo(this.document[0].body),this.tooltips[i]=e,s},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,n){var s=t.Event("blur");s.target=s.currentTarget=n[0],e.close(s,!0),t("#"+i).remove(),n.data("ui-tooltip-title")&&(n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))})}})}(jQuery),define("jqueryui",["jquery"],function(){}),define("components/pop/base",["backbone"],function(t){var e=t.View.extend({className:"popover left",initialize:function(t){this.callback=t.callback,this.target=t.target,this.trigger=t.trigger,t.notAutoHide||this.autoHide()},render:function(){return this.$el.html(this.template({})),this.onRender&&this.onRender(),this},autoHide:function(){var t=this;$(document).on("click",function(e){t.isShow()&&0===t.$el.has(e.target).length&&e.target!==t.trigger[0]&&t.hide()})},setCallback:function(t){this.callback=t},setTarget:function(t){this.target=t},setTrigger:function(t){this.trigger=t},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},hide:function(){return this.$el.hide(),this.$el},show:function(){return this.$el.show(),this.$el},toggle:function(){return this.$el.toggle(),this.$e},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this),this.hide()}});return e}),define("text!components/pop/templates/link.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-link">\n    <div class="popover-content">\n        <div class="form-inline">\n            <input type="text" class="link-placeholder js-link-placeholder" placeholder="<%= content %>">\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定"> 确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/link",["backbone","components/pop/base","text!components/pop/templates/link.html","core/utils"],function(t,e,i,n){return e.extend({template:_.template(i),className:"popover popover-link-wrap bottom",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keydown .js-link-placeholder":function(t){t.keyCode===n.keyCode.ENTER&&this.triggerCallback()}},initialize:function(t){this.content=t.content||"链接地址：http://example.com",this.callback=t.callback,this.target=t.target,this.trigger=t.trigger,t.notAutoHide||this.autoHide()},render:function(){return this.$el.html(this.template({content:this.content})),this},positioning:function(){this.$el.show().position({of:this.target,my:"center top+5",at:"center bottom",collision:"none"}),this.$(".js-link-placeholder").focus()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.content||"链接地址：http://example.com";this.$(".js-link-placeholder").attr("placeholder",s),this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.clearInput(),this.show()},triggerCallback:function(){var t=n.urlCheck(this.$(".js-link-placeholder").val());this.callback.call(this,t),this.hide()},clearInput:function(){this.$(".js-link-placeholder").val("")}})}),define("text!components/pop/templates/confirm.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-confirm">\n    <% if (options.className.indexOf(\'popover-confirm-block\') > 0) { %>\n        <div class="popover-content">\n            <div class="form-inline">\n                <div class="js-confirm-text custom-template">\n                    <%= options.data || \'\' %>\n                </div>\n                <div class="js-confirm-btn-action btn-action">\n                    <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n                    <button type="reset" class="btn js-btn-cancel">取消</button>\n                </div>\n            </div>\n        </div>\n    <% } else { %>\n        <div class="popover-content text-center">\n            <div class="form-inline clearfix">\n                <span class="js-confirm-text data-inline pull-left">\n                    <%= options.data || \'\' %>\n                </span>\n                <span class="js-confirm-btn-action pull-right">\n                    <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n                    <button type="reset" class="btn js-btn-cancel">取消</button>\n                </span>\n            </div>\n            <% if(options.content) { %>\n            <div class="popover-confirm-content">\n                <%= options.content %>\n            </div>\n            <% } %>\n        </div>\n    <% } %>\n</div>\n'}),define("components/pop/confirm",["require","backbone","components/pop/base","text!components/pop/templates/confirm.html","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/confirm.html");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},initialize:function(t){$(".popover-confirm").parents(".popover").remove(),e.prototype.initialize.call(this,t)},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},render:function(){return this.$el.html(this.template({options:this.options})),this},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover right";this.$(".js-confirm-text").html(t.data),this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this),this.hide()}})}),define("text!components/pop/templates/delete.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-delete">\n    <div class="popover-content text-center">\n        <div class="form-inline">\n            <span class="help-inline item-delete">确定删除?</span>\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/delete",["require","backbone","components/pop/base","text!components/pop/templates/delete.html","core/utils","underscore"],function(t){var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/delete.html"),n=t("core/utils"),s=t("underscore");return e.extend({template:s.template(i),className:function(){return this.options.className},initialize:function(t){e.prototype.initialize.call(this,t)},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),n.focus(t.$(".js-btn-confirm")),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left";this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(t){if("keydown"===t.type){if(t.keyCode!==n.keyCode.ENTER)return}else if("click"!==t.type)return;this.callback.call(this),this.hide()}})}),define("components/pop/delete_multiple",["backbone","components/pop/base","text!components/pop/templates/delete.html","core/utils"],function(t,e,i){return e.extend({template:_.template(i),className:"popover right",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this.target.offset(),e={height:this.target.outerHeight(),width:this.target.outerWidth()},i={height:this.$el.outerHeight(),width:this.$el.outerWidth()};this.$el.css({display:"block",left:t.left+80,top:t.top-i.height/2+e.height/2})},reset:function(t){var e=t.callback,i=t.target,n=t.trigger;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this),this.hide()}})}),define("text!components/pop/templates/rule.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-rule">\n	<div class="popover-content">\n        <div class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label"><em class="required">*</em>规则名：</label>\n                <div class="controls">\n                    <input placeholder="关键词最多支持15个字" class="js-txt" type="text" maxlength="15" class="span3 txt" value="<%-name || \'\' %>">\n                </div>\n            </div>\n            <div class="control-group">\n                <label class="control-label">应用于：</label>\n                <div class="controls">\n                    <p class="static-value">粉丝发私信的时候</p>\n                </div>\n            </div>\n            <div class="form-actions">\n                <button class="js-btn-confirm btn btn-primary">确定</button>\n                <button class="js-btn-cancel btn">取消</button>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/rule",["backbone","components/pop/base","text!components/pop/templates/rule.html","core/utils"],function(t,e,i,n){return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keypress .js-txt":"enterSave"},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.el.className=t.options.className,t.txt=t.$el.find(".js-txt"),t},positioning:function(){var t=this;t.$el.show().position({of:t.target,my:"center top",at:"center bottom",collision:"none"}),t.txt.focus()},setData:function(t){this.data=_.extend(this.data,t),this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className;this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},enterSave:function(t){return t.which===n.keyCode.ENTER?(this.triggerCallback(),!1):void 0},triggerCallback:function(){var t=this,e=t.txt.val();return n.isEmpty(e)?(t.txt.focus(),!1):(t.setData({name:e}),t.callback.call(t,t.data),void t.hide())}})}),define("text!components/pop/templates/keyword.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-keyword">\n	<div class="popover-content">\n        <div class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label"><em class="required">*</em>关键词：</label>\n                <div class="controls">\n                    <input placeholder="关键词最多支持15个字" class="js-txt" type="text" maxlength="15" class="span3 txt" value="<%-text || \'\' %>">\n                    <span class="help-block err-message" style="font-size: 12px; color: red"></span>\n\n                    <% if(weixin){ %>\n                        <span class="js-emotion input-emotion-btn"></span>\n                        <div class="emotion-wrapper">\n                            <ul class="emotion-container clearfix"></ul>\n                        </div>\n                    <% } %>\n\n                </div>\n            </div>\n            <div class="control-group">\n                <label class="control-label"><em class="required">*</em>规则：</label>\n                <div class="controls">\n                    <% if (freeze) { %>\n                    <span class="control-action">模糊匹配</span>\n                    <% } %>\n                    <div class="keyword-type-group <% if (freeze) { %>hide<% } %>" >\n                        <% if(showP) { %>\n                        <label class="radio inline">\n                            <input name="keyword_type" type="radio" <% if (type === 1) { %>checked<% } %> value="1" /> 全匹配\n                        </label>\n                        <% } %>\n                        <label class="radio inline">\n                            <input name="keyword_type" type="radio" <% if (type === 2) { %>checked<% } %> value="2" /> 模糊\n                        </label>\n                        <% if(showQ) { %>\n                        <label class="radio inline">\n                            <input name="keyword_type" type="radio" <% if (type === 3) { %>checked<% } %> value="3" /> 前缀\n                        </label>\n                        <% } %>\n                    </div>\n                </div>\n            </div>\n            <div class="form-actions">\n                <button class="js-btn-confirm btn btn-primary">确定</button>\n                <button class="js-btn-cancel btn">取消</button>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/weixin_emotion/datas/default",["require"],function(){var t=[{key:"[微笑]",val:"01"},{key:"[撇嘴]",val:"02"},{key:"[色]",val:"03"},{key:"[发呆]",val:"04"},{key:"[得意]",val:"05"},{key:"[流泪]",val:"06"},{key:"[害羞]",val:"07"},{key:"[闭嘴]",val:"08"},{key:"[睡]",val:"09"},{key:"[大哭]",val:"10"},{key:"[尴尬]",val:"11"},{key:"[发怒]",val:"12"},{key:"[调皮]",val:"13"},{key:"[呲牙]",val:"14"},{key:"[惊讶]",val:"15"},{key:"[难过]",val:"16"},{key:"[酷]",val:"17"},{key:"[冷汗]",val:"18"},{key:"[抓狂]",val:"19"},{key:"[吐]",val:"20"},{key:"[偷笑]",val:"21"},{key:"[愉快]",val:"22"},{key:"[白眼]",val:"23"},{key:"[傲慢]",val:"24"},{key:"[饥饿]",val:"25"},{key:"[困]",val:"26"},{key:"[惊恐]",val:"27"},{key:"[流汗]",val:"28"},{key:"[憨笑]",val:"29"},{key:"[悠闲]",val:"30"},{key:"[奋斗]",val:"31"},{key:"[咒骂]",val:"32"},{key:"[疑问]",val:"33"},{key:"[嘘]",val:"34"},{key:"[晕]",val:"35"},{key:"[疯了]",val:"36"},{key:"[衰]",val:"37"},{key:"[骷髅]",val:"38"},{key:"[敲打]",val:"39"},{key:"[再见]",val:"40"},{key:"[擦汗]",val:"41"},{key:"[抠鼻]",val:"42"},{key:"[鼓掌]",val:"43"},{key:"[糗大了]",val:"44"},{key:"[坏笑]",val:"45"},{key:"[左哼哼]",val:"46"},{key:"[右哼哼]",val:"47"},{key:"[哈欠]",val:"48"},{key:"[鄙视]",val:"49"},{key:"[委屈]",val:"50"},{key:"[快哭了]",val:"51"},{key:"[阴险]",val:"52"},{key:"[亲亲]",val:"53"},{key:"[吓]",val:"54"},{key:"[可怜]",val:"55"},{key:"[菜刀]",val:"56"},{key:"[西瓜]",val:"57"},{key:"[啤酒]",val:"58"},{key:"[篮球]",val:"59"},{key:"[乒乓]",val:"60"},{key:"[咖啡]",val:"61"},{key:"[饭]",val:"62"},{key:"[猪头]",val:"63"},{key:"[玫瑰]",val:"64"},{key:"[凋谢]",val:"65"},{key:"[嘴唇]",val:"66"},{key:"[爱心]",val:"67"},{key:"[心碎]",val:"68"},{key:"[蛋糕]",val:"69"},{key:"[闪电]",val:"70"},{key:"[炸弹]",val:"71"},{key:"[刀]",val:"72"},{key:"[足球]",val:"73"},{key:"[瓢虫]",val:"74"},{key:"[便便]",val:"75"},{key:"[月亮]",val:"76"},{key:"[太阳]",val:"77"},{key:"[礼物]",val:"78"},{key:"[拥抱]",val:"79"},{key:"[强]",val:"80"},{key:"[弱]",val:"81"},{key:"[握手]",val:"82"},{key:"[胜利]",val:"83"},{key:"[抱拳]",val:"84"},{key:"[勾引]",val:"85"},{key:"[拳头]",val:"86"},{key:"[差劲]",val:"87"},{key:"[爱你]",val:"88"},{key:"[NO]",val:"89"},{key:"[OK]",val:"90"},{key:"[爱情]",val:"91"},{key:"[飞吻]",val:"92"},{key:"[跳跳]",val:"93"},{key:"[发抖]",val:"94"},{key:"[怄火]",val:"95"},{key:"[转圈]",val:"96"},{key:"[磕头]",val:"97"},{key:"[回头]",val:"98"},{key:"[跳绳]",val:"99"},{key:"[投降]",val:"100"},{key:"[激动]",val:"101"},{key:"[乱舞]",val:"102"},{key:"[献吻]",val:"103"},{key:"[左太极]",val:"104"},{key:"[右太极]",val:"105"}],e=[{key:"/::)",val:"01"},{key:"/::~",val:"02"},{key:"/::B",val:"03"},{key:"/::|",val:"04"},{key:"/:8-)",val:"05"},{key:"/::<",val:"06"},{key:"/::$",val:"07"},{key:"/::X",val:"08"},{key:"/::Z",val:"09"},{key:"/::'(",val:"10"},{key:"/::-|",val:"11"},{key:"/::@",val:"12"},{key:"/::P",val:"13"},{key:"/::D",val:"14"},{key:"/::O",val:"15"},{key:"/::(",val:"16"},{key:"/::+",val:"17"},{key:"/:--b",val:"18"},{key:"/::Q",val:"19"},{key:"/::T",val:"20"},{key:"/:,@P",val:"21"},{key:"/:,@-D",val:"22"},{key:"/::d",val:"23"},{key:"/:,@o",val:"24"},{key:"/::g",val:"25"},{key:"/:|-)",val:"26"},{key:"/::!",val:"27"},{key:"/::L",val:"28"},{key:"/::>",val:"29"},{key:"/::,@",val:"30"},{key:"/:,@f",val:"31"},{key:"/::-S",val:"32"},{key:"/:?",val:"33"},{key:"/:,@x",val:"34"},{key:"/:,@@",val:"35"},{key:"/::8",val:"36"},{key:"/:,@!",val:"37"},{key:"/:!!!",val:"38"},{key:"/:xx",val:"39"},{key:"/:bye",val:"40"},{key:"/:wipe",val:"41"},{key:"/:dig",val:"42"},{key:"/:handclap",val:"43"},{key:"/:&-(",val:"44"},{key:"/:B-)",val:"45"},{key:"/:<@",val:"46"},{key:"/:@>",val:"47"},{key:"/::-O",val:"48"},{key:"/:>-|",val:"49"},{key:"/:P-(",val:"50"},{key:"/::'|",val:"51"},{key:"/:X-)",val:"52"},{key:"/::*",val:"53"},{key:"/:@x",val:"54"},{key:"/:8*",val:"55"},{key:"/:pd",val:"56"},{key:"/:<W>",val:"57"},{key:"/:beer",val:"58"},{key:"/:basketb",val:"59"},{key:"/:oo",val:"60"},{key:"/:coffee",val:"61"},{key:"/:eat",val:"62"},{key:"/:pig",val:"63"},{key:"/:rose",val:"64"},{key:"/:fade",val:"65"},{key:"/:showlove",val:"66"},{key:"/:heart",val:"67"},{key:"/:break",val:"68"},{key:"/:cake",val:"69"},{key:"/:li",val:"70"},{key:"/:bome",val:"71"},{key:"/:kn",val:"72"},{key:"/:footb",val:"73"},{key:"/:ladybug",val:"74"},{key:"/:shit",val:"75"},{key:"/:moon",val:"76"},{key:"/:sun",val:"77"},{key:"/:gift",val:"78"},{key:"/:hug",val:"79"},{key:"/:strong",val:"80"},{key:"/:weak",val:"81"},{key:"/:share",val:"82"},{key:"/:v",val:"83"},{key:"/:@)",val:"84"},{key:"/:jj",val:"85"},{key:"/:@@",val:"86"},{key:"/:bad",val:"87"},{key:"/:lvu",val:"88"},{key:"/:no",val:"89"},{key:"/:ok",val:"90"},{key:"/:love",val:"91"},{key:"/:<L>",val:"92"},{key:"/:jump",val:"93"},{key:"/:shake",val:"94"},{key:"/:<O>",val:"95"},{key:"/:circle",val:"96"},{key:"/:kotow",val:"97"},{key:"/:turn",val:"98"},{key:"/:skip",val:"99"},{key:"/:oY",val:"100"},{key:"/:#-0",val:"101"},{key:"/:hiphot",val:"102"},{key:"/:kiss",val:"103"},{key:"/:<&",val:"104"},{key:"/:&>",val:"105"}];return[t,e]}),define("components/weixin_emotion/models/emotion",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=(t("core/utils"),e.Model.extend({defaults:{},initialize:function(){}}));return i}),define("components/weixin_emotion/collections/emotion_list",["require","backbone","components/weixin_emotion/models/emotion","core/utils"],function(t){var e=t("backbone"),i=t("components/weixin_emotion/models/emotion"),n=(t("core/utils"),e.Collection.extend({model:i,initialize:function(t){var e=this;e.options=t,e.listenTo(e,"selected:emotion",e.selectEmotion)},selectEmotion:function(){}}));return n}),define("text!components/weixin_emotion/templates/emotion.html",[],function(){return'<img src="<%=icon %>" alt="<%=value %>" title="<%=value %>">\n'}),define("components/weixin_emotion/views/emotion",["require","backbone","text!components/weixin_emotion/templates/emotion.html","components/weixin_emotion/models/emotion","core/utils"],function(t){var e=t("backbone"),i=t("text!components/weixin_emotion/templates/emotion.html"),n=(t("components/weixin_emotion/models/emotion"),t("core/utils"),e.View.extend({tagName:"li",template:_.template(i),events:{click:"selectEmotion"},initialize:function(){},render:function(){var t=this;return t.$el.html(t.template(t.model.toJSON())),t},selectEmotion:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.model.collection.trigger("selected:emotion",e.model)}}));return n}),define("components/weixin_emotion/views/emotion_list",["require","backbone","components/weixin_emotion/views/emotion","core/utils"],function(t){var e=t("backbone"),i=t("components/weixin_emotion/views/emotion"),n=(t("core/utils"),e.View.extend({initialize:function(){var t=this;t.listenTo(t.collection,"add",t.addOne),t.listenTo(t.collection,"reset",t.addAll),t.listenTo(t.collection,"all",t.render)},render:function(){var t=this;return t},addOne:function(t){var e=this,n=new i({model:t});e.$el.append(n.render().el)},addAll:function(){var t=this;t.$el.empty(),t.collection.each(this.addOne,this)}}));return n}),define("components/weixin_emotion/com",["require","backbone","components/weixin_emotion/datas/default","components/weixin_emotion/collections/emotion_list","components/weixin_emotion/views/emotion_list","core/utils"],function(t){var e=t("backbone"),i=t("components/weixin_emotion/datas/default"),n=t("components/weixin_emotion/collections/emotion_list"),s=t("components/weixin_emotion/views/emotion_list"),o=(t("core/utils"),e.View.extend({events:{click:"stopPropagation"},initialize:function(t){var e=this;null==t.kind&&(t.kind=0),e.config=t,e.render()},render:function(){var t=this;t.emotionList=new n([]),t.container=t.$el.find(".emotion-container"),t.emotionListView=new s({el:t.container,collection:t.emotionList});var e=_global.url.v1_static+"/assets/ueditor/build/dialogs/emotion/images/qq/",o=i[t.config.kind],a=o.map(function(t){return{value:t.key,icon:e+t.val+".gif"}});return t.emotionList.reset(a),t.listenTo(t.emotionList,"selected:emotion",t.selectEmotion),t},selectEmotion:function(t){var e=this;e.trigger("selected:emotion",t.get("value")),e.hide()},show:function(){var t=this;t.$el.show().position({of:t.config.target,my:"center bottom",at:"center top"})},hide:function(){this.$el.hide()},toggle:function(){var t=this,e=t.$el.is(":hidden");e?t.show():t.hide()},stopPropagation:function(t){t.stopPropagation()}}));return o}),define("components/pop/keyword",["require","backbone","components/pop/base","text!components/pop/templates/keyword.html","components/weixin_emotion/com","core/utils"],function(t){var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/keyword.html"),n=t("components/weixin_emotion/com"),s=t("core/utils");return e.extend({template:_.template(i),className:"popover bottom",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keypress .js-txt":"enterSave"},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data,void 0==t.data.weixin&&(this.data.weixin=!1),void 0===t.data.showP&&(this.data.showP=!0),void 0==t.data.showQ&&(this.data.showQ=!0);var i=this;this.$el.delegate(".js-emotion","click",function(){i.wxEmotion.toggle()})},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.txt=t.$el.find(".js-txt"),t.keywordType=t.$el.find(".keyword-type-group"),this.wxEmotion=new n({target:this.$(".js-emotion"),el:this.$(".emotion-wrapper"),kind:1}),this.listenTo(this.wxEmotion,"selected:emotion",this.insertText),t},insertText:function(t){var e=this.$(".js-txt");e.val(e.val()+t)},getMode:function(){var t=this;return Number(t.keywordType.find(":checked").val())},positioning:function(){var t=this;t.$el.show().position({of:t.target,my:"center top",at:"center bottom",collision:"none"}),t.txt.focus()},setData:function(t){this.data=_.extend(this.data,t),this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},enterSave:function(t){return t.which===s.keyCode.ENTER?(this.triggerCallback(),!1):void 0},triggerCallback:function(){var t=this,e=$.trim(t.txt.val()),i=t.getMode();return s.isEmpty(e)?(t.$(".err-message").text("关键词不能为空"),t.txt.focus(),!1):(t.$(".err-message").text(""),1!==i&&2!==i&&3!==i?!1:(t.setData({text:e,type:i}),t.callback.call(t,t.data),void t.hide()))}})}),define("text!components/pop/templates/reply.html",[],function(){return'<div class="arrow"></div>\n<a href="javascript:;" class="close--circle js-close">&times;</a>\n<div class="popover-inner popover-reply">\n    <div class="popover-content">\n        <div class="form-horizontal">\n            <div class="wb-sender">\n                <div class="wb-sender__inner">\n                    <div class="wb-sender__input">\n                    </div>\n                    <div class="wb-sender__actions in-editor">\n                        <button class="js-btn-confirm btn btn-primary">确定</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/wb_editor_v2/models/editor",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=(t("core/utils"),e.Model.extend({defaults:function(){return{charLimit:300,picLimit:9,topic:"在这里输入你想要说的话题",hasSign:!1,supportModules:{emotion:"Emotion",hyperlink:"Hyperlink",picture:"Picture",articles:"Articles",feature:"Feature",goods:"Goods",homepage:"Homepage",shortlink:"Shortlink",image:"Image",usercenter:"Usercenter"},mode:"top-action",modules:["emotion","hyperlink"],data:{type:"text",pics:[],content:""}}}}));return i}),define("text!components/modal/1.0.0/templates/modal.html",[],function(){return'<% if (type === \'goods\') { %>\n<div class="modal fade hide js-goods-modal">\n    <div class="modal-header">\n        <a class="close js-news-modal-dismiss" data-dismiss="modal">×</a>\n        <!-- 顶部tab -->\n        <ul class="module-nav modal-tab">\n\n        </ul>\n    </div>\n    <div class="modal-body">\n        <div class="tab-content">\n\n        </div>\n    </div>\n    <div class="modal-footer clearfix">\n        <div style="display:none;" class="js-confirm-choose pull-left">\n            <input type="button" class="btn btn-primary" value="确定使用">\n        </div>\n        <div class="pagenavi">\n\n        </div>\n    </div>\n</div>\n<% } else { %>\n<div class="modal fade hide js-modal">\n    <div class="modal-header">\n        <a class="close js-news-modal-dismiss" data-dismiss="modal">×</a>\n        <!-- 顶部tab -->\n        <ul class="module-nav modal-tab">\n\n        </ul>\n    </div>\n    <div class="modal-body">\n        <div class="tab-content">\n\n        </div>\n    </div>\n    <div class="modal-footer">\n        <div style="display:none;" class="js-confirm-choose pull-left">\n            <input type="button" class="btn btn-primary" value="确定使用">\n        </div>\n        <div class="pagenavi">\n\n        </div>\n    </div>\n</div>\n<% } %>\n'}),define("text!components/modal/1.0.0/templates/modal_link.html",[],function(){return'    <a href="<%= link %>" target="_blank" class="new_window"><%= text %></a>\n    <% if (!isLast) { %>-<% } %>'}),define("text!components/modal/1.0.0/templates/modal_pane.html",[],function(){return'<% if (type !== \'image\') { %>\n<table class="table">\n    <% if(type === \'activity\' || type === "survey") { %>\n    <colgroup>\n        <col class="modal-col-title">\n        <col class="modal-col-time">\n        <col class="modal-col-action">\n    </colgroup>\n    <% } else { %>\n    <colgroup>\n        <col class="modal-col-title">\n        <col class="modal-col-time" span="2">\n        <col class="modal-col-action">\n    </colgroup>\n    <% } %>\n    <!-- 表格头部 -->\n    <thead>\n\n    </thead>\n    <!-- 表格数据区 -->\n    <tbody>\n\n    </tbody>\n</table>\n<% } else { %>\n<div class="module-header"></div>\n<ul class="module-body clearfix"></ul>\n<% } %>\n'}),define("text!components/modal/1.0.0/templates/modal_row.html",[],function(){return'<% if (type === \'image\') { %>\n    <div class="js-choose" title="<%= attachment_title %>">\n        <p class="image-size"><%= attachment_title.slice(0, 5) %><br><%= (size / 1000).toFixed(1) %> KB</p>\n        <img src="<%= window._global.url.imgqn %>/<%= thumb_url %>" width="60" height="60" />\n    </div>\n    <label class="multi-select-container hide">\n        <input type="checkbox" class="multi-select js-multi-select">\n    </label>\n<% } else if (type === \'guang_activity\' || type === \'activity\' || type === \'survey\' || type === \'grab\' || type === \'guaguale\') { %>\n    <td class="title">\n        <div class="td-cont">\n            <a target="_blank" class="new_window" href="<%= link %>"><%= title %></a>\n        </div>\n    </td>\n    <td class="time">\n        <div class="td-cont">\n            <span><%= start_time %></span>\n        </div>\n    </td>\n    <td class="time">\n        <div class="td-cont">\n            <span><%= end_time %></span>\n        </div>\n    </td>\n    <td class="opts">\n        <div class="td-cont">\n            <button class="btn js-choose" href="#" data-id="<%= data_id %>" data-url="<%= data_url %>" data-page-type="<%= type %>" data-cover-attachment-id="<%= data_cover_attachment_id %>" data-cover-attachment-url="<%= data_cover_attachment_url %>" data-title="<%= data_title %>" data-alias="<%= data_alias %>">选取</button>\n        </div>\n    </td>\n<% } else if (type === \'mpNews\' || type === \'news\' || type === \'multiNews\' || type === \'articles\') { %>\n    <td class="title">\n        <div class="td-cont">\n        <% if (news.length > 1) { %>\n            <div class="ng ng-multiple">\n            <% for (var index in news) { %>\n                <% if (news[index] && news.hasOwnProperty(index)) { %>\n                    <% if (news[index].title.indexOf(\'　　点此查看更多\') !== -1) { %>\n                        <div class="ng-item">\n                            <div class="ng-title">\n                                <a href="javascript:;" target="_blank" class="new_window" title=""><%=news[index] %></a>\n                            </div>\n                        </div>\n                    <% } else { %>\n                    <div class="ng-item">\n                        <span class="label label-success">图文<%=Number(index) + 1%></span>\n                        <div class="ng-title">\n                            <a href="<%= news[index] && news[index].url %>" class="new_window" title="<%=news[index].title %>">\n                                <%=news[index].title %>\n                            </a>\n                        </div>\n                    </div>\n                    <% } %>\n                    <% } %>\n            <% } %>\n            </div>\n        <% } else { %>\n            <div class="ng ng-single">\n                <div class="ng-item">\n                    <div class="ng-title">\n                        <a href="<%= news[0] && news[0].url %>" target="_blank" class="new-window" title="<%= news[0] &&news[0].title %>"><%= news[0] && news[0].title %></a>\n                    </div>\n                </div>\n                <div class="ng-item view-more">\n                    <a href="<%= news[0] && news[0].url %>" class="clearfix new-window">\n                        <span class="pull-left">阅读全文</span>\n                        <span class="pull-right">&gt;</span>\n                    </a>\n                </div>\n            </div>\n        <% } %>\n        </div>\n    </td>\n\n    <td class="time">\n        <div class="td-cont">\n            <span><%= time %></span>\n        </div>\n    </td>\n    <td class="opts">\n        <div class="td-cont">\n            <button class="btn js-choose" href="#" data-id="<%= data_id %>" data-url="<%= data_url %>" data-page-type="<%= type %>" data-cover-attachment-id="<%= data_cover_attachment_id %>" data-cover-attachment-url="<%= data_cover_attachment_url %>" data-title="<%= data_title %>" data-alias="<%= data_alias %>">选取</button>\n        </div>\n    </td>\n<% } else if (type === \'goods\') { %>\n    <td class="title">\n        <div class="td-cont">\n            <a target="_blank" class="new_window" href="<%= link %>" data-cover-attachment-url="<%= data_cover_attachment_url %>"><%= title %></a>\n        </div>\n    </td>\n\n    <td class="time">\n        <div class="td-cont">\n            <span><%= time %></span>\n        </div>\n    </td>\n    <td class="opts">\n        <div class="td-cont">\n            <button class="btn js-choose" href="javascript:void(0);">选取</button>\n        </div>\n    </td>\n<% } else if (type === \'tradeincard\') { %>\n    <td class="">\n        <div class="td-cont">\n            <span><%= name %></span>\n        </div>\n    </td>\n\n    <td class="">\n        <div class="td-cont">\n            <span><%= value %></span>\n        </div>\n    </td>\n    <td class="">\n        <div class="td-cont">\n            <span>\n                满<%= at_least %>元可用\n            </span>\n        </div>\n    </td>\n    <td class="opts">\n        <div class="td-cont">\n            <button class="btn js-choose" href="javascript:void(0);">选取</button>\n        </div>\n    </td>\n<% } else {%>\n    <td class="title">\n        <div class="td-cont">\n            <a target="_blank" class="new_window" href="<%= link %>"><%= title %></a>\n        </div>\n    </td>\n\n    <td class="time">\n        <div class="td-cont">\n            <span><%= time %></span>\n        </div>\n    </td>\n    <td class="opts">\n        <div class="td-cont">\n            <button class="btn js-choose" href="#" data-id="<%= data_id %>" data-url="<%= data_url %>" data-page-type="<%= type %>" data-cover-attachment-id="<%= data_cover_attachment_id %>" data-cover-attachment-url="<%= data_cover_attachment_url %>" data-title="<%= data_title %>" data-alias="<%= data_alias %>">选取</button>\n        </div>\n    </td>\n<% } %>\n'
}),define("text!components/modal/1.0.0/templates/modal_tab.html",[],function(){return'<a href="#js-module-<%= type %>" data-type="<%= type %>" class="js-modal-tab"><%= tab %></a><% if (!isLast) { %> | <% } %>\n'}),define("text!components/modal/1.0.0/templates/modal_thead.html",[],function(){return'    <% if (type === \'image\') { %>\n    <p class="help-inline">点击图片即可选中 <a class="js-update" href="javascript:void(0);">刷新</a></p>\n    <form class="form-search search-box">\n        <div class="input-append">\n            <input class="input-small js-modal-search-input" type="text"/>\n			<a href="javascript:void(0);" class="btn js-fetch-page js-modal-search" data-action-type="search">搜</a>\n        </div>\n    </form>\n    <% } else if (type === \'guang_activity\' || type === \'activity\' || type === \'survey\' || type === \'grab\' || type === \'guaguale\') { %>\n    <tr>\n        <th class="title">\n            <div class="td-cont">\n                <span><%= title %></span> <a class="js-update" href="javascript:void(0);">刷新</a>\n            </div>\n        </th>\n        <th class="time">\n            <span></span>\n        </th>\n        <th class="time">\n            <div class="td-cont">\n                <span>有效时间</span>\n            </div>\n        </th>\n        <th class="opts">\n            <div class="td-cont">\n                <form class="form-search">\n                    <div class="input-append">\n                        <input class="input-small js-modal-search-input" type="text"/><a href="javascript:void(0);" class="btn js-fetch-page js-modal-search" data-action-type="search">搜</a>\n                    </div>\n                </form>\n            </div>\n        </th>\n    </tr>\n    <% } else if(type === \'tradeincard\') { %>\n    <tr>\n        <th class="">\n            <div class="td-cont">\n                <span>名称</span> <a class="js-update" href="javascript:void(0);">刷新</a>\n            </div>\n        </th>\n        <th>\n            <div class="td-cont">面值</div>\n        </th>\n        <th style="width: 30%;">\n            <div class="td-cont">使用条件</div>\n        </th>\n        <th class="opts">\n            <div class="td-cont">\n                <form class="form-search">\n                    <div class="input-append">\n                        <input class="input-small js-modal-search-input" type="text"/><a href="javascript:void(0);" class="btn js-fetch-page js-modal-search" data-action-type="search">搜</a>\n                    </div>\n                </form>\n            </div>\n        </th>\n    </tr>\n    <% } else {%>\n    <tr>\n        <th class="title">\n            <div class="td-cont">\n                <span><%= title %></span> <a class="js-update" href="javascript:void(0);">刷新</a>\n            </div>\n        </th>\n        <th class="time">\n            <div class="td-cont">\n                <span><%= time %></span>\n            </div>\n        </th>\n        <th class="opts">\n            <div class="td-cont">\n                <form class="form-search">\n                    <div class="input-append">\n                        <input class="input-small js-modal-search-input" type="text"/><a href="javascript:void(0);" class="btn js-fetch-page js-modal-search" data-action-type="search">搜</a>\n                    </div>\n                </form>\n            </div>\n        </th>\n    </tr>\n    <% } %>\n'}),define("text!components/modal/1.0.0/templates/modal_dropdown.html",[],function(){return'    <a href="javascript:void(0);" data-toggle="dropdown" data-hover="dropdown" data-delay="200">+新建营销活动<b class="caret"></b></a>\n    <ul class="dropdown-menu">\n        <li><a href="/v2/apps/cards#create" target="_blank">刮刮乐</a></li>\n        <li><a href="/v2/apps/wheel#create" target="_blank">幸运大抽奖</a></li>\n        <li><a href="/v2/apps/zodiac#create" target="_blank">生肖翻翻看</a></li>\n        <li><a href="/v2/apps/crazyguess#create" target="_blank">疯狂猜猜猜</a></li>\n        <li><a href="/activity/add?activity_type=6" target="_blank">随便逛一逛</a></li>\n    </ul>\n'}),define("text!components/modal/1.0.0/templates/modal_static.html",[],function(){return'<div class="get-web-img">\n    <form class="form-horizontal" action="<%= window._global.url.img %>/download" method="post">\n        <div class="control-group">\n            <label class="control-label">网络图片：</label>\n            <div class="controls">\n                <input type="text" name="attachment_url" class="get-web-img-input js-web-img-input" placeholder="请贴入网络图片地址">\n                <a href="javascript:;" class="btn js-preview-img">提取</a>\n            </div>\n            <div class="controls preview-container js-download-img">\n            </div>\n        </div>\n    </form>\n</div>\n<div class="upload-local-img">\n    <div class="form-horizontal">\n        <div class="control-group">\n            <label class="control-label">本地图片：</label>\n            <div class="controls preview-container js-upload-img">\n            </div>\n            <div class="controls">\n                <div class="fileinput-button">\n                    <a href="javascript:;" data-toggle-text="重新选择..." class="control-action">添加图片...</a>\n                    <input class="js-fileupload fileupload" type="file" name="upload_file[]" data-url="<%= window._global.url.img + \'/uploadmultiple?format=json\' %>" multiple>\n                </div>\n                <p class="help-desc">最大支持 1 MB 的图片( jpg / gif / png )</p>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("text!components/modal/1.0.0/templates/modal_static_footer.html",[],function(){return'<div class="form-action">\n    <button type="button" class="btn btn-primary js-confirm-upload-image" data-loading-text="正在上传...">确定使用</button>\n    <a href="javascript:void(0);" data-dismiss="modal" class="btn btn-cancel">取消</a>\n</div>\n'}),function(t){"function"==typeof define&&define.amd?define("fileupload",["jquery","jqueryui"],t):t(window.jQuery)}(function(t){t.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||t('<input type="file">').prop("disabled")),t.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),t.support.xhrFormDataFileUpload=!!window.FormData,t.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),t.widget("blueimp.fileupload",{options:{dropZone:t(document),pasteZone:t(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(e,i){return e=this.messages[e]||e.toString(),i&&t.each(i,function(t,i){e=e.replace("{"+t+"}",i)}),e},formData:function(t){return t.serializeArray()},add:function(e,i){(i.autoUpload||i.autoUpload!==!1&&t(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:t.support.blobSlice&&function(){var t=this.slice||this.webkitSlice||this.mozSlice;return t.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,i){var n=t-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=(e-this.loaded)*(1e3/n)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&t.support.xhrFileUpload||t.support.xhrFormDataFileUpload)},_getFormData:function(e){var i;return"function"==typeof e.formData?e.formData(e.form):t.isArray(e.formData)?e.formData:"object"===t.type(e.formData)?(i=[],t.each(e.formData,function(t,e){i.push({name:t,value:e})}),i):[]},_getTotal:function(e){var i=0;return t.each(e,function(t,e){i+=e.size||1}),i},_initProgressObject:function(e){var i={loaded:0,total:0,bitrate:0};e._progress?t.extend(e._progress,i):e._progress=i},_initResponseObject:function(t){var e;if(t._response)for(e in t._response)t._response.hasOwnProperty(e)&&delete t._response[e];else t._response={}},_onProgress:function(t,e){if(t.lengthComputable){var i,n=Date.now?Date.now():(new Date).getTime();if(e._time&&e.progressInterval&&n-e._time<e.progressInterval&&t.loaded!==t.total)return;e._time=n,i=Math.floor(t.loaded/t.total*(e.chunkSize||e._progress.total))+(e.uploadedBytes||0),this._progress.loaded+=i-e._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,e.bitrateInterval),e._progress.loaded=e.loaded=i,e._progress.bitrate=e.bitrate=e._bitrateTimer.getBitrate(n,i,e.bitrateInterval),this._trigger("progress",t,e),this._trigger("progressall",t,this._progress)}},_initProgressListener:function(e){var i=this,n=e.xhr?e.xhr():t.ajaxSettings.xhr();n.upload&&(t(n.upload).bind("progress",function(t){var n=t.originalEvent;t.lengthComputable=n.lengthComputable,t.loaded=n.loaded,t.total=n.total,i._onProgress(t,e)}),e.xhr=function(){return n})},_isInstanceOf:function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},_initXHRData:function(e){var i,n=this,s=e.files[0],o=e.multipart||!t.support.xhrFileUpload,a=e.paramName[0];e.headers=e.headers||{},e.contentRange&&(e.headers["Content-Range"]=e.contentRange),o&&!e.blob&&this._isInstanceOf("File",s)||(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(s.name)+'"'),o?t.support.xhrFormDataFileUpload&&(e.postMessage?(i=this._getFormData(e),e.blob?i.push({name:a,value:e.blob}):t.each(e.files,function(t,n){i.push({name:e.paramName[t]||a,value:n})})):(n._isInstanceOf("FormData",e.formData)?i=e.formData:(i=new FormData,t.each(this._getFormData(e),function(t,e){i.append(e.name,e.value)})),e.blob?i.append(a,e.blob,s.name):t.each(e.files,function(t,s){(n._isInstanceOf("File",s)||n._isInstanceOf("Blob",s))&&i.append(e.paramName[t]||a,s,s.name)})),e.data=i):(e.contentType=s.type,e.data=e.blob||s),e.blob=null},_initIframeSettings:function(e){var i=t("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&i&&i!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t)},_getParamName:function(e){var i=t(e.fileInput),n=e.paramName;return n?t.isArray(n)||(n=[n]):(n=[],i.each(function(){for(var e=t(this),i=e.prop("name")||"files[]",s=(e.prop("files")||[1]).length;s;)n.push(i),s-=1}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(e){e.form&&e.form.length||(e.form=t(e.fileInput.prop("form")),e.form.length||(e.form=t(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var i=t.extend({},this.options,e);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(t){return t.state?t.state():t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(e,i,n){var s=t.Deferred(),o=s.promise();return i=i||this.options.context||o,e===!0?s.resolveWith(i,n):e===!1&&s.rejectWith(i,n),o.abort=s.promise,this._enhancePromise(o)},_addConvenienceMethods:function(e,i){var n=this,s=function(e){return t.Deferred().resolveWith(n,[e]).promise()};i.process=function(t,e){return(t||e)&&(i._processQueue=this._processQueue=(this._processQueue||s(this)).pipe(t,e)),this._processQueue||s(this)},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=n._trigger("submit",e,this)!==!1&&n._onSend(e,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():n._getXHRPromise()},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(t){var e=t.getResponseHeader("Range"),i=e&&e.split("-"),n=i&&i.length>1&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(e,i){e.uploadedBytes=e.uploadedBytes||0;var n,s,o=this,a=e.files[0],r=a.size,l=e.uploadedBytes,c=e.maxChunkSize||r,h=this._blobSlice,u=t.Deferred(),d=u.promise();return this._isXHRUpload(e)&&h&&(l||r>c)&&!e.data?i?!0:l>=r?(a.error=e.i18n("uploadedBytes"),this._getXHRPromise(!1,e.context,[null,"error",a.error])):(s=function(){var i=t.extend({},e),d=i._progress.loaded;i.blob=h.call(a,l,l+c,a.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+r,o._initXHRData(i),o._initProgressListener(i),n=(o._trigger("chunksend",null,i)!==!1&&t.ajax(i)||o._getXHRPromise(!1,i.context)).done(function(n,a,c){l=o._getUploadedBytes(c)||l+i.chunkSize,d+i.chunkSize-i._progress.loaded&&o._onProgress(t.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),e.uploadedBytes=i.uploadedBytes=l,i.result=n,i.textStatus=a,i.jqXHR=c,o._trigger("chunkdone",null,i),o._trigger("chunkalways",null,i),r>l?s():u.resolveWith(i.context,[n,a,c])}).fail(function(t,e,n){i.jqXHR=t,i.textStatus=e,i.errorThrown=n,o._trigger("chunkfail",null,i),o._trigger("chunkalways",null,i),u.rejectWith(i.context,[t,e,n])})},this._enhancePromise(d),d.abort=function(){return n.abort()},s(),d):!1},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},_onDone:function(e,i,n,s){var o=s._progress.total,a=s._response;s._progress.loaded<o&&this._onProgress(t.Event("progress",{lengthComputable:!0,loaded:o,total:o}),s),a.result=s.result=e,a.textStatus=s.textStatus=i,a.jqXHR=s.jqXHR=n,this._trigger("done",null,s)},_onFail:function(t,e,i,n){var s=n._response;n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total),s.jqXHR=n.jqXHR=t,s.textStatus=n.textStatus=e,s.errorThrown=n.errorThrown=i,this._trigger("fail",null,n)},_onAlways:function(t,e,i,n){this._trigger("always",null,n)},_onSend:function(e,i){i.submit||this._addConvenienceMethods(e,i);var n,s,o,a,r=this,l=r._getAJAXSettings(i),c=function(){return r._sending+=1,l._bitrateTimer=new r._BitrateTimer,n=n||((s||r._trigger("send",e,l)===!1)&&r._getXHRPromise(!1,l.context,s)||r._chunkedUpload(l)||t.ajax(l)).done(function(t,e,i){r._onDone(t,e,i,l)}).fail(function(t,e,i){r._onFail(t,e,i,l)}).always(function(t,e,i){if(r._onAlways(t,e,i,l),r._sending-=1,r._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>r._sending)for(var n=r._slots.shift();n;){if("pending"===r._getDeferredState(n)){n.resolve();break}n=r._slots.shift()}0===r._active&&r._trigger("stop")})};return this._beforeSend(e,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=t.Deferred(),this._slots.push(o),a=o.pipe(c)):(this._sequence=this._sequence.pipe(c,c),a=this._sequence),a.abort=function(){return s=[void 0,"abort","abort"],n?n.abort():(o&&o.rejectWith(l.context,s),c())},this._enhancePromise(a)):c()},_onAdd:function(e,i){var n,s,o,a,r=this,l=!0,c=t.extend({},this.options,i),h=c.limitMultiFileUploads,u=this._getParamName(c);if((c.singleFileUploads||h)&&this._isXHRUpload(c))if(!c.singleFileUploads&&h)for(o=[],n=[],a=0;a<i.files.length;a+=h)o.push(i.files.slice(a,a+h)),s=u.slice(a,a+h),s.length||(s=u),n.push(s);else n=u;else o=[i.files],n=[u];return i.originalFiles=i.files,t.each(o||i.files,function(s,a){var c=t.extend({},i);return c.files=o?a:[a],c.paramName=n[s],r._initResponseObject(c),r._initProgressObject(c),r._addConvenienceMethods(e,c),l=r._trigger("add",e,c)}),l},_replaceFileInput:function(e){var i=e.clone(!0);t("<form></form>").append(i)[0].reset(),e.after(i).detach(),t.cleanData(e.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,n){return n===e[0]?i[0]:n}),e[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(e,i){var n,s=this,o=t.Deferred(),a=function(t){t&&!t.entry&&(t.entry=e),o.resolve([t])};return i=i||"",e.isFile?e._file?(e._file.relativePath=i,o.resolve(e._file)):e.file(function(t){t.relativePath=i,o.resolve(t)},a):e.isDirectory?(n=e.createReader(),n.readEntries(function(t){s._handleFileTreeEntries(t,i+e.name+"/").done(function(t){o.resolve(t)}).fail(a)},a)):o.resolve([]),o.promise()},_handleFileTreeEntries:function(e,i){var n=this;return t.when.apply(t,t.map(e,function(t){return n._handleFileTreeEntry(t,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){e=e||{};var i=e.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(t.map(i,function(t){var e;return t.webkitGetAsEntry?(e=t.webkitGetAsEntry(),e&&(e._file=t.getAsFile()),e):t.getAsEntry()})):t.Deferred().resolve(t.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){e=t(e);var i,n,s=e.prop("webkitEntries")||e.prop("entries");if(s&&s.length)return this._handleFileTreeEntries(s);if(i=t.makeArray(e.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&t.each(i,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(n=e.prop("value"),!n)return t.Deferred().resolve([]).promise();i=[{name:n.replace(/^.*\\/,"")}]}return t.Deferred().resolve(i).promise()},_getFileInputFiles:function(e){return e instanceof t&&1!==e.length?t.when.apply(t,t.map(e,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(e){var i=this,n={fileInput:t(e.target),form:t(e.target.form)};this._getFileInputFiles(n.fileInput).always(function(t){n.files=t,i.options.replaceFileInput&&i._replaceFileInput(n.fileInput),i._trigger("change",e,n)!==!1&&i._onAdd(e,n)})},_onPaste:function(e){var i=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,n={files:[]};return i&&i.length&&(t.each(i,function(t,e){var i=e.getAsFile&&e.getAsFile();i&&n.files.push(i)}),this._trigger("paste",e,n)===!1||this._onAdd(e,n)===!1)?!1:void 0},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var e=this,i=t.dataTransfer,n={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){n.files=i,e._trigger("drop",t,n)!==!1&&e._onAdd(t,n)}))},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var i=e.dataTransfer;if(i){if(this._trigger("dragover",e)===!1)return!1;-1!==t.inArray("Files",i.types)&&(i.dropEffect="copy",e.preventDefault())}},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),t.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(e,i){var n=-1!==t.inArray(e,this._specialOptions);n&&this._destroyEventHandlers(),this._super(e,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof t||(e.fileInput=t(e.fileInput)),e.dropZone instanceof t||(e.dropZone=t(e.dropZone)),e.pasteZone instanceof t||(e.pasteZone=t(e.pasteZone))},_getRegExp:function(t){var e=t.split("/"),i=e.pop();return e.shift(),new RegExp(e.join("/"),i)},_isRegExpOption:function(e,i){return"url"!==e&&"string"===t.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var e=this,i=this.options;t.each(t(this.element[0].cloneNode(!1)).data(),function(t,n){e._isRegExpOption(t,n)&&(n=e._getRegExp(n)),i[t]=n})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(e){var i=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,i._onAdd(null,e)}):(e.files=t.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var i,n,s=this,o=t.Deferred(),a=o.promise();return a.abort=function(){return n=!0,i?i.abort():(o.reject(null,"abort","abort"),a)},this._getFileInputFiles(e.fileInput).always(function(t){if(!n){if(!t.length)return void o.reject();e.files=t,i=s._onSend(null,e).then(function(t,e,i){o.resolve(t,e,i)},function(t,e,i){o.reject(t,e,i)})}}),this._enhancePromise(a)}if(e.files=t.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}})}),function(t){"function"==typeof define&&define.amd?define("fileupload_process",["jquery","fileupload"],t):t(window.jQuery)}(function(t){var e=t.blueimp.fileupload.prototype.options.add;t.widget("blueimp.fileupload",t.blueimp.fileupload,{options:{processQueue:[],add:function(i,n){var s=t(this);n.process(function(){return s.fileupload("process",n)}),e.call(this,i,n)}},processActions:{},_processFile:function(e){var i=this,n=t.Deferred().resolveWith(i,[e]),s=n.promise();return this._trigger("process",null,e),t.each(e.processQueue,function(t,e){var n=function(t){return i.processActions[e.action].call(i,t,e)};s=s.pipe(n,e.always&&n)}),s.done(function(){i._trigger("processdone",null,e),i._trigger("processalways",null,e)}).fail(function(){i._trigger("processfail",null,e),i._trigger("processalways",null,e)}),s},_transformProcessQueue:function(e){var i=[];t.each(e.processQueue,function(){var n={},s=this.action,o=this.prefix===!0?s:this.prefix;t.each(this,function(i,s){n[i]="string"===t.type(s)&&"@"===s.charAt(0)?e[s.slice(1)||(o?o+i.charAt(0).toUpperCase()+i.slice(1):i)]:s}),i.push(n)}),e.processQueue=i},processing:function(){return this._processing},process:function(e){var i=this,n=t.extend({},this.options,e);return n.processQueue&&n.processQueue.length&&(this._transformProcessQueue(n),0===this._processing&&this._trigger("processstart"),t.each(e.files,function(e){var s=e?t.extend({},n):n,o=function(){return i._processFile(s)};s.index=e,i._processing+=1,i._processingQueue=i._processingQueue.pipe(o,o).always(function(){i._processing-=1,0===i._processing&&i._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=t.Deferred().resolveWith(this).promise()}})}),function(t){"function"==typeof define&&define.amd?define("fileupload_validate",["jquery","fileupload_process"],t):t(window.jQuery)}(function(t){t.blueimp.fileupload.prototype.options.processQueue.push({action:"validate",always:!0,acceptFileTypes:"@",maxFileSize:"@",minFileSize:"@",maxNumberOfFiles:"@",disabled:"@disableValidation"}),t.widget("blueimp.fileupload",t.blueimp.fileupload,{options:{getNumberOfFiles:t.noop,messages:{maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too large",minFileSize:"File is too small"}},processActions:{validate:function(e,i){if(i.disabled)return e;var n=t.Deferred(),s=this.options,o=e.files[e.index];return"number"===t.type(i.maxNumberOfFiles)&&(s.getNumberOfFiles()||0)+e.files.length>i.maxNumberOfFiles?o.error=s.i18n("maxNumberOfFiles"):!i.acceptFileTypes||i.acceptFileTypes.test(o.type)||i.acceptFileTypes.test(o.name)?i.maxFileSize&&o.size>i.maxFileSize?o.error=s.i18n("maxFileSize"):"number"===t.type(o.size)&&o.size<i.minFileSize?o.error=s.i18n("minFileSize"):delete o.error:o.error=s.i18n("acceptFileTypes"),o.error||e.files.error?(e.files.error=!0,n.rejectWith(this,[e])):n.resolveWith(this,[e]),n.promise()}}})}),define("components/modal/1.0.0/modal",["backbone","jqueryui","text!components/modal/1.0.0/templates/modal.html","text!components/modal/1.0.0/templates/modal_link.html","text!components/modal/1.0.0/templates/modal_pane.html","text!components/modal/1.0.0/templates/modal_row.html","text!components/modal/1.0.0/templates/modal_tab.html","text!components/modal/1.0.0/templates/modal_thead.html","text!components/modal/1.0.0/templates/modal_dropdown.html","text!components/modal/1.0.0/templates/modal_static.html","text!components/modal/1.0.0/templates/modal_static_footer.html","core/utils","fileupload_validate"],function(t,e,i,n,s,o,a,r,l,c,h,u){$.ajaxSetup({cache:!1});var d=t.Model.extend({defaults:{tab:"",isLink:!1,type:"",text:"",link:"",groupID:null,isDropdown:!1}}),p=t.Collection.extend({model:d}),f=t.View.extend({tagName:"li",className:function(){return this.model.get("isLink")?"link-group link-group-"+this.model.get("groupID"):this.model.get("isDropdown")?"link-group dropdown link-group-"+this.model.get("groupID"):void 0},template:_.template(a),linkTemplate:_.template(n),dropdownTemplate:_.template(l),render:function(){var t=this.model.toJSON(),e=this.model.get("groupID");return _.isNumber(this.model.get("groupID"))&&_.isEqual(_.last(this.model.collection.where({groupID:e})),this.model)?_.extend(t,{isLast:!0}):_.extend(t,{isLast:!1}),this.model.collection.where({isLink:!1,isDropdown:!1}).length===this.model.collection.length&&this.model.collection.indexOf(this.model)===this.model.collection.length-1&&_.extend(t,{isLast:!0}),this.$el.html(this.model.get("isLink")?this.linkTemplate(t):this.model.get("isDropdown")?this.dropdownTemplate(t):this.template(t)),this.options.hide&&this.$el.hide(),this}}),m=t.Model.extend({defaults:{title:"",time:"",type:""}}),g=t.View.extend({tagName:"tr",template:_.template(r),render:function(){return this.$el.html(this.template(this.model.toJSON())),this}}),v=t.Model.extend({}),y=t.View.extend({tagName:function(){return"image"===this.model.get("type")?"li":"tr"},template:_.template(o),events:{"click .js-choose":function(t){if(this.parent.multiChoose)this.toggle();else{var e=this.model.attributes;"guaguale"==e.type&&(e.type="activity",e._real_type="guaguale"),"wheel"==e.type&&(e.type="activity",e._real_type="wheel"),"zodiac"==e.type&&(e.type="activity",e._real_type="zodiac"),"crazyguess"==e.type&&(e.type="activity",e._real_type="crazyguess"),"mpNews"==e.type&&(e.type="news"),N.chooseItemCallback(e)}t.stopPropagation()},"click .js-multi-select":"toggleImage"},initialize:function(t){this.parent=t.parent;var e=this.model.get("time"),i=e.split(" ");this.model.set("time",i.join("<br>"))},toggleImage:function(){this.toggle(!0)},toggle:function(t){var e=this.$(".js-choose");e.toggleClass("btn-primary"),e.hasClass("btn-primary")?(e.data("view",this),t||e.html("取消")):t||e.html("选取"),this.toggleConfirm()},toggleConfirm:function(){this.parent.$(".js-choose.btn-primary").length>0?this.parent.$(".js-confirm-choose").show():this.parent.$(".js-confirm-choose").hide()},render:function(){return this.$el.html(this.template(this.model.toJSON())),"image"===this.model.get("type")&&this.parent.multiChoose?this.$(".multi-select-container").show():this.$(".multi-select-container").hide(),this}}),b=t.Model.extend({defaults:{type:"",data:[],pageNavi:""},getType:function(t){var e=t.slice(1).split("-"),i=this.get("type");return i===e[e.length-1]},fetch:function(t,e,i){var n=this,s=this.get("type"),o=N.url[s];_.isUndefined(o)||("cards"!=s&&(o+=o.indexOf("?")>=0?"&v=2":"?v=2"),_.isUndefined(t)||(o+="&keyword="+t),_.isUndefined(e)||(o+="&p="+e),window._global.imageSize&&"image"===s&&(o+="&size="+window._global.imageSize),$.getJSON(o,function(t){var e=t.data;if(0===+t.errcode||0===+t.code){var o=e.data_list,a=e.page_view,r=e.data_type;n.set({type:s,data:o,pageNavi:a,dataType:r})}else u.errorNotify(t.errmsg);_.isFunction(i)&&i()}))}}),w=t.Collection.extend({model:b,fetch:function(t,e){var i=this,n=N.url[t];if(_.isUndefined(n))return void i.add({type:t},{callback:e});"cards"!=t&&(n+=n.indexOf("?")>=0?"&v=2":"?v=2"),window._global.imageSize&&"image"===t&&(n+="&size="+window._global.imageSize);var s;_.isFunction(e)?s=e:i.reset(),$.getJSON(n,function(e){var n=e.data;if(0===+e.errcode||0===+e.code){var o=n.data_list,a=n.page_view,r=n.data_type;i.add({type:t,data:o,pageNavi:a,dataType:r},{callback:s})}else u.errorNotify(e.errmsg)})}}),x=t.View.extend({tagName:"div",id:function(){return"js-module-"+this.model.get("type")},className:function(){return"tab-pane module-"+this.model.get("type")},template:_.template(s),events:{"click .js-modal-search":function(t){{var e=this,i=e.search.val()||void 0;e.model.get("type"),$(t.target)}e.model.getType(e.parent.tab.find("li.active a").attr("href"))&&("image"===e.model.get("type")?e.$(".module-header").addClass("loading"):e.parent.loading(),e.model.fetch(i,void 0,function(){"image"===e.model.get("type")?e.$(".module-header").removeClass("loading"):e.parent.done()}))},"keydown .js-modal-search-input":function(t){13===t.keyCode&&(this.$(".js-modal-search").trigger("click"),t.preventDefault())},"click .js-update":"update"},initialize:function(t){t=t||{},this.parent=t.parent;var e=this;this.parent.$(".pagenavi").on("click",function(t){var i=$(t.target),n=i.data("page-num");t.preventDefault(),i.hasClass("js-confirm-upload-image")||i.hasClass("btn-cancel")||t.stopPropagation(),i.hasClass("fetch_page")&&!i.hasClass("active")&&e.model.getType(e.parent.tab.find("li.active a").attr("href"))&&e.searchKeyword(n)}),this.parent.$(".pagenavi").on("keydown","a.active",function(t){t.keyCode===u.keyCode.ENTER&&e.model.getType(e.parent.tab.find("li.active a").attr("href"))&&(e.searchKeyword(Number(t.target.innerText)),t.preventDefault())}),this.parent.tabLink.on("active:tab",function(t){var i=t.target,n=i.getAttribute("href");n&&e.model.getType(n)&&e.renderPageNavi()}),"image"===this.model.get("type")&&this.parent.$el.on("show",function(){e.renderRow()}),this.listenTo(this.model,"change:data",this.renderRow),this.listenTo(this.model,"change:pageNavi",this.renderPageNavi)},update:function(){var t=this;"image"===t.model.get("type")?t.$(".module-header").addClass("loading"):t.parent.loading(),this.model.fetch(void 0,void 0,function(){"image"===t.model.get("type")?t.$(".module-header").removeClass("loading"):t.parent.done()})},searchKeyword:function(t){var e=this;isNaN(t)&&(t=1);var i=e.search.val()||void 0;"image"===e.model.get("type")?e.$(".module-header").addClass("loading"):e.parent.loading(),e.model.fetch(i,t,function(){"image"===e.model.get("type")?e.$(".module-header").removeClass("loading"):e.parent.done()})},render:function(){var t=this;this.modelData=this.model.toJSON(),this.$el.html(this.template(this.modelData)),this.thead=new m({title:"标题",time:"创建时间",type:t.model.get("type")}),this.renderThead(),this.renderRow(),this.search=this.$(".js-modal-search-input");
var e=this.parent.tab.find("li.active a");return e.length>0&&this.model.getType(e.attr("href"))&&this.renderPageNavi(this.modelData.pageNavi),this},renderThead:function(){var t,e=this;t=this.$("image"===this.model.get("type")?".module-header":"thead"),t.empty();var i=new g({el:t,model:e.thead});i.render()},renderRow:function(){var t,e=this,i=this.model.get("data"),n=this.model.get("type"),s=this.model.get("dataType");t=e.$("image"===n?".module-body":"tbody"),t.empty(),_.each(i,function(o){var a;"news"===n||"mpNews"===n?(i=[],_.each(o.news_list,function(t){i.push(t.title)}),a=i.join("\\n")):a=o.title;var r=new y({model:new v({title:o.title||"",name:o.name||"",time:o.created_time||"",link:o.url||"",data_url:o.url||"",data_cover_attachment_id:o.cover_attachment_id||"",data_cover_attachment_url:o.cover_attachment_url||"",data_title:a||"",data_alias:o.alias||"",data_price:o.price||"",data_buy_url:o.buy_url||"",data_type:s||"",width:o.width||"",height:o.height||"",type:n||"",data_id:o.id||o._id||"",start_time:o.valid_start_time||o.start_time||"",end_time:o.valid_end_time||o.end_time||"",news:o.news_list||"",attachment_url:o.attachment_url||"",attachment_title:o.attachment_title||"",attachment_id:o.attachment_id||"",thumb_url:o.thumb_url||"",multiChoose:e.parent.multiChoose||!1,id:o.id||o._id||"",image_url:o.image_url||"",size:o.attachment_size||"",at_least:o.at_least||"",is_at_least:o.is_at_least||"",value:o.value}),parent:e.parent});t.append(r.render().el)}),"image"===this.model.get("type")?this.$(".module-header").removeClass("loading"):this.parent.done()},renderPageNavi:function(){var t=this.model.get("pageNavi");this.parent.$(".pagenavi").html(t),this.parent.done()}}),k=t.View.extend({tagName:"div",id:function(){return"js-module-"+this.model.get("type")},className:function(){return"tab-pane module-"+this.model.get("type")},events:{"click .js-preview-img":"previewImage"},template:_.template(c),footerTemplate:_.template(h),initialize:function(t){var e=this;t=t||{},this.parent=t.parent,this.parent.tabLink.on("active:tab",function(t){var i=t.target,n=i.getAttribute("href");n&&e.model.getType(n)&&e.renderFooter()}),this.parent.$el.on("click",function(t){if(t.target===$(".js-confirm-upload-image")[0]){$(t.target).button("loading");var i=e.downloadImage();if(i)return;var n=$(".js-fileupload");e.uploadFiles?n.fileupload("send",{files:e.uploadFiles}).success(function(t){var i=[],n=[];if(_.each(t,function(t,e){"success"===t.status?n.push(t.success_msg):i.push({index:e+1,msg:t.failed_msg})}),n.length>1?N.chooseItemCallback(e.parent.multiChoose?n:n[0]):1===n.length&&N.chooseItemCallback(n[0]),i.length>0){var s=_.reduce(i,function(t,e){return"size"===e.msg.upload_file?t+"第"+e.index+" 张图片大于 1MB 上传失败；":t+"第"+e.index+" 张图片上传失败（请联系客服）；"},"");u.errorNotify(s)}e.clearDownload()}):(u.errorNotify("至少选择一张图片。"),e.clearDownload())}})},render:function(){return this.$el.html(this.template(this.model.attributes)),this},renderFooter:function(){this.parent.$(".pagenavi").html(this.footerTemplate(this.model.attributes)),this.uploadImage()},uploadImage:function(){var t=this;if(!t.initUploadImage){t.initUploadImage=!0;var e=$(".js-fileupload");e.fileupload({dataType:"json",add:function(){},xhrFields:{withCredentials:!0}}).fileupload("option",{formData:{media_type:"image",v:"2",mp_id:window._global.kdt_id},maxFileSize:1e6,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i}).on("change",function(e){var i=e.target.files.length;if(0!==i){if(i>10)return void u.errorNotify("一次只能选择 10 张图片。");var n=$(".js-upload-img");n.empty(),_.each(e.target.files,function(t){var e=new FileReader;e.onload=function(t){n.append($("<img>").attr("src",t.target.result))},e.readAsDataURL(t)}),t.uploadFiles=e.target.files}})}},previewImage:function(){var t=$(".js-web-img-input").val();if(""===$.trim(t))return void $(".js-web-img-input").focus();this.model.set("src",t);var e=this.$(".js-download-img"),i=$("<img>").on("load",function(){e.removeClass("loading")}).attr("src",t);e.html(i).addClass("loading")},downloadImage:function(){var t=this;if(""!==$.trim(this.model.get("src"))){var e={attachment_url:this.model.get("src"),media_type:"image",v:2,mp_id:window._global.kdt_id};return $.post(window._global.url.img+"/download?format=json",e,function(t){t.success&&N.chooseItemCallback(t.success)},"json").always(function(){t.clearDownload()}).fail(function(){u.errorNotify("网络出现错误啦。")}),!0}},clearDownload:function(){this.$(".js-download-img").html(""),this.$(".js-upload-img").html(""),this.$(".js-web-img-input").val(""),this.uploadFiles=null,this.model.set("src","");var t=$(".js-confirm-upload-image");t.button("reset")}}),C=t.View.extend({initialize:function(t){t=t||{},this.type=t.type,this.multiChoose=t.multiChoose||!1,this.tab=this.$(".modal-tab"),this.tabContent=this.$(".tab-content"),this.modalBody=this.$(".modal-body"),this.listenTo(T[t.type],"add",this.addTabs),this.listenTo(D[t.type],"add",this.addPanes),this.listenTo(D[t.type],"reset",this.reset),T[t.type].add(t.list),this.tabList=t.tab;var e=this,i=this.tabLink=this.tab.find(".js-modal-tab"),n=function(t){var n=$(t.target),s=i.index(n);e.tab.find(".link-group").css({display:"none"}),e.tab.find(".link-group-"+s).css({display:"inline-block"}),e.tabContent.find("#"+n.attr("href").substring(1)).length>0&&n.tab("show").trigger("active:tab"),t.preventDefault(),t.stopPropagation()};i.on("click",n),i.one("click",function(t){var i=$(t.target),n=i.data("type");e.loading(),D[e.options.type]&&D[e.options.type].fetch(n,function(){i.tab("show").trigger("active:tab")})}),this.$el.on("click",".js-confirm-choose .btn",function(){var t=[];e.$(".js-choose.btn-primary").each(function(e,i){t.push($(i).data("view").model.attributes)}),N.chooseItemCallback(t)}),this.on("hide",function(){"image"===e.type&&this.$(".js-multi-select:checked").prop("checked",!1),e.$(".js-choose.btn-primary").each(function(t,i){"image"===e.type?$(i).data("view").toggle(!0):$(i).data("view").toggle()})}),this.on("show",function(){for(var t=!0,e=0;e<i.length;e++){var n=$(i[e]);if(n.parent("li").hasClass("active")){n.trigger("click"),t=!1;break}}t&&i.first().trigger("click")})},addTabs:function(t){var e={model:t};!_.isUndefined(this.options.hide)&&""!==t.type&&_.indexOf(this.options.hide,t.get("type"))>=0&&_.extend(e,{hide:!0});var i=new f(e);this.tab.append(i.render().$el)},addPanes:function(t,e,i){var n,s=this,o=_.isUndefined(N.url[t.get("type")]);n=o?new k({model:t,parent:s}):new x({model:t,parent:s}),this.tabContent.append(n.render().$el),_.isFunction(i.callback)&&i.callback(),this.done()},reset:function(){this.tabContent.empty()},update:function(){var t=this;this.loading(),_.each(this.tabList,function(e){D[t.type]&&D[t.type].fetch(e,!0)})},loading:function(){this.modalBody.addClass("loading")},done:function(){this.modalBody.removeClass("loading"),this.$(".js-confirm-choose").hide()},fetchAll:function(){var t=this;_.each(this.options.tab,function(e){D[t.options.type]&&D[t.options.type].fetch(e)})}}),D={},T={},j=t.Model.extend({defaults:{type:"other"}}),S=t.View.extend({template:_.template(i),render:function(){return $(this.template(this.model.attributes)).appendTo("body")}}),N={},E={};return{initialize:function(t){if(E[t.type])return _.isArray(t.hide)&&t.hide.length>0?E[t.type].find(".modal-tab li:not(.link-group)>a").each(function(e,i){var n=$.trim($(i).attr("href").replace("#js-module-",""));t.hide.indexOf(n)>=0&&$(i).parent("li").hide()}):E[t.type].find(".modal-tab li:not(.link-group)").removeAttr("style"),E[t.type].app.multiChoose=t.multiChoose?!0:!1,E[t.type];_.isUndefined(N.url)&&(N.url=t.url||{goods:window._global.url.www+"/showcase/goods/shortList.json",topic:window._global.url.v1+"/topic/list/get",category:window._global.url.www+"/showcase/category/shortList.json",component:window._global.url.www+"/showcase/component/shortList.json",feature_category:window._global.url.www+"/showcase/category/shortList.json",survey:window._global.url.www+"/apps/vote/selectList.json",image:window._global.url.www+"/showcase/attachment/alert.json?media_type=1",article:window._global.url.v1+"/article/list/get",tag:window._global.url.www+"/showcase/tag/shortList.json",goods_tag:window._global.url.www+"/showcase/tag/shortList.json",f_category:window._global.url.www+"/showcase/category/shortList.json",tag_feature:window._global.url.www+"/showcase/tag/shortList.json",tag_feature_2:window._global.url.www+"/showcase/feature/shortList.json",news:window._global.url.v1+"/news/list/get",mpNews:window._global.url.www+"/weixin/imagetext/minilist.json",activity:window._global.url.v1+"/activity/list/modal",guaguale:window._global.url.www+"/apps/cards/shortlist.json",wheel:window._global.url.www+"/apps/wheel/shortlist.json",zodiac:window._global.url.www+"/apps/zodiac/shortlist.json",crazyguess:window._global.url.www+"/apps/crazyguess/shortlist.json",grab:window._global.url.www+"/apps/grab/shortList.json",guang_activity:window._global.url.v1+"/activity/list/modal?is_guangyiguang=1",feature:window._global.url.www+"/showcase/feature/shortList.json",articles:window._global.url.www+"/sinaweibo/articles/atricleselectionlist.json",tradeincard:window._global.url.www+"/ump/tradeincard/listForSelection.json"},_.each(N.url,function(t,e){D[e]=new w,T[e]=new p})),N.chooseItemCallback=function(){t.chooseItemCallback.apply(i,arguments),i.modal("hide"),s.trigger("hide")}||function(){};var e=new S({model:new j({type:t.type})}),i=e.render();i.view=e,i.on("show",function(t){var e=$(t.target);e.hasClass("modal")&&s.trigger("show")}),i.setChooseItemCallback=function(t){return N.chooseItemCallback=null,N.chooseItemCallback=function(){t.apply(i,arguments),i.modal("hide"),s.trigger("hide")},this};var n;switch(t.type){case"news":n={list:[{tab:"高级图文",type:"news"},{tab:"微信图文",type:"mpNews"},{link:"/news/list",text:"高级图文素材管理",isLink:!0,groupID:0},{link:window._global.url.www+"/weixin/imagetext",text:"微信图文素材管理",isLink:!0,groupID:1}],tab:["news","mpNews"],type:"news"};break;case"articles":n={list:[{tab:"新浪微博图文素材",type:"articles"},{link:window._global.url.www+"/sinaweibo/articles",text:"新浪微博图文素材管理",isLink:!0,groupID:0}],tab:["articles"],type:"articles"};break;case"tag":n={list:[{tab:"商品分组",type:"goods_tag"},{link:"/v2/showcase/tag",text:"分组管理",isLink:!0,groupID:0}],tab:["goods_tag"],type:"goods_tag"};break;case"tag_feature":n={list:[{tab:"商品分组",type:"tag_feature"},{tab:"微杂志",type:"tag_feature_2"},{link:"/v2/showcase/tag",text:"分组管理",isLink:!0,groupID:0},{link:"/v2/showcase/feature#create",text:"新建微杂志",isLink:!0,groupID:1},{link:"/v2/showcase/feature#list&is_display=0",text:"草稿管理",isLink:!0,groupID:1}],tab:["tag_feature","tag_feature_2"],type:"tag_feature"};break;case"feature":n={list:[{tab:"微杂志",type:"feature"},{tab:"微杂志分类",type:"category"},{link:"/v2/showcase/feature#create",text:"新建微杂志",isLink:!0,groupID:0},{link:"/v2/showcase/feature#list&is_display=0",text:"草稿管理",isLink:!0,groupID:0},{link:"/v2/showcase/category",text:"分类管理",isLink:!0,groupID:1}],tab:["feature","category"],type:"feature"};break;case"category":n={list:[{tab:"微杂志分类",type:"f_category"},{link:"/v2/showcase/category",text:"分类管理",isLink:!0,groupID:0}],tab:["f_category"],type:"f_category"};break;case"feature_category":n={list:[{tab:"微杂志分类",type:"feature_category"},{link:"/v2/showcase/category",text:"分类管理",isLink:!0,groupID:0}],tab:["feature_category"],type:"feature_category"};break;case"activity":n={list:[{tab:"在有效期内的活动",type:"activity"},{tab:"刮刮乐",type:"guaguale"},{tab:"幸运大抽奖",type:"wheel"},{tab:"翻翻看",type:"zodiac"},{tab:"疯狂猜",type:"crazyguess"},{link:"/activity/list?activity_type=1",text:"新建营销活动",groupID:0,isDropdown:!0},{link:"/v2/apps/cards#create",text:"新建刮刮乐",groupID:1,isLink:!0},{link:"/v2/apps/wheel#create",text:"新建幸运大抽奖",groupID:2,isLink:!0},{link:"/v2/apps/zodiac#create",text:"新建翻翻看",groupID:3,isLink:!0},{link:"/v2/apps/crazyguess#create",text:"新建疯狂猜",groupID:4,isLink:!0}],tab:["activity"],type:"activity"};break;case"grab":n={list:[{tab:"抢楼活动",type:"grab"},{link:_global.url.www+"/apps/grab/create",text:"新建抢楼活动",groupID:0,isLink:!0}],tab:["grab"],type:"grab"};break;case"guang_activity":n={list:[{tab:"在有效期内的活动",type:"guang_activity"},{tab:"刮刮乐",type:"guaguale"},{tab:"幸运大抽奖",type:"wheel"},{tab:"翻翻看",type:"zodiac"},{tab:"疯狂猜",type:"crazyguess"},{link:"/activity/list?activity_type=1",text:"新建营销活动",groupID:0,isDropdown:!0},{link:"/v2/apps/cards#create",text:"新建刮刮乐",groupID:1,isDropdown:!0},{link:"/v2/apps/wheel#create",text:"新建幸运大抽奖",groupID:2,isDropdown:!0},{link:"/v2/apps/zodiac#create",text:"新建翻翻看",groupID:3,isDropdown:!0},{link:"/v2/apps/crazyguess#create",text:"新建疯狂猜",groupID:4,isDropdown:!0}],tab:["guang_activity"],type:"guang_activity"};break;case"goods":n={list:[{tab:"已上架商品",type:"goods"},{tab:"商品分组",type:"tag"},{link:"/v2/showcase/goods/edit",text:"新建商品",isLink:!0,groupID:0},{link:"/v2/showcase/goods#list&is_display=0",text:"草稿管理",isLink:!0,groupID:0},{link:"/v2/showcase/tag",text:"分组管理",isLink:!0,groupID:1}],tab:["goods","tag"],type:"goods"},$.widget.bridge("uitooltip",$.ui.tooltip),$(document).uitooltip({items:".js-goods-modal #js-module-goods tbody .title a",position:{my:"top+20",at:"center",collision:"none"},content:function(){var t=$(this),e=t.data("cover-attachment-url");return'<div class="arrow"></div><div class="loading" style="width: 200px;height: 200px;background-color: #fff;"><img class="picture-tooltip" style="height: 200px;" width="200" height="200" src="'+e+'"/></div>'}});break;case"survey":n={list:[{tab:"投票调查",type:"survey"},{link:"/v2/apps/vote#create",text:"新建投票调查",groupID:0,isLink:!0}],tab:["survey"],type:"survey"};break;case"component":n={list:[{tab:"自定义页面模块",type:"component"},{link:"/v2/showcase/component#create",text:"新建自定义页面模块",groupID:0,isLink:!0}],tab:["component"],type:"component"};break;case"image":n={list:[{tab:"用过的图片",type:"image"},{tab:"新图片",type:"uploadImage"}],tab:["image","uploadImage"],type:"image"};break;case"tradeincard":n={list:[{tab:"优惠券",type:"tradeincard"},{link:"/v2/ump/tradeincard#add",text:"新建优惠券",groupID:0,isLink:!0}],tab:["tradeincard"],type:"tradeincard"};break;default:n=t.config}_.extend(n,{modal:i,hide:t.hide||[],multiChoose:t.multiChoose||!1}),t.size&&(window._global.imageSize=t.size||!1);var s=new C(_.extend({},{el:i},n));return i.app=s,E[t.type]=i,i}}}),define("text!components/image/1.0.0/templates/image_list.html",[],function(){return'<div class="modal-header">\n    <a class="close" data-dismiss="modal">×</a>\n    <!-- 顶部tab -->\n    <ul class="module-nav modal-tab">\n        <li class="active"><a href="javascript:;" data-pane="image" class="js-modal-tab">用过的图片</a> | </li>\n        <li><a href="javascript:;" data-pane="upload" class="js-modal-tab">新图片</a></li>\n    </ul>\n</div>\n<div class="tab-pane js-tab-pane-image">\n    <div class="modal-body module-image">\n        <div class="module-header module-loading">\n            <p class="help-inline">点击图片即可选中 <a class="js-update-image-list" href="javascript:void(0);">刷新</a></p>\n            <form class="form-search search-box">\n                <div class="input-append">\n                    <input class="input-small js-modal-search-input" type="text"/>\n                    <a href="javascript:void(0);" class="btn js-fetch-page js-modal-search" data-action-type="search">搜</a>\n                </div>\n            </form>\n        </div>\n        <ul class="module-body clearfix">\n\n        </ul>\n    </div>\n    <div class="modal-footer">\n        <div class="modal-action pull-left">\n            <input type="button" class="btn btn-primary js-choose-image hide" value="确定使用">\n        </div>\n        <div class="pagenavi js-pagenavi"></div>\n    </div>\n</div>\n<div class="tab-pane js-tab-pane-upload hide">\n    <div class="modal-body">\n        <div class="get-web-img js-get-web-img"></div>\n        <div class="upload-local-img js-upload-local-img"></div>\n    </div>\n    <div class="modal-footer">\n        <div class="modal-action pull-right">\n            <input type="button" class="btn btn-primary js-upload-image" data-loading-text="上传中..." value="确定上传">\n        </div>\n    </div>\n</div>\n\n'}),define("text!components/image/1.0.0/templates/image.html",[],function(){return'<div class="js-choose" title="<%= attachment_title %>">\n    <p class="image-size"><%= attachment_title.slice(0, 5) %><br><%= (attachment_size / 1000).toFixed(1) %> KB</p>\n    <img src="<%= utils.fullfillImage(thumb_url) %>" width="60" height="60" />\n    <div class="selected-style"><i class="icon-ok"></i></div>\n</div>\n'}),define("components/image/1.0.0/views/image_view",["require","marionette","text!components/image/1.0.0/templates/image.html","core/utils"],function(t){var e=t("marionette"),i=t("text!components/image/1.0.0/templates/image.html"),n=t("core/utils");return e.ItemView.extend({template:_.template(i),tagName:"li",events:{click:"select"},collectionEvents:{clear:"clear"},className:function(){return this.model.collection.isSelected(this.model)?"selected":""},select:function(){this.model.collection.select(this.model)&&(this.$el.toggleClass("selected"),0==this.model.collection.multiChoose&&this.model.collection.trigger("image:choose:success"))},clear:function(){this.$el.removeClass("selected")},templateHelpers:function(){return{utils:n}}})}),define("components/image/1.0.0/views/image_list_view",["require","marionette","text!components/image/1.0.0/templates/image_list.html","components/image/1.0.0/views/image_view","core/utils"],function(t){var e=t("marionette"),i=t("text!components/image/1.0.0/templates/image_list.html"),n=t("components/image/1.0.0/views/image_view"),s=t("core/utils");return e.CompositeView.extend({className:"modal fade hide",ui:{pagenavi:".js-pagenavi",chooseButton:".js-choose-image",image:".js-tab-pane-image",upload:".js-tab-pane-upload",pane:".tab-pane",uploadButton:".js-upload-image",searchInput:".js-modal-search-input"},events:{"click .fetch_page:not(.active)":"fetchPage","keydown .fetch_page.active":"fetchPage","click .js-choose-image":"chooseImage","click .js-update-image-list":"update","click .js-modal-tab":"tab","click .js-upload-image":"uploadImage","click .js-modal-search":"update","keydown .js-modal-search-input":"search"},template:_.template(i),itemView:n,itemViewContainer:".module-body",collectionEvents:{sync:"renderPagenavi",select:"toggleChooseButton"},initialize:function(t){this.opt=t.options,this.update();var e=this;this.listenTo(window.NC,"image:upload:always",function(){e.ui.uploadButton.button("reset")}),this.listenTo(this.collection,"image:choose:success",this.chooseImage),this.listenTo(window.NC,"image:upload:success",this.update)},tab:function(t){var e=$(t.target),i=e.parent();i.addClass("active"),i.siblings("li").removeClass("active");var n=e.data("pane");this.ui.pane.addClass("hide"),this.ui[n].removeClass("hide")},fetchPage:function(t){t.stopPropagation();var e=$(t.target);return"keydown"==t.type&&t.keyCode!==s.keyCode.ENTER?!0:(this.collection._pageNumber="keydown"==t.type?+e.html():e.data("page-num"),t.preventDefault(),void this._fetch())},update:function(){this._fetch()},search:function(t){t.stopPropagation(),t.keyCode==s.keyCode.ENTER&&(this._fetch(),t.preventDefault())},_fetch:function(){if(this.opt.onlyUpload!==!0){this.$el.addClass("image-loading");var t="";_.isFunction(this.ui.searchInput.val)&&(t=this.ui.searchInput.val());var e=s.addParameter(this.collection.url,{p:this.collection._pageNumber,keyword:t}),i=this;this.collection.fetch({url:e,success:function(){i.$el.removeClass("image-loading")}})}},chooseImage:function(){var t=this.collection.getSelectedImages();window.NC.trigger("image:choose:success",t,{upload:!1}),this.clearAllSelected()},clearAllSelected:function(){this.collection.clearAllSelected(),this.$("li.selected").removeClass("selected")},renderPagenavi:function(){this.ui.pagenavi.html(this.collection.pagenavi)},toggleChooseButton:function(t){t>0?this.ui.chooseButton.removeClass("hide"):this.ui.chooseButton.addClass("hide")},uploadImage:function(){this.ui.uploadButton.button("loading"),window.NC.trigger("image:upload")}})}),define("components/image/1.0.0/models/image",["require","backbone"],function(t){var e=t("backbone");return e.Model.extend({})}),define("components/image/1.0.0/collections/images",["require","backbone","components/image/1.0.0/models/image","core/utils"],function(t){var e=t("backbone"),i=t("components/image/1.0.0/models/image"),n=t("core/utils");return e.Collection.extend({url:_global.url.www+"/showcase/attachment/alert.json?media_type=1&v=2",model:i,_pageNumber:1,parse:function(t){return 0==t.errcode?(this.pagenavi=t.data.page_view,t.data.data_list):void n.errorNotify(t.errmsg||"出错啦。")},_selectedModel:[],_idAttribute:"attachment_id",getSelectedImages:function(){return this._selectedModel},select:function(t){var e=this;if(t.get("attachment_size")>1024*this.maxSize)return n.errorNotify("图片不能大于 "+this.maxSize+" KB"),!1;var i={};i[this._idAttribute]=t.get(this._idAttribute);var s=_.where(this._selectedModel,i);return s.length>0?_.each(s,function(t){e._selectedModel.splice(e._selectedModel.indexOf(t),1)}):this._selectedModel.push(t.attributes),this.trigger("select",this._selectedModel.length,t),!0},isSelected:function(t){var e={};e[this._idAttribute]=t.get(this._idAttribute);var i=_.where(this._selectedModel,e);return i.length>0?!0:!1},clearAllSelected:function(){this._selectedModel.length=0,this.trigger("clear"),this.trigger("select",0)}})}),define("text!components/image/1.0.0/templates/image_download.html",[],function(){return'<div class="control-group">\n    <label class="control-label">网络图片：</label>\n    <div class="controls">\n        <input type="text" name="attachment_url" class="get-web-img-input js-web-img-input" placeholder="请贴入网络图片地址">\n        <input type="button" class="btn js-preview-img" data-loading-text="提取..." value="提取" / >\n    </div>\n    <div class="controls preview-container js-preview-download-img">\n    </div>\n</div>'}),define("components/image/1.0.0/views/image_download",["require","marionette","text!components/image/1.0.0/templates/image_download.html"],function(t){var e=t("marionette"),i=t("text!components/image/1.0.0/templates/image_download.html");return e.ItemView.extend({tagName:"form",className:"form-horizontal",template:_.template(i),ui:{input:".js-web-img-input",preview:".js-preview-download-img"},events:{"click .js-preview-img":"previewImage"},previewImage:function(t){var e=$(t.target),i=this,n=this.ui.input.val();if(""===$.trim(n))return void this.ui.input.focus();e.button("loading"),this.model.set("src",n);var s=this.ui.preview,o=$("<img>").on("load",function(){s.removeClass("loading")}).attr("src",n);s.html(o).addClass("loading"),this.model.sync({always:function(){e.button("reset")},success:function(){i.clearDownload()}})},clearDownload:function(){this.ui.preview.empty(),this.ui.input.val("")}})}),define("components/image/1.0.0/models/image_download",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=t("core/utils");return e.Model.extend({sync:function(t){var e=this;if(""!=$.trim(this.get("src"))){var n={attachment_url:this.get("src"),media_type:"image",v:2,mp_id:window._global.kdt_id};return $.post(window._global.url.img+"/download?format=json",n,function(e){return e.success?(window.NC.trigger("image:download:success",[e.success]),void(t&&_.isFunction(t.success)&&t.success(e.success))):void i.errorNotify("出错啦，请重试。")},"json").always(function(){t&&_.isFunction(t.always)&&t.always(),e.clearDownload()}).fail(function(){i.errorNotify("网络出现错误啦。")}),!0}},clearDownload:function(){this.set("src","")}})}),define("text!components/image/1.0.0/templates/image_upload_item.html",[],function(){return'<img src="<%= src %>">\n<a href="javascript:;" class="close-modal small js-remove-image">×</a>'}),define("components/image/1.0.0/views/image_upload_item",["require","marionette","text!components/image/1.0.0/templates/image_upload_item.html"],function(t){var e=t("marionette"),i=t("text!components/image/1.0.0/templates/image_upload_item.html");return e.ItemView.extend({template:_.template(i),tagName:"li",className:"upload-preview-img",events:{"click .js-remove-image":"removeImage"},removeImage:function(){this.model.destroy(),window.NC.trigger("image:number:change")}})}),define("text!components/image/1.0.0/templates/image_upload.html",[],function(){return'<div class="control-group">\n    <label class="control-label">本地图片：</label>\n    <div class="controls preview-container js-preview-upload-img">\n    </div>\n    <div class="controls">\n        <div class="control-action">\n            <ul class="js-upload-image-list upload-image-list clearfix">\n                <li class="fileinput-button">\n                        <a class="fileinput-button-icon" href="javascript:;">+</a>\n                        <input class="js-fileupload-input fileupload" type="file" name="upload_file[]" data-url="http://img.koudaitong.com/uploadmultiple?format=json" multiple>\n                </li>\n            </ul>\n            <p class="help-desc">最大支持 <span class="js-max-size">1 MB</span> 的图片( jpg / gif / png )，不能选中大于 <span class="js-max-size">1 MB</span> 的图片</p>\n        </div>\n    </div>\n</div>'}),define("components/image/1.0.0/views/image_upload",["require","marionette","components/image/1.0.0/views/image_upload_item","text!components/image/1.0.0/templates/image_upload.html"],function(t){var e=t("marionette"),i=t("components/image/1.0.0/views/image_upload_item"),n=t("text!components/image/1.0.0/templates/image_upload.html");return e.CompositeView.extend({tagName:"form",className:"form-horizontal",template:_.template(n),itemView:i,itemViewContainer:".js-upload-image-list",events:{"change .js-fileupload-input":"selectFile"},initialize:function(){this.listenTo(window.NC,"image:upload",this.upload)},appendBuffer:function(t,e){t.$(".fileinput-button").before(e)},appendHtml:function(t,e){t.isBuffering?(t.elBuffer.appendChild(e.el),t._bufferedChildren.push(e)):t.$(".fileinput-button").before(e.el)},selectFile:function(t){var e=t.target.files,i=this;_.each(e,function(t){var e=t.size/1024;e>i.collection.maxSize||t.name.match(/(\.|\/)(gif|jpe?g|png)$/i)&&i.previewAndAdd(t)}),$(t.target).val("")},previewAndAdd:function(t){var e=new FileReader,i=this;e.onload=function(e){i.collection.add({src:e.target.result,file:t}),window.NC.trigger("image:number:change")},e.readAsDataURL(t)},upload:function(){this.collection.sync({success:function(){this.render()}.bind(this)})}})}),function(t){"function"==typeof define&&define.amd?define("cookie",["jquery"],t):t(jQuery)}(function(t){function e(t){return r.raw?t:encodeURIComponent(t)}function i(t){return r.raw?t:decodeURIComponent(t)}function n(t){return e(r.json?JSON.stringify(t):String(t))}function s(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return t=decodeURIComponent(t.replace(a," ")),r.json?JSON.parse(t):t}catch(e){}}function o(e,i){var n=r.raw?e:s(e);return t.isFunction(i)?i(n):n}var a=/\+/g,r=t.cookie=function(s,a,l){if(void 0!==a&&!t.isFunction(a)){if(l=t.extend({},r.defaults,l),"number"==typeof l.expires){var c=l.expires,h=l.expires=new Date;h.setDate(h.getDate()+c)}return document.cookie=[e(s),"=",n(a),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var u=s?void 0:{},d=document.cookie?document.cookie.split("; "):[],p=0,f=d.length;f>p;p++){var m=d[p].split("="),g=i(m.shift()),v=m.join("=");if(s&&s===g){u=o(v,a);break}s||void 0===(v=o(v))||(u[g]=v)}return u};r.defaults={},t.removeCookie=function(e,i){return void 0===t.cookie(e)?!1:(t.cookie(e,"",t.extend({},i,{expires:-1})),!t.cookie(e))}}),define("components/image/1.0.0/models/image_upload",["require","backbone"],function(t){var e=t("backbone");return e.Model.extend({})}),define("components/image/1.0.0/collections/image_upload",["require","cookie","backbone","components/image/1.0.0/models/image_upload","core/utils"],function(t){var e=(t("cookie"),t("backbone")),i=t("components/image/1.0.0/models/image_upload"),n=t("core/utils");return e.Collection.extend({model:i,url:"http://up.qiniu.com",uploadURL:_global.url.www+"/common/qiniu/upToken.json",eventPrefix:"image",sync:function(t){var e=this;if(t=t||{},this.length<=0)return void window.NC.trigger(e.eventPrefix+":upload:always");var i;$.post(this.uploadURL,{scope:this.private?_global.js.qn_private:_global.js.qn_public,kdt_id:$.cookie("kdt_id")}).success(function(s){n.parse(s,{success:function(n){i=n.uptoken,e.upload(i,t)},fail:function(){window.NC.trigger(e.eventPrefix+":upload:always"),n.errorNotify("获取token失败，请重试。")}})}).fail(function(){window.NC.trigger(e.eventPrefix+":upload:always"),n.errorNotify("获取token失败，请重试。")})},upload:function(t,e){var i=this,s=[];this.each(function(o){var a=new $.Deferred,r=new FormData;r.append("token",t),r.append("file",o.get("file")),$.ajax({url:this.url,type:"post",data:r,dataType:"json",processData:!1,contentType:!1}).success(function(t){n.parse(t,{success:function(t){window.NC.trigger(i.eventPrefix+":upload:success",[t]),i.clearDownload(o),_.isFunction(e.success)&&e.success(),a.resolve()},fail:function(){a.reject()}})}).fail(function(){a.reject()}).always(function(){window.NC.trigger(i.eventPrefix+":upload:always")}),s.push(a)}.bind(this)),$.when.apply(void 0,s).promise().done(function(){n.successNotify("上传成功")}).fail(function(){n.errorNotify("上传失败，请重试")})},clearDownload:function(t){t.destroy()}})}),define("components/image/1.0.0/image",["require","core/event","marionette","components/image/1.0.0/views/image_list_view","components/image/1.0.0/collections/images","components/image/1.0.0/views/image_download","components/image/1.0.0/models/image_download","components/image/1.0.0/views/image_upload","components/image/1.0.0/collections/image_upload"],function(t){window.NC=t("core/event");var e=t("marionette"),i=t("components/image/1.0.0/views/image_list_view"),n=t("components/image/1.0.0/collections/images"),s=t("components/image/1.0.0/views/image_download"),o=t("components/image/1.0.0/models/image_download");ImageUploadView=t("components/image/1.0.0/views/image_upload"),ImageUploadCollection=t("components/image/1.0.0/collections/image_upload");var a=new e.Application;a.on("initialize:before",function(){$("body").append('<div class="js-image-app-container"></div>'),a.addRegions({container:".js-image-app-container",imageUpload:".js-upload-local-img",imageDownload:".js-get-web-img"})});var r=new n,l=new o,c=new ImageUploadCollection;a.addInitializer(function(){a.container.show(new i({collection:r,options:a._options})),a._options.hideDownload||a.imageDownload.show(new s({model:l})),a.imageUpload.show(new ImageUploadView({collection:c}))}),a.on("show:image",function(){a.container.$el.find(".modal").modal("show");var t=a._options.tabIndex,e=a._options.onlyUpload,i=a.container.$el.find(".js-modal-tab");void 0!=t&&i.eq(t).click();var n,s=a._options.maxSize;void 0!=s&&(n=s%1024==0?s/1024+" MB":s+" KB",a.imageUpload.$el.find(".js-max-size").html(n)),e===!0&&(a.container.$el.find(".module-nav li").eq(0).hide(),i.eq(1).click())});var h=function(t,e){a._options&&_.isFunction(a._options.callback)&&a._options.callback(t,e),a.container.$el.find(".modal").modal("hide")};return window.NC.on("image:upload:success",h),window.NC.on("image:download:success",h),window.NC.on("image:choose:success",h),window.NC.on("image:number:change",function(){c.multiUpload!==!0&&a.imageUpload.$el.find(".fileinput-button").toggle(0===c.length)}),{initialize:function(t){a._options=t,this._initialized||(a.start(),this._initialized=!0),r.multiChoose=t.multiChoose===!1?!1:!0,c.multiUpload=t.multiUpload===!1?!1:!0,c.uploadURL=t.uploadURL?t.uploadURL:_global.url.www+"/common/qiniu/upToken.json",c.private=t.private?!0:!1,void 0==t.maxSize?(t.maxSize=c.maxSize=1024,r.maxSize=1024):(c.maxSize=t.maxSize,r.maxSize=t.maxSize),a.trigger("show:image")}}}),define("text!components/wb_editor_v2/templates/editor.html",[],function(){return'<% if(mode !== \'bottom-action\') { %>\n<div class="misc top clearfix">\n    <div class="content-actions clearfix">\n    <% for(var idx = 0, len = modules.length; idx < len; idx++) { %>\n\n        <% if (modules[idx] === \'emotion\') { %>\n        <div class="editor-module insert-emotion">\n            <a class="js-open-emotion" data-action-type="emotion" href="javascript:;">表情</a>\n            <div class="emotion-wrapper">\n                <ul class="emotion-container clearfix"></ul>\n            </div>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'hyperlink\') { %>\n        <div class="editor-module insert-hyperlink">\n            <a class="js-open-hyperlink" data-action-type="hyperlink" href="javascript:;">插入链接</a>\n            <div class="hyperlink-wrapper"></div>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'articles\') { %>\n        <div class="editor-module insert-article">\n            <a class="js-open-articles" data-action-type="articles" href="javascript:;">选择图文</a>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'feature\') { %>\n        <div class="editor-module insert-feature">\n            <a class="js-open-feature" data-action-type="feature" data-complex-mode="true" href="javascript:;">微杂志及分类</a>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'goods\') { %>\n        <div class="editor-module insert-goods">\n            <a class="js-open-goods" data-action-type="goods" data-complex-mode="true" href="javascript:;">商品及分类</a>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'homepage\') { %>\n        <div class="editor-module insert-homepage">\n            <a class="js-open-homepage" data-action-type="homepage" data-complex-mode="true" href="javascript:;">店铺主页</a>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'usercenter\') { %>\n        <div class="editor-module insert-usercenter">\n            <a class="js-open-usercenter" data-action-type="usercenter" data-complex-mode="true" href="javascript:;">会员主页</a>\n        </div>\n        <% } %>\n\n\n        <% if (modules[idx] === \'picture\') { %>\n        <div class="editor-module insert-picture">\n            <a class="js-open-picture" data-action-type="picture" href="javascript:;">图片</a>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'image\') { %>\n        <div class="editor-module insert-image">\n            <a class="js-open-image" data-action-type="image" href="javascript:;">图片</a>\n        </div>\n        <% } %>\n\n        \n        <% if (modules[idx] === \'shortlink\') { %>\n        <div class="editor-module insert-shortlink">\n            <div class="js-reply-menu dropup hover dropdown--right add-reply-menu">\n                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">\n                    <span class="dropdown-current">插入链接</span>\n                    <i class="caret"></i>\n                </a>\n                <ul class="dropdown-menu">\n                    <li><a data-link-type="Feature" class="js-open-shortlink" href="javascript:;">微杂志及分类</a></li>\n                    <li><a data-link-type="Goods" class="js-open-shortlink" href="javascript:;">商品及分类</a></li>\n                    <li><a data-link-type="Homepage" class="js-open-shortlink" href="javascript:;">店铺主页</a></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n\n    <% } %>\n    </div>\n</div>\n<% } %>\n\n<div class="content-wrapper">\n    <textarea class="js-txta" cols="50" rows="4"></textarea>\n    <div class="js-picture-container picture-container"></div>\n    <div class="complex-backdrop"><div class="js-complex-content complex-content"></div></div>\n</div>\n\n<% if(mode === \'bottom-action\') { %>\n<div class="misc clearfix">\n    <div class="content-actions clearfix">\n    <% for(var idx = 0, len = modules.length; idx < len; idx++) { %>\n\n        <% if (modules[idx] === \'emotion\') { %>\n        <div class="editor-module insert-emotion">\n            <a class="js-open-emotion" data-action-type="emotion" href="javascript:;">表情</a>\n            <div class="emotion-wrapper">\n                <ul class="emotion-container clearfix"></ul>\n            </div>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'hyperlink\') { %>\n        <div class="editor-module insert-hyperlink">\n            <a class="js-open-hyperlink" data-action-type="hyperlink" href="javascript:;">插入链接</a>\n            <div class="hyperlink-wrapper"></div>\n        </div>\n        <% } %>\n\n        <% if (modules[idx] === \'image\') { %>\n        <div class="editor-module insert-image">\n            <a class="js-open-image" data-action-type="image" href="javascript:;">图片</a>\n        </div>\n        <% } %>\n        \n        <% if (modules[idx] === \'articles\') { %>\n        <div class="editor-module insert-articles">\n            <a class="js-open-articles" data-action-type="articles" href="javascript:;">选择图文</a>\n        </div>\n        <% } %>\n\n        <% if (thumb != true) { %>\n\n            <% if (modules[idx] === \'feature\') { %>\n            <div class="editor-module insert-feature">\n                <a class="js-open-feature" data-action-type="feature" data-complex-mode="true" href="javascript:;">微杂志及分类</a>\n            </div>\n            <% } %>\n\n            <% if (modules[idx] === \'goods\') { %>\n            <div class="editor-module insert-goods">\n                <a class="js-open-goods" data-action-type="goods" data-complex-mode="true" href="javascript:;">商品及分类</a>\n            </div>\n            <% } %>\n\n            <% if (modules[idx] === \'homepage\') { %>\n            <div class="editor-module insert-homepage">\n                <a class="js-open-homepage" data-action-type="homepage" data-complex-mode="true" href="javascript:;">店铺主页</a>\n            </div>\n            <% } %>\n\n            <% if (modules[idx] === \'usercenter\') { %>\n            <div class="editor-module insert-usercenter">\n                <a class="js-open-usercenter" data-action-type="usercenter" data-complex-mode="true" href="javascript:;">会员主页</a>\n            </div>\n            <% } %>\n\n            <% if (modules[idx] === \'picture\') { %>\n            <div class="editor-module insert-picture">\n                <a class="js-open-picture" data-action-type="picture" href="javascript:;">图片</a>\n            </div>\n            <% } %>\n        <% } %>\n\n        \n        <% if (modules[idx] === \'shortlink\') { %>\n        <div class="editor-module insert-shortlink">\n            <div class="js-reply-menu dropup hover dropdown--right add-reply-menu">\n                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">\n                    <span class="dropdown-current">插入链接</span>\n                    <i class="caret"></i>\n                </a>\n                <ul class="dropdown-menu">\n                    <li><a data-link-type="Feature" class="js-open-shortlink" href="javascript:;">微杂志及分类</a></li>\n                    <li><a data-link-type="Goods" class="js-open-shortlink" href="javascript:;">商品及分类</a></li>\n                    <li><a data-link-type="Homepage" class="js-open-shortlink" href="javascript:;">店铺主页</a></li>\n                </ul>\n            </div>\n        </div>\n        <% } %>\n    <% } %>\n\n        <% if (thumb === true) { %>\n            <div class="editor-module">\n                <div class="js-reply-menu dropup hover dropdown--right add-reply-menu">\n                    <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">\n                        <span class="dropdown-current">其它</span>\n                        <i class="caret"></i>\n                    </a>\n                    <ul class="dropdown-menu">\n                    <% for(var idx = 0, len = modules.length; idx < len; idx++) { %>\n                        <% if (modules[idx] === \'feature\') { %>\n                        <li><a class="js-open-feature" data-action-type="feature" data-complex-mode="true" href="javascript:;">微杂志及分类</a></li>\n                        <% } %>\n                        <% if (modules[idx] === \'goods\') { %>\n                        <li><a class="js-open-goods" data-action-type="goods" data-complex-mode="true" href="javascript:;">商品及分类</a></li>\n                        <% } %>\n                        <% if (modules[idx] === \'homepage\') { %>\n                        <li><a class="js-open-homepage" data-action-type="homepage" data-complex-mode="true" href="javascript:;">店铺主页</a></li>\n                        <% } %>\n                        <% if (modules[idx] === \'usercenter\') { %>\n                        <li><a class="js-open-usercenter" data-action-type="usercenter" data-complex-mode="true" href="javascript:;">会员主页</a></li>\n                        <% } %>\n                    <% } %>\n                    </ul>\n                </div>\n            </div>\n        <% } %>\n\n        <div class="word-counter pull-right">还能输入 <i><%=charLimit %></i> 个字</div>\n    </div>\n</div>\n<% } else { %>\n<div class="misc clearfix">\n    <div class="content-actions clearfix">\n        <div class="word-counter pull-right">还能输入 <i><%=charLimit %></i> 个字</div>\n    </div>\n</div>\n<% } %>\n\n'
}),define("components/wb_editor_v2/models/data",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=t("core/utils"),n=e.Model.extend({defaults:function(){return{type:"text",pics:[],content:""}},i18n:{text:"文本",picture:"图片",articles:"图文",feature:"微杂志",category:"微杂志分类",goods:"商品",tag:"商品标签",homepage:"商家主页",usercenter:"会员主页"},initialize:function(t,e){var i=this,n=e.modules||[],s="text,"+n.join(",");s=s.replace("goods","goods,tag").replace("feature","feature,category"),i.modules=s.split(",")},validate:function(t){var e=this,n=!0,s=t.type,o=e.modules;return o&&!_(o).contains(s)?(n="此编辑器不支持插入“"+e.i18n[s]+"”类型的内容。",i.errorNotify(n),n):void 0}});return n}),define("components/wb_editor_v2/models/picture",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=t("core/utils"),n=e.Model.extend({idAttribute:"_id",defaults:{attachment_title:"",attachment_url:"",attachment_url_full:""},initialize:function(){var t=this,e=i.fullfillImage(t.get("attachment_url"));t.set({attachment_url_full:e},{slient:!0})}});return n}),define("components/wb_editor_v2/collections/picture_list",["require","backbone","components/wb_editor_v2/models/picture","core/utils"],function(t){var e=t("backbone"),i=t("components/wb_editor_v2/models/picture"),n=t("core/utils"),s=e.Collection.extend({model:i,initialize:function(t){var e=this;e.maxSize=t.maxSize||9},getPics:function(){var t=this;return t.pluck("attachment_url")},checkMaxsize:function(){var t=this,e=t.length<t.maxSize,i="最多支持 "+t.maxSize+" 张图片。";return e||n.errorNotify(i),e}});return s}),define("text!components/wb_editor_v2/templates/picture.html",[],function(){return'<!-- <div class="picture-wrapper"> -->\n    <a href="javascript:;" class="close--circle js-delete-picture">&times;</a>\n    <a title="<%=attachment_title %>" class="picture loading" target="_blank" href="<%=attachment_url_full %>"><img src="<%=attachment_url_full %>!100x100.jpg" alt="" /></a>\n<!-- </div> -->\n'}),define("components/wb_editor_v2/views/picture",["require","backbone","text!components/wb_editor_v2/templates/picture.html","core/utils"],function(t){var e=t("backbone"),i=t("text!components/wb_editor_v2/templates/picture.html"),n=(t("core/utils"),e.View.extend({template:_.template(i),tagName:"div",className:"picture-wrapper",events:{"click .js-delete-picture":"deletePicture"},initialize:function(){var t=this;t.listenTo(t.model,"change",t.render),t.listenTo(t.model,"destroy",t.remove)},render:function(){var t=this;return t.$el.html(t.template(t.model.toJSON())),this.$("img").load(function(){$(this).parents(".picture").removeClass("loading").off("load")}),t},deletePicture:function(){var t=this,e=t.model.collection;t.model.destroy(),e.trigger("update:picture_list")}}));return n}),define("components/wb_emotion/datas/default",["require"],function(){var t=[{phrase:"[草泥马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7a/shenshou_thumb.gif",value:"[草泥马]",picid:""},{phrase:"[神马]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/60/horse2_thumb.gif",value:"[神马]",picid:""},{phrase:"[浮云]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]",picid:""},{phrase:"[给力]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c9/geili_thumb.gif",value:"[给力]",picid:""},{phrase:"[围观]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f2/wg_thumb.gif",value:"[围观]",picid:""},{phrase:"[威武]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/vw_thumb.gif",value:"[威武]",picid:""},{phrase:"[熊猫]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/panda_thumb.gif",value:"[熊猫]",picid:""},{phrase:"[兔子]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/81/rabbit_thumb.gif",value:"[兔子]",picid:""},{phrase:"[奥特曼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]",picid:""},{phrase:"[囧]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/15/j_thumb.gif",value:"[囧]",picid:""},{phrase:"[互粉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/hufen_thumb.gif",value:"[互粉]",picid:""},{phrase:"[礼物]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c4/liwu_thumb.gif",value:"[礼物]",picid:""},{phrase:"[呵呵]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]",picid:""},{phrase:"[嘻嘻]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0b/tootha_thumb.gif",value:"[嘻嘻]",picid:""},{phrase:"[哈哈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/laugh.gif",value:"[哈哈]",picid:""},{phrase:"[可爱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/14/tza_thumb.gif",value:"[可爱]",picid:""},{phrase:"[可怜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/kl_thumb.gif",value:"[可怜]",picid:""},{phrase:"[挖鼻屎]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a0/kbsa_thumb.gif",value:"[挖鼻屎]",picid:""},{phrase:"[吃惊]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f4/cj_thumb.gif",value:"[吃惊]",picid:""},{phrase:"[害羞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6e/shamea_thumb.gif",value:"[害羞]",picid:""},{phrase:"[挤眼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c3/zy_thumb.gif",value:"[挤眼]",picid:""},{phrase:"[闭嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/29/bz_thumb.gif",value:"[闭嘴]",picid:""},{phrase:"[鄙视]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/71/bs2_thumb.gif",value:"[鄙视]",picid:""},{phrase:"[爱你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/lovea_thumb.gif",value:"[爱你]",picid:""},{phrase:"[泪]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9d/sada_thumb.gif",value:"[泪]",picid:""},{phrase:"[偷笑]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/19/heia_thumb.gif",value:"[偷笑]",picid:""},{phrase:"[亲亲]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8f/qq_thumb.gif",value:"[亲亲]",picid:""},{phrase:"[生病]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/b6/sb_thumb.gif",value:"[生病]",picid:""},{phrase:"[太开心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/mb_thumb.gif",value:"[太开心]",picid:""},{phrase:"[懒得理你]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/17/ldln_thumb.gif",value:"[懒得理你]",picid:""},{phrase:"[右哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/98/yhh_thumb.gif",value:"[右哼哼]",picid:""},{phrase:"[左哼哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/zhh_thumb.gif",value:"[左哼哼]",picid:""},{phrase:"[嘘]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a6/x_thumb.gif",value:"[嘘]",picid:""},{phrase:"[衰]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/af/cry.gif",value:"[衰]",picid:""},{phrase:"[委屈]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/73/wq_thumb.gif",value:"[委屈]",picid:""},{phrase:"[吐]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/9e/t_thumb.gif",value:"[吐]",picid:""},{phrase:"[打哈欠]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/f3/k_thumb.gif",value:"[打哈欠]",picid:""},{phrase:"[抱抱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/27/bba_thumb.gif",value:"[抱抱]",picid:""},{phrase:"[怒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7c/angrya_thumb.gif",value:"[怒]",picid:""},{phrase:"[疑问]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/5c/yw_thumb.gif",value:"[疑问]",picid:""},{phrase:"[馋嘴]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/a5/cza_thumb.gif",value:"[馋嘴]",picid:""},{phrase:"[拜拜]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/70/88_thumb.gif",value:"[拜拜]",picid:""},{phrase:"[思考]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/e9/sk_thumb.gif",value:"[思考]",picid:""},{phrase:"[汗]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/24/sweata_thumb.gif",value:"[汗]",picid:""},{phrase:"[困]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/7f/sleepya_thumb.gif",value:"[困]",picid:""},{phrase:"[睡觉]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6b/sleepa_thumb.gif",value:"[睡觉]",picid:""},{phrase:"[钱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/90/money_thumb.gif",value:"[钱]",picid:""},{phrase:"[失望]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/0c/sw_thumb.gif",value:"[失望]",picid:""},{phrase:"[酷]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/cool_thumb.gif",value:"[酷]",picid:""},{phrase:"[花心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/8c/hsa_thumb.gif",value:"[花心]",picid:""},{phrase:"[哼]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/49/hatea_thumb.gif",value:"[哼]",picid:""},{phrase:"[鼓掌]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/36/gza_thumb.gif",value:"[鼓掌]",picid:""},{phrase:"[晕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/dizzya_thumb.gif",value:"[晕]",picid:""},{phrase:"[悲伤]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1a/bs_thumb.gif",value:"[悲伤]",picid:""},{phrase:"[抓狂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/62/crazya_thumb.gif",value:"[抓狂]",picid:""},{phrase:"[黑线]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/h_thumb.gif",value:"[黑线]",picid:""},{phrase:"[阴险]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6d/yx_thumb.gif",value:"[阴险]",picid:""},{phrase:"[怒骂]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/89/nm_thumb.gif",value:"[怒骂]",picid:""},{phrase:"[心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/hearta_thumb.gif",value:"[心]",picid:""},{phrase:"[伤心]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/ea/unheart.gif",value:"[伤心]",picid:""},{phrase:"[猪头]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/58/pig.gif",value:"[猪头]",picid:""},{phrase:"[ok]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d6/ok_thumb.gif",value:"[ok]",picid:""},{phrase:"[耶]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d9/ye_thumb.gif",value:"[耶]",picid:""},{phrase:"[good]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/good_thumb.gif",value:"[good]",picid:""},{phrase:"[不要]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/c7/no_thumb.gif",value:"[不要]",picid:""},{phrase:"[赞]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d0/z2_thumb.gif",value:"[赞]",picid:""},{phrase:"[来]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/40/come_thumb.gif",value:"[来]",picid:""},{phrase:"[弱]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d8/sad_thumb.gif",value:"[弱]",picid:""},{phrase:"[蜡烛]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/91/lazu_thumb.gif",value:"[蜡烛]",picid:""},{phrase:"[钟]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/d3/clock_thumb.gif",value:"[钟]",picid:""},{phrase:"[话筒]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_org.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/1b/m_thumb.gif",value:"[话筒]",picid:""},{phrase:"[蛋糕]",type:"face",url:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",hot:!1,common:!0,category:"",icon:"http://img.t.sinajs.cn/t4/appstyle/expression/ext/normal/6a/cake.gif",value:"[蛋糕]",picid:""}];return t}),define("components/wb_emotion/models/emotion",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=(t("core/utils"),e.Model.extend({defaults:{},initialize:function(){}}));return i}),define("components/wb_emotion/collections/emotion_list",["require","backbone","components/wb_emotion/models/emotion","core/utils"],function(t){var e=t("backbone"),i=t("components/wb_emotion/models/emotion"),n=(t("core/utils"),e.Collection.extend({model:i,initialize:function(t){var e=this;e.options=t,e.listenTo(e,"selected:emotion",e.selectEmotion)},selectEmotion:function(){}}));return n}),define("text!components/wb_emotion/templates/emotion.html",[],function(){return'<img src="<%=icon %>" alt="<%=value %>" title="<%=value %>">\n'}),define("components/wb_emotion/views/emotion",["require","backbone","text!components/wb_emotion/templates/emotion.html","components/wb_emotion/models/emotion","core/utils"],function(t){var e=t("backbone"),i=t("text!components/wb_emotion/templates/emotion.html"),n=(t("components/wb_emotion/models/emotion"),t("core/utils"),e.View.extend({tagName:"li",template:_.template(i),events:{click:"selectEmotion"},initialize:function(){},render:function(){var t=this;return t.$el.html(t.template(t.model.toJSON())),t},selectEmotion:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.model.collection.trigger("selected:emotion",e.model)}}));return n}),define("components/wb_emotion/views/emotion_list",["require","backbone","components/wb_emotion/views/emotion","core/utils"],function(t){var e=t("backbone"),i=t("components/wb_emotion/views/emotion"),n=(t("core/utils"),e.View.extend({initialize:function(){var t=this;t.listenTo(t.collection,"add",t.addOne),t.listenTo(t.collection,"reset",t.addAll),t.listenTo(t.collection,"all",t.render)},render:function(){var t=this;return t},addOne:function(t){var e=this,n=new i({model:t});e.$el.append(n.render().el)},addAll:function(){var t=this;t.$el.empty(),t.collection.each(this.addOne,this)}}));return n}),define("components/wb_emotion/com",["require","backbone","components/wb_emotion/datas/default","components/wb_emotion/collections/emotion_list","components/wb_emotion/views/emotion_list","core/utils"],function(t){var e=t("backbone"),i=t("components/wb_emotion/datas/default"),n=t("components/wb_emotion/collections/emotion_list"),s=t("components/wb_emotion/views/emotion_list"),o=(t("core/utils"),e.View.extend({events:{click:"stopPropagation"},initialize:function(t){var e=this;e.config=t,e.render()},render:function(){var t=this;return t.emotionList=new n([]),t.container=t.$el.find(".emotion-container"),t.emotionListView=new s({el:t.container,collection:t.emotionList}),t.emotionList.reset(i),t.listenTo(t.emotionList,"selected:emotion",t.selectEmotion),t},selectEmotion:function(t){var e=this;e.trigger("selected:emotion",t.get("value")),e.hide()},show:function(){var t=this;t.$el.show().position({of:t.config.target,my:"center bottom",at:"center top"})},hide:function(){this.$el.hide()},toggle:function(){var t=this,e=t.$el.is(":hidden");e?t.show():t.hide()},stopPropagation:function(t){t.stopPropagation()}}));return o}),define("text!components/wb_hyperlink/templates/hyperlink.html",[],function(){return'<input class="js-txt input-large txt" type="text" placeholder="http://" />\n<button class="js-btn-hyperlink btn btn-primary">确定</button>\n'}),define("components/wb_hyperlink/com",["require","backbone","text!components/wb_hyperlink/templates/hyperlink.html","core/utils"],function(t){var e=t("backbone"),i=t("text!components/wb_hyperlink/templates/hyperlink.html"),n=t("core/utils"),s=e.View.extend({template:_.template(i),events:{"click .js-btn-hyperlink":"saveHyperlink","keypress .js-txt":"enterSave",click:"stopPropagation"},initialize:function(t){var e=this;e.config=t,e.render()},render:function(){var t=this;return t.$el.html(t.template({})),t.txt=t.$el.find(".js-txt"),t},saveHyperlink:function(t){t&&t.preventDefault();var e=this,i=e.txt.val();return i=$.trim(i),""===i?(e.txt.focus(),!1):(i=n.urlCheck(i),i=" "+i+" ",e.trigger("save:hyperlink",i),e.txt.val(""),void e.hide())},enterSave:function(){var t=this;return event.which===n.keyCode.ENTER?(t.saveHyperlink(),!1):void 0},show:function(){var t=this;t.$el.show().position({of:t.config.target,my:"center bottom",at:"center top"}),t.txt.focus()},hide:function(){this.$el.hide()},toggle:function(){var t=this,e=t.$el.is(":hidden");e?t.show():t.hide()},stopPropagation:function(t){t.stopPropagation()}});return s}),define("components/homepage/com",["require","jquery","underscore","core/utils"],function(t){var e=t("jquery"),i=t("underscore"),n=t("core/utils"),s=function(){};return s.prototype.get=function(t){var s=window._global.url.www+"/showcase/homepage/detail.json";e.ajax({url:s,type:"GET",dataType:"json",timeout:3e4}).done(function(e){if(0===e.code){if(i.isFunction(t)){var s=e.data,o=window._global.url.wap+"/showcase/homepage?alias="+e.data.alias;t({id:s.id,alias:s.alias,type:"homepage",title:s.data[0].title,link:o,data_url:o})}}else n.errorNotify(e.msg)}).fail(function(){n.errorNotify("出错鸟，获取店铺首页链接失败。")})},s}),define("components/usercenter/com",["require","jquery","underscore","core/utils"],function(t){var e=t("jquery"),i=t("underscore"),n=t("core/utils"),s=function(){};return s.prototype.get=function(t){var s=window._global.url.www+"/showcase/usercenter/detail.json";e.ajax({url:s,type:"GET",dataType:"json",timeout:3e4}).done(function(e){if(0===e.code){if(i.isFunction(t)){var s=e.data,o=window._global.url.wap+"/showcase/usercenter?alias="+e.data.alias;t({id:s.id,alias:s.alias,type:"usercenter",title:s.data[0].title,link:o,data_url:o})}}else n.errorNotify(e.msg)}).fail(function(){n.errorNotify("出错鸟，获取店铺首页链接失败。")})},s}),define("text!components/wb_editor_v2/templates/complex.html",[],function(){return'<% if (type === \'feature\') { %>\n<!-- 微杂志 -->\n<div class="ng ng-single">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">微杂志</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item view-more">\n        <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n            <span class="pull-left">阅读全文</span>\n            <span class="pull-right">&gt;</span>\n        </a>\n    </div>\n</div>\n\n<% } else if (type === \'category\') { %>\n<!-- 微杂志分类 -->\n<div class="ng ng-multiple-mini">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">微杂志分类</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n</div>\n\n<% } else if (type === \'goods\') { %>\n<!-- 商品 -->\n<div class="ng ng-single">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">商 品</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item view-more">\n        <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n            <span class="pull-left">阅读全文</span>\n            <span class="pull-right">&gt;</span>\n        </a>\n    </div>\n</div>\n\n<% } else if (type === \'tag\') { %>\n<!-- 商品标签 -->\n<div class="ng ng-multiple-mini">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">分 类</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n</div>\n\n<% } else if (type === \'articles\') { %>\n<!-- 图文 -->\n    <% if(content.reply && content.reply.length > 1) { %>\n        <div class="ng ng-multiple-mini">\n            <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n            <div class="ng-item">\n                <span class="label label-success">多条图文</span>\n                <div class="ng-title">\n                    <a href="<%=content.reply[0].link %>" target="_blank" class="new-window" title="<%-content.reply[0].title %>"><%=content.reply[0].title %></a>\n                </div>\n            </div>\n            <% for(var idx = 1, len = content.reply.length; idx < len; idx++) { %>\n            <div class="ng-item"></div>\n            <% } %>\n        </div>\n    <% } else { %>\n        <div class="ng ng-single">\n            <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n            <div class="ng-item">\n                <span class="label label-success">图 文</span>\n                <div class="ng-title">\n                    <a href="<%=content.reply[0].link %>" target="_blank" class="new-window" title="<%-content.reply[0].title %>"><%=content.reply[0].title %></a>\n                </div>\n            </div>\n            <div class="ng-item view-more">\n                <a href="<%=content.reply[0].link %>" target="_blank" class="clearfix new-window">\n                    <span class="pull-left">阅读全文</span>\n                    <span class="pull-right">&gt;</span>\n                </a>\n            </div>\n        </div>\n    <% } %>\n\n<% } else if (type === \'homepage\') { %>\n    <!-- 店铺主页 -->\n    <div class="ng ng-single">\n        <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n        <div class="ng-item">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="商家主页"><span class="label label-success">商家主页</span></a>\n        </div>\n        <div class="ng-item view-more">\n            <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n                <span class="pull-left">阅读全文</span>\n                <span class="pull-right">&gt;</span>\n            </a>\n        </div>\n    </div>\n<% } else if (type === \'usercenter\') { %>\n    <div class="ng ng-single">\n        <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n        <div class="ng-item">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="会员主页"><span class="label label-success">会员主页</span></a>\n        </div>\n        <div class="ng-item view-more">\n            <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n                <span class="pull-left">阅读全文</span>\n                <span class="pull-right">&gt;</span>\n            </a>\n        </div>\n    </div>\n<% } else if (type === \'image\') { %>\n    <div class="ng ng-single ng-image">\n        <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n        <a title="<%=content.reply.title %>" class="picture" target="_blank" href="<%=content.reply.link %>"><img src="<%=content.reply.link %>!100x100.jpg" alt="" /></a>\n    </div>\n<% } %>\n'}),function(t,e){function i(t,e){return null===t?"null"===e:void 0===t?"undefined"===e:t.is&&t instanceof l?"element"===e:Object.prototype.toString.call(t).toLowerCase().indexOf(e)>7}function n(t){var e,s,o,a,r,l,c,d,p;if(t instanceof n)return t;for(i(t,"array")||(t=String(t).replace(/\s/g,"").toLowerCase().match(/(?:\+,|[^,])+/g)),e=0,s=t.length;s>e;++e){for(i(t[e],"array")||(t[e]=String(t[e]).match(/(?:\+\/|[^\/])+/g)),l=[],o=t[e].length;o--;){for(c=t[e][o],r={jwertyCombo:String(c),shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},i(c,"array")||(c=String(c).toLowerCase().match(/(?:(?:[^\+])+|\+\+|^\+$)/g)),a=c.length;a--;)"++"===c[a]&&(c[a]="+"),c[a]in u.mods?r[h[u.mods[c[a]]]]=!0:c[a]in u.keys?r.keyCode=u.keys[c[a]]:d=c[a].match(/^\[([^-]+\-?[^-]*)-([^-]+\-?[^-]*)\]$/);
if(i(r.keyCode,"undefined"))if(d&&d[1]in u.keys&&d[2]in u.keys){for(d[2]=u.keys[d[2]],d[1]=u.keys[d[1]],p=d[1];p<d[2];++p)l.push({altKey:r.altKey,shiftKey:r.shiftKey,metaKey:r.metaKey,ctrlKey:r.ctrlKey,keyCode:p,jwertyCombo:String(c)});r.keyCode=p}else r.keyCode=0;l.push(r)}this[e]=l}return this.length=e,this}var s,o,a,r=t.document,l=t.jQuery||t.Zepto||t.ender||r,c="keydown";l===r?(s=function(t,e){return t?l.querySelector(t,e||l):l},o=function(t,e){t.addEventListener(c,e,!1)},a=function(t,e){var i,n=r.createEvent("Event");n.initEvent(c,!0,!0);for(i in e)n[i]=e[i];return(t||l).dispatchEvent(n)}):(s=function(t,e){return l(t||r,e)},o=function(t,e){l(t).bind(c+".jwerty",e)},a=function(t,e){l(t||r).trigger(l.Event(c,e))});for(var h={16:"shiftKey",17:"ctrlKey",18:"altKey",91:"metaKey"},u={mods:{"⇧":16,shift:16,"⌃":17,ctrl:17,"⌥":18,alt:18,option:18,"⌘":91,meta:91,cmd:91,"super":91,win:91},keys:{"⌫":8,backspace:8,"⇥":9,"⇆":9,tab:9,"↩":13,"return":13,enter:13,"⌅":13,pause:19,"pause-break":19,"⇪":20,caps:20,"caps-lock":20,"⎋":27,escape:27,esc:27,space:32,"↖":33,pgup:33,"page-up":33,"↘":34,pgdown:34,"page-down":34,"⇟":35,end:35,"⇞":36,home:36,ins:45,insert:45,del:46,"delete":46,"←":37,left:37,"arrow-left":37,"↑":38,up:38,"arrow-up":38,"→":39,right:39,"arrow-right":39,"↓":40,down:40,"arrow-down":40,"*":106,star:106,asterisk:106,multiply:106,"+":107,plus:107,"-":109,subtract:109,"num-.":110,"num-period":110,"num-dot":110,"num-full-stop":110,"num-delete":110,";":186,semicolon:186,"=":187,equals:187,",":188,comma:188,".":190,period:190,"full-stop":190,"/":191,slash:191,"forward-slash":191,"`":192,tick:192,"back-quote":192,"[":219,"open-bracket":219,"\\":220,"back-slash":220,"]":221,"close-bracket":221,"'":222,quote:222,apostraphe:222}},d=47,p=0;++d<106;)u.keys[p]=d,u.keys["num-"+p]=d+48,++p;for(d=111,p=1;++d<136;)u.keys["f"+p]=d,++p;for(d=64;++d<91;)u.keys[String.fromCharCode(d).toLowerCase()]=d;var f=e.jwerty={event:function(t,e,s){if(i(e,"boolean")){var o=e;e=function(){return o}}t=new n(t);var a,r,l=0,c=t.length-1;return function(i){return(r=f.is(t,i,l))?c>l?void++l:(a=e.call(s||this,i,r),a===!1&&i.preventDefault(),void(l=0)):void(l=f.is(t,i)?1:0)}},is:function(t,e,i){t=new n(t),i=i||0,t=t[i],e=e.originalEvent||e;for(var s=t.length,o=!1;s--;){o=t[s].jwertyCombo;for(var a in t[s])"jwertyCombo"!==a&&e[a]!=t[s][a]&&(o=!1);if(o!==!1)return o}return o},key:function(e,n,a,r,l){var c=i(a,"element")||i(a,"string")?a:r,h=c===a?t:a,u=c===a?r:l;o(i(c,"element")?c:s(c,u),f.event(e,n,h))},fire:function(t,e,o,r){t=new n(t);var l=i(o,"number")?o:r;a(i(e,"element")?e:s(e,o),t[l||0][0])},KEYS:u}}(this,"undefined"!=typeof module&&module.exports?module.exports:this),define("jwerty",["jquery"],function(){}),define("components/wb_editor_v2/views/editor",["require","jquery","backbone","components/modal/1.0.0/modal","components/image/1.0.0/image","text!components/wb_editor_v2/templates/editor.html","components/wb_editor_v2/models/data","components/wb_editor_v2/collections/picture_list","components/wb_editor_v2/views/picture","components/wb_emotion/com","components/wb_hyperlink/com","components/homepage/com","components/usercenter/com","text!components/wb_editor_v2/templates/complex.html","core/utils","jwerty"],function(t){var e=t("jquery"),i=t("backbone"),n=t("components/modal/1.0.0/modal"),s=t("components/image/1.0.0/image"),o=t("text!components/wb_editor_v2/templates/editor.html"),a=t("components/wb_editor_v2/models/data"),r=t("components/wb_editor_v2/collections/picture_list"),l=t("components/wb_editor_v2/views/picture"),c=t("components/wb_emotion/com"),h=t("components/wb_hyperlink/com"),u=t("components/homepage/com"),d=t("components/usercenter/com"),p=t("text!components/wb_editor_v2/templates/complex.html"),f=t("core/utils");t("jwerty");var m=i.View.extend({template:_.template(o),complexTemplate:_.template(p),events:{"click .js-delete-complex":"deleteComplex","keyup .js-txta":"textUx",click:"hideMiscPops"},initialize:function(t){var e=this;e.config={},e.setConfig(t),e.hideModules=[],e.listenTo(e,"update:counter",e.updateCounter),e.render(),e.init(),e.renderContent()},setConfig:function(t){var e=this;_(e.config).extend(t);var i=e.model,n=i.get("data");e.charLimit=i.get("charLimit"),e.picLimit=i.get("picLimit"),e.hasSign=i.get("hasSign"),e.sign="",e.hasSign&&"text"===n.type&&(e.sign=n.content)},render:function(){var t=this;return t.$el.html(t.template(t.model.toJSON())),t.$txta=t.$el.find(".js-txta"),t.txta=t.$txta[0],t.counter=t.$el.find(".word-counter i"),t.pictureContainer=t.$el.find(".js-picture-container"),t.complexBackdrop=t.$el.find(".complex-backdrop"),t.complexContent=t.$el.find(".js-complex-content"),t.focusTxta(),t},init:function(){var t=this;t.initModules(),t.initEditorData(),t.initShortcuts()},renderContent:function(){var t=this,e=t.getContent(),i=e.type;"text"===i?(t.switchToText(),t.setText(e.content),t.renderPicture(e.pics)):t.renderComplex(e)},initEditorData:function(){var t=this,e=t.model;t.editorData=new a(e.get("data"),{modules:e.get("modules")}),t.listenTo(t.editorData,"change",t.renderContent)},initShortcuts:function(){var t=this;t.$txta.bind("keydown",jwerty.event("ctrl+enter",function(){t.trigger("ctrl+enter:txta")}))},initModules:function(){var t,e,i=this,n=i.model.get("modules"),s=i.model.get("supportModules"),o={};_.each(n,function(n){_.has(s,n)&&(t=s[n],e=i["init"+t],_.isFunction(e)&&e.apply(i),o["click .js-open-"+n]="toggle"+t)}),_(i.events).extend(o)},textUx:function(){var t=this,e=t.$txta.val();t.hasRemain(e),t.updateData({type:"text",content:e},{silent:!0})},hasRemain:function(t){var e=this,i=f.wbLength(t),n=e.charLimit-i;return e.trigger("update:counter",n),n>=0?!0:!1},updateData:function(t,e){var i=this,n=i.model.get("data");_(n).extend(t);var s={validate:!0};_(s).extend(e),i.editorData.set(n,s)},initEmotion:function(){var t=this;t.emotionTrigger=t.$el.find(".js-open-emotion"),t.emotionWrapper=t.$el.find(".emotion-wrapper")},_initEmotion:function(){var t=this;t.wbEmotion=new c({target:t.emotionTrigger,el:t.emotionWrapper}),t.hideModules.push(t.wbEmotion),t.listenTo(t.wbEmotion,"selected:emotion",t.insertText)},initHyperlink:function(){var t=this;t.hyperlinkTrigger=t.$el.find(".js-open-hyperlink"),t.hyperlinkWrapper=t.$el.find(".hyperlink-wrapper"),t.wbHyperlink=new h({target:t.hyperlinkTrigger,el:t.hyperlinkWrapper}),t.hideModules.push(t.wbHyperlink),t.listenTo(t.wbHyperlink,"save:hyperlink",t.insertText)},initArticles:function(){},initHomepage:function(){var t=this;t.homepage=new u,t.usercenter=new d},initPicture:function(){var t=this,e=t.pictureList=new r([]);t.listenTo(e,"add",t.addOnePicture),t.listenTo(e,"reset",t.addAllPicture),t.listenTo(e,"update:picture_list",t.updatePics)},setText:function(t){var e=this;e.$txta.val(t).trigger("keyup")},insertText:function(t){var e=this;f.insertText(e.txta,t),e.$txta.trigger("keyup")},updateCounter:function(t){var e=this;e.counter.html(t),e.counter.toggleClass("error",0>t)},toggleHyperlink:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.switchToText(),e.hideMiscPops(),e.wbHyperlink.toggle()},toggleEmotion:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.wbEmotion||e._initEmotion(),e.switchToText(),e.hideMiscPops(),e.wbEmotion.toggle()},toggleArticles:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.articleModal=n.initialize({type:"articles"}).setChooseItemCallback(function(t){e.insertComplex({type:"articles",content:{_id:t.id,reply:t.news}})}),e.articleModal.modal("show")},togglePicture:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.pictureModal=s.initialize({multiChoose:!1,callback:function(t){t=t[0],e.switchToText(),e.insertPicture(t)}})},toggleImage:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.imageModal=n.initialize({type:"image"}).setChooseItemCallback(function(t){e.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.attachment_title,link:f.fullfillImage(t.attachment_url)}}})}),e.imageModal.modal("show")},toggleShortlink:function(t){var i=this,n=e(t.target),s=n.data("link-type");i.homepage||i.initHomepage(),i["toggle"+s]()},toggleFeature:function(t){var i=this,s=!1;t&&(s=e(t.target).data("complex-mode")),i.featureModal=n.initialize({type:"feature"}).setChooseItemCallback(function(t){s?i.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.title,link:t.data_url}}}):(i.switchToText(),i.insertText(" "+t.data_url+" "))}),i.featureModal.modal("show")},toggleGoods:function(t){var i=this,s=!1;t&&(s=e(t.target).data("complex-mode")),i.goodsModal=n.initialize({type:"goods"}).setChooseItemCallback(function(t){s?i.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.title,link:t.data_url}}}):(i.switchToText(),i.insertText(" "+t.data_url+" "))}),i.goodsModal.modal("show")},toggleHomepage:function(t){var i=this,n=!1;return t&&(n=e(t.target).data("complex-mode")),"homepage"===i.model.get("data").type?!1:void i.homepage.get(function(t){n?i.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.title,link:t.data_url}}}):(i.switchToText(),i.insertText(" "+t.data_url+" "))})},toggleUsercenter:function(){var t=this,i=!1;return event&&(i=e(event.target).data("complex-mode")),"usercenter"===t.model.get("data").type?!1:void t.usercenter.get(function(e){i?t.insertComplex({type:e.type,content:{_id:e.id,reply:{title:e.title,link:e.data_url}}}):(t.switchToText(),t.insertText(" "+e.data_url+" "))})},insertComplex:function(t){var e=this;e.renderComplex(t),e.updateData(t),e.$txta.focus()},renderComplex:function(t){var e=this;e.showBackdrop();var i=e.complexTemplate(t);e.complexContent.empty(),e.complexContent.append(i)},insertPicture:function(t){var e=this;e.pictureList&&(e.picLimit>1?e.pictureList.checkMaxsize()&&e.pictureList.add(t):e.pictureList.reset(t),e.pictureList.trigger("update:picture_list"))},addOnePicture:function(t){var e=this,i=new l({model:t});e.pictureContainer.append(i.render().el)},addAllPicture:function(){var t=this;t.pictureContainer.empty(),t.pictureList.each(t.addOnePicture,t)},updatePics:function(){var t=this,e=t.pictureList.getPics();t.updateData({pics:e},{silent:!0})},renderPicture:function(t){for(var e=this,i=0,n=t.length;n>i;i++)t[i]={attachment_url:t[i]};e.insertPicture(t)},existedComplex:function(){var t=this,e=t.editorData.toJSON();"text"!==e.type&&t.renderComplex(e)},showBackdrop:function(){this.complexBackdrop.show()},hideBackdrop:function(){this.complexBackdrop.hide()},focusTxta:function(){var t=this;t.$txta.focus()},clearTxta:function(){var t=this;t.$txta.val(t.hasSign?t.sign:""),t.resetData()},clearPicture:function(){var t=this;t.pictureList&&t.pictureList.reset([])},resetData:function(){var t=this;t.updateData({type:"text",content:t.sign||"",pics:[]})},deleteComplex:function(){var t=this;t.complexContent.empty(),t.hideBackdrop(),t.textUx(),t.focusTxta()},switchToText:function(){var t=this;t.deleteComplex()},hideMiscPops:function(){var t=this;_(t.hideModules).each(function(t){t.hide()})},clear:function(){var t=this;t.deleteComplex(),t.clearTxta(),t.clearPicture()},getContent:function(){var t=this,e=t.editorData.toJSON();return"text"===e.type&&f.wbLength(e.content)>t.charLimit&&(t.flashAnimate(),t.focusTxta()),e},flashAnimate:function(){var t=this;t.$txta.addClass("animated flashError"),window.clearTimeout(t.flashTimer),t.flashTimer=window.setTimeout(function(){t.$txta.removeClass("flashError")},2e3)}});return m}),define("components/wb_editor_v2/com",["require","backbone","components/wb_editor_v2/models/editor","components/wb_editor_v2/views/editor","components/wb_emotion/com","components/wb_hyperlink/com","core/utils"],function(t){var e=t("backbone"),i=t("components/wb_editor_v2/models/editor"),n=t("components/wb_editor_v2/views/editor"),s=(t("components/wb_emotion/com"),t("components/wb_hyperlink/com"),t("core/utils"),e.View.extend({initialize:function(t){var e=this;null==t.config.thumb&&(t.config.thumb=!1);var s=e.config=t.config,o=e.editor=new i(s);e.editorView=new n({el:e.el,model:o}),e.listenTo(e.editorView,"ctrl+enter:txta",e.shortcuts)},render:function(){var t=this;return t},focus:function(){var t=this;t.editorView.focusTxta()},shortcuts:function(){var t=this;t.trigger("ctrl+enter:txta")},updateContent:function(t){var e=this;e.editorView.updateData(t)},insertText:function(t){var e=this;e.editorView.insertText(t)},setContent:function(){},getContent:function(){var t=this,e=t.editorView.getContent();return e},clear:function(){var t=this;t.editorView.clear()}}));return s}),define("components/pop/reply",["require","backbone","components/pop/base","text!components/pop/templates/reply.html","components/wb_editor_v2/com","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/reply.html"),n=t("components/wb_editor_v2/com");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-close":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){var i=this;e.prototype.initialize.call(i,t),i.data=t.data},render:function(){var t=this,e=t.data;return t.$el.html(t.template(e)),t.wbEditorEle=t.$el.find(".wb-sender__input"),t.wbEditor=new n({config:{modules:["emotion","hyperlink","articles","feature","goods","homepage"],data:e},el:t.wbEditorEle}),t},positioning:function(){var t=this,e=t.options.className;t.el.className=e,t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center"}:{of:t.target,my:"left center",at:"right center"}),t.wbEditor.focus()},setData:function(t){var e=this;e.wbEditor.updateContent(t)},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className;this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},triggerCallback:function(){var t=this,e=t.wbEditor.getContent();return e.content?(t.callback.call(t,e),t.hide(),void t.wbEditor.clear()):(t.wbEditor.focus(),!1)}})}),define("text!components/pop/templates/normal_reply.html",[],function(){return'<div class="arrow"></div>\n<a href="javascript:;" class="close--circle js-close">&times;</a>\n<div class="popover-inner popover-normal-reply">\n    <div class="popover-content">\n        <div class="form-horizontal">\n            <h4>一般信息：</h4>\n            <div class="wb-sender">\n                <div class="wb-sender__inner">\n                    <div class="wb-sender__input">\n                    </div>\n                    <div class="wb-sender__actions">\n                        <button class="js-btn-confirm btn btn-primary">确定</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/normal_reply",["require","backbone","components/pop/base","text!components/pop/templates/normal_reply.html","components/wb_editor_v2/com","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/normal_reply.html"),n=t("components/wb_editor_v2/com");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-close":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.wbEditorEle=t.$el.find(".wb-sender__input"),t.wbEditor=new n({config:{modules:["emotion","hyperlink"],data:{type:"text",content:t.data.content}},el:t.wbEditorEle}),t},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center"}:{of:t.target,my:"left center",at:"right center"}),t.el.className=t.options.className},setData:function(t){var e=this,i={data:{type:t.type,content:t.content}};e.wbEditor.updateContent(i)},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className;this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},triggerCallback:function(){var t=this,e=t.wbEditor.getContent();return e.content?(t.callback.call(t,e),t.hide(),void t.wbEditor.clear()):(t.wbEditor.focus(),!1)}})}),define("text!components/pop/templates/url.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner">\n    <div class="popover-content">\n        <div class="form-inline">\n            <div class="input-append">\n                <input type="text" class="txt js-url-placeholder url-placeholder" readonly value="<%= url %>">\n                <button type="button" class="btn js-btn-copy" data-clipboard-text="<%= url %>">复制</button>\n            </div>\n        </div>\n    </div>\n</div>\n'}),function(){function t(t){return t.replace(/,/g,".").replace(/[^0-9\.]/g,"")}function e(e){return parseFloat(t(e))>=10}var i,n={bridge:null,version:"0.0.0",disabled:null,outdated:null,ready:null},s={},o=0,a={},r=0,l={},c=null,h=null,u=function(){var t,e,i,n,s="ZeroClipboard.swf";if(document.currentScript&&(n=document.currentScript.src));else{var o=document.getElementsByTagName("script");if("readyState"in o[0])for(t=o.length;t--&&("interactive"!==o[t].readyState||!(n=o[t].src)););else if("loading"===document.readyState)n=o[o.length-1].src;else{for(t=o.length;t--;){if(i=o[t].src,!i){e=null;break}if(i=i.split("#")[0].split("?")[0],i=i.slice(0,i.lastIndexOf("/")+1),null==e)e=i;else if(e!==i){e=null;break}}null!==e&&(n=e)}}return n&&(n=n.split("#")[0].split("?")[0],s=n.slice(0,n.lastIndexOf("/")+1)+s),s}(),d=function(){var t=/\-([a-z])/g,e=function(t,e){return e.toUpperCase()};return function(i){return i.replace(t,e)}}(),p=function(t,e){var i,n,s;return window.getComputedStyle?i=window.getComputedStyle(t,null).getPropertyValue(e):(n=d(e),i=t.currentStyle?t.currentStyle[n]:t.style[n]),"cursor"!==e||i&&"auto"!==i||(s=t.tagName.toLowerCase(),"a"!==s)?i:"pointer"},f=function(t){t||(t=window.event);var e;this!==window?e=this:t.target?e=t.target:t.srcElement&&(e=t.srcElement),I.activate(e)},m=function(t,e,i){t&&1===t.nodeType&&(t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i))},g=function(t,e,i){t&&1===t.nodeType&&(t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i))},v=function(t,e){if(!t||1!==t.nodeType)return t;if(t.classList)return t.classList.contains(e)||t.classList.add(e),t;if(e&&"string"==typeof e){var i=(e||"").split(/\s+/);if(1===t.nodeType)if(t.className){for(var n=" "+t.className+" ",s=t.className,o=0,a=i.length;a>o;o++)n.indexOf(" "+i[o]+" ")<0&&(s+=" "+i[o]);t.className=s.replace(/^\s+|\s+$/g,"")}else t.className=e}return t},y=function(t,e){if(!t||1!==t.nodeType)return t;if(t.classList)return t.classList.contains(e)&&t.classList.remove(e),t;if(e&&"string"==typeof e||void 0===e){var i=(e||"").split(/\s+/);if(1===t.nodeType&&t.className)if(e){for(var n=(" "+t.className+" ").replace(/[\n\t]/g," "),s=0,o=i.length;o>s;s++)n=n.replace(" "+i[s]+" "," ");t.className=n.replace(/^\s+|\s+$/g,"")}else t.className=""}return t},_=function(){var t,e,i,n=1;return"function"==typeof document.body.getBoundingClientRect&&(t=document.body.getBoundingClientRect(),e=t.right-t.left,i=document.body.offsetWidth,n=Math.round(e/i*100)/100),n},b=function(t,e){var i={left:0,top:0,width:0,height:0,zIndex:T(e)-1};if(t.getBoundingClientRect){var n,s,o,a=t.getBoundingClientRect();"pageXOffset"in window&&"pageYOffset"in window?(n=window.pageXOffset,s=window.pageYOffset):(o=_(),n=Math.round(document.documentElement.scrollLeft/o),s=Math.round(document.documentElement.scrollTop/o));var r=document.documentElement.clientLeft||0,l=document.documentElement.clientTop||0;i.left=a.left+n-r,i.top=a.top+s-l,i.width="width"in a?a.width:a.right-a.left,i.height="height"in a?a.height:a.bottom-a.top}return i},w=function(t,e){var i=null==e||e&&e.cacheBust===!0&&e.useNoCache===!0;return i?(-1===t.indexOf("?")?"?":"&")+"noCache="+(new Date).getTime():""},x=function(t){var e,i,n,s=[],o=[],a=[];if(t.trustedOrigins&&("string"==typeof t.trustedOrigins?o.push(t.trustedOrigins):"object"==typeof t.trustedOrigins&&"length"in t.trustedOrigins&&(o=o.concat(t.trustedOrigins))),t.trustedDomains&&("string"==typeof t.trustedDomains?o.push(t.trustedDomains):"object"==typeof t.trustedDomains&&"length"in t.trustedDomains&&(o=o.concat(t.trustedDomains))),o.length)for(e=0,i=o.length;i>e;e++)if(o.hasOwnProperty(e)&&o[e]&&"string"==typeof o[e]){if(n=$(o[e]),!n)continue;if("*"===n){a=[n];break}a.push.apply(a,[n,"//"+n,window.location.protocol+"//"+n])}return a.length&&s.push("trustedOrigins="+encodeURIComponent(a.join(","))),"string"==typeof t.jsModuleId&&t.jsModuleId&&s.push("jsModuleId="+encodeURIComponent(t.jsModuleId)),s.join("&")},k=function(t,e,i){if("function"==typeof e.indexOf)return e.indexOf(t,i);var n,s=e.length;for("undefined"==typeof i?i=0:0>i&&(i=s+i),n=i;s>n;n++)if(e.hasOwnProperty(n)&&e[n]===t)return n;return-1},C=function(t){if("string"==typeof t)throw new TypeError("ZeroClipboard doesn't accept query strings.");return t.length?t:[t]},D=function(t,e,i,n){n?window.setTimeout(function(){t.apply(e,i)},0):t.apply(e,i)},T=function(t){var e,i;return t&&("number"==typeof t&&t>0?e=t:"string"==typeof t&&(i=parseInt(t,10))&&!isNaN(i)&&i>0&&(e=i)),e||("number"==typeof A.zIndex&&A.zIndex>0?e=A.zIndex:"string"==typeof A.zIndex&&(i=parseInt(A.zIndex,10))&&!isNaN(i)&&i>0&&(e=i)),e||0},j=function(t,e){if(t&&e!==!1&&"undefined"!=typeof console&&console&&(console.warn||console.log)){console.warn}},S=function(){var t,e,i,n,s,o,a=arguments[0]||{};for(t=1,e=arguments.length;e>t;t++)if(null!=(i=arguments[t]))for(n in i)if(i.hasOwnProperty(n)){if(s=a[n],o=i[n],a===o)continue;void 0!==o&&(a[n]=o)}return a},$=function(t){if(null==t||""===t)return null;if(t=t.replace(/^\s+|\s+$/g,""),""===t)return null;var e=t.indexOf("//");t=-1===e?t:t.slice(e+2);var i=t.indexOf("/");return t=-1===i?t:-1===e||0===i?null:t.slice(0,i),t&&".swf"===t.slice(-4).toLowerCase()?null:t||null},N=function(){var t=function(t,e){var i,n,s;if(null!=t&&"*"!==e[0]&&("string"==typeof t&&(t=[t]),"object"==typeof t&&"length"in t))for(i=0,n=t.length;n>i;i++)if(t.hasOwnProperty(i)&&(s=$(t[i]))){if("*"===s){e.length=0,e.push("*");break}-1===k(s,e)&&e.push(s)}},e={always:"always",samedomain:"sameDomain",never:"never"};return function(i,n){var s,o=n.allowScriptAccess;if("string"==typeof o&&(s=o.toLowerCase())&&/^always|samedomain|never$/.test(s))return e[s];var a=$(n.moviePath);null===a&&(a=i);var r=[];t(n.trustedOrigins,r),t(n.trustedDomains,r);var l=r.length;if(l>0){if(1===l&&"*"===r[0])return"always";if(-1!==k(i,r))return 1===l&&i===a?"sameDomain":"always"}return"never"}}(),E=function(t){if(null==t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},F=function(t){if(t)for(var e in t)t.hasOwnProperty(e)&&delete t[e];return t},M=function(){var t=!1;if("boolean"==typeof n.disabled)t=n.disabled===!1;else{if("function"==typeof ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(t=!0)}catch(e){}!t&&navigator.mimeTypes["application/x-shockwave-flash"]&&(t=!0)}return t},I=function(t,e){return this instanceof I?(this.id=""+o++,a[this.id]={instance:this,elements:[],handlers:{}},t&&this.clip(t),"undefined"!=typeof e&&(j("new ZeroClipboard(elements, options)",A.debug),I.config(e)),this.options=I.config(),"boolean"!=typeof n.disabled&&(n.disabled=!M()),void(n.disabled===!1&&n.outdated!==!0&&null===n.bridge&&(n.outdated=!1,n.ready=!1,O()))):new I(t,e)};I.prototype.setText=function(t){return t&&""!==t&&(s["text/plain"]=t,n.ready===!0&&n.bridge&&n.bridge.setText(t)),this},I.prototype.setSize=function(t,e){return n.ready===!0&&n.bridge&&n.bridge.setSize(t,e),this};var z=function(t){n.ready===!0&&n.bridge&&n.bridge.setHandCursor(t)};I.prototype.destroy=function(){this.unclip(),this.off(),delete a[this.id]};var P=function(){var t,e,i,n=[],s=E(a);for(t=0,e=s.length;e>t;t++)i=a[s[t]].instance,i&&i instanceof I&&n.push(i);return n};I.version="1.3.2";var A={swfPath:u,trustedDomains:window.location.host?[window.location.host]:[],cacheBust:!0,forceHandCursor:!1,zIndex:999999999,debug:!0,title:null,autoActivate:!0};I.config=function(t){"object"==typeof t&&null!==t&&S(A,t);{if("string"!=typeof t||!t){var e={};for(var i in A)A.hasOwnProperty(i)&&(e[i]="object"==typeof A[i]&&null!==A[i]?"length"in A[i]?A[i].slice(0):S({},A[i]):A[i]);return e}if(A.hasOwnProperty(t))return A[t]}},I.destroy=function(){I.deactivate();for(var t in a)if(a.hasOwnProperty(t)&&a[t]){var e=a[t].instance;e&&"function"==typeof e.destroy&&e.destroy()}var i=L(n.bridge);i&&i.parentNode&&(i.parentNode.removeChild(i),n.ready=null,n.bridge=null)},I.activate=function(t){i&&(y(i,A.hoverClass),y(i,A.activeClass)),i=t,v(t,A.hoverClass),H();var e=A.title||t.getAttribute("title");if(e){var s=L(n.bridge);s&&s.setAttribute("title",e)}var o=A.forceHandCursor===!0||"pointer"===p(t,"cursor");z(o)},I.deactivate=function(){var t=L(n.bridge);t&&(t.style.left="0px",t.style.top="-9999px",t.removeAttribute("title")),i&&(y(i,A.hoverClass),y(i,A.activeClass),i=null)};var O=function(){var t,e,i=document.getElementById("global-zeroclipboard-html-bridge");if(!i){var s=I.config();s.jsModuleId="string"==typeof c&&c||"string"==typeof h&&h||null;var o=N(window.location.host,A),a=x(s),r=A.moviePath+w(A.moviePath,A),l='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+r+'"/>         <param name="allowScriptAccess" value="'+o+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+a+'"/>         <embed src="'+r+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="'+o+'"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+a+'"           scale="exactfit">         </embed>       </object>';i=document.createElement("div"),i.id="global-zeroclipboard-html-bridge",i.setAttribute("class","global-zeroclipboard-container"),i.style.position="absolute",i.style.left="0px",i.style.top="-9999px",i.style.width="15px",i.style.height="15px",i.style.zIndex=""+T(A.zIndex),document.body.appendChild(i),i.innerHTML=l}t=document["global-zeroclipboard-flash-bridge"],t&&(e=t.length)&&(t=t[e-1]),n.bridge=t||i.children[0].lastElementChild},L=function(t){for(var e=/^OBJECT|EMBED$/,i=t&&t.parentNode;i&&e.test(i.nodeName)&&i.parentNode;)i=i.parentNode;return i||null},H=function(){if(i){var t=b(i,A.zIndex),e=L(n.bridge);e&&(e.style.top=t.top+"px",e.style.left=t.left+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.zIndex=t.zIndex+1),n.ready===!0&&n.bridge&&n.bridge.setSize(t.width,t.height)}return this};I.prototype.on=function(t,e){var i,s,o,r={},l=a[this.id]&&a[this.id].handlers;if("string"==typeof t&&t)o=t.toLowerCase().split(/\s+/);else if("object"==typeof t&&t&&"undefined"==typeof e)for(i in t)t.hasOwnProperty(i)&&"string"==typeof i&&i&&"function"==typeof t[i]&&this.on(i,t[i]);if(o&&o.length){for(i=0,s=o.length;s>i;i++)t=o[i].replace(/^on/,""),r[t]=!0,l[t]||(l[t]=[]),l[t].push(e);r.noflash&&n.disabled&&W.call(this,"noflash",{}),r.wrongflash&&n.outdated&&W.call(this,"wrongflash",{flashVersion:n.version}),r.load&&n.ready&&W.call(this,"load",{flashVersion:n.version})}return this},I.prototype.off=function(t,e){var i,n,s,o,r,l=a[this.id]&&a[this.id].handlers;if(0===arguments.length)o=E(l);else if("string"==typeof t&&t)o=t.split(/\s+/);else if("object"==typeof t&&t&&"undefined"==typeof e)for(i in t)t.hasOwnProperty(i)&&"string"==typeof i&&i&&"function"==typeof t[i]&&this.off(i,t[i]);if(o&&o.length)for(i=0,n=o.length;n>i;i++)if(t=o[i].toLowerCase().replace(/^on/,""),r=l[t],r&&r.length)if(e)for(s=k(e,r);-1!==s;)r.splice(s,1),s=k(e,r,s);else l[t].length=0;return this},I.prototype.handlers=function(t){var e,i=null,n=a[this.id]&&a[this.id].handlers;if(n){if("string"==typeof t&&t)return n[t]?n[t].slice(0):null;i={};for(e in n)n.hasOwnProperty(e)&&n[e]&&(i[e]=n[e].slice(0))}return i};var R=function(t,e,i,n){var s=a[this.id]&&a[this.id].handlers[t];if(s&&s.length){var o,r,l,c=e||this;for(o=0,r=s.length;r>o;o++)l=s[o],e=c,"string"==typeof l&&"function"==typeof window[l]&&(l=window[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(e=l,l=l.handleEvent),"function"==typeof l&&D(l,e,i,n)}return this};I.prototype.clip=function(t){t=C(t);for(var e=0;e<t.length;e++)if(t.hasOwnProperty(e)&&t[e]&&1===t[e].nodeType){t[e].zcClippingId?-1===k(this.id,l[t[e].zcClippingId])&&l[t[e].zcClippingId].push(this.id):(t[e].zcClippingId="zcClippingId_"+r++,l[t[e].zcClippingId]=[this.id],A.autoActivate===!0&&m(t[e],"mouseover",f));var i=a[this.id].elements;-1===k(t[e],i)&&i.push(t[e])}return this},I.prototype.unclip=function(t){var e=a[this.id];if(e){var i,n=e.elements;t="undefined"==typeof t?n.slice(0):C(t);for(var s=t.length;s--;)if(t.hasOwnProperty(s)&&t[s]&&1===t[s].nodeType){for(i=0;-1!==(i=k(t[s],n,i));)n.splice(i,1);var o=l[t[s].zcClippingId];if(o){for(i=0;-1!==(i=k(this.id,o,i));)o.splice(i,1);0===o.length&&(A.autoActivate===!0&&g(t[s],"mouseover",f),delete t[s].zcClippingId)}}}return this},I.prototype.elements=function(){var t=a[this.id];return t&&t.elements?t.elements.slice(0):[]};var q=function(t){var e,i,n,s,o,r=[];if(t&&1===t.nodeType&&(e=t.zcClippingId)&&l.hasOwnProperty(e)&&(i=l[e],i&&i.length))for(n=0,s=i.length;s>n;n++)o=a[i[n]].instance,o&&o instanceof I&&r.push(o);return r};A.hoverClass="zeroclipboard-is-hover",A.activeClass="zeroclipboard-is-active",A.trustedOrigins=null,A.allowScriptAccess=null,A.useNoCache=!0,A.moviePath="ZeroClipboard.swf",I.detectFlashSupport=function(){return j("ZeroClipboard.detectFlashSupport",A.debug),M()},I.dispatch=function(t,e){if("string"==typeof t&&t){var n=t.toLowerCase().replace(/^on/,"");if(n)for(var s=i?q(i):P(),o=0,a=s.length;a>o;o++)W.call(s[o],n,e)}},I.prototype.setHandCursor=function(t){return j("ZeroClipboard.prototype.setHandCursor",A.debug),t="boolean"==typeof t?t:!!t,z(t),A.forceHandCursor=t,this},I.prototype.reposition=function(){return j("ZeroClipboard.prototype.reposition",A.debug),H()},I.prototype.receiveEvent=function(t,e){if(j("ZeroClipboard.prototype.receiveEvent",A.debug),"string"==typeof t&&t){var i=t.toLowerCase().replace(/^on/,"");i&&W.call(this,i,e)}},I.prototype.setCurrent=function(t){return j("ZeroClipboard.prototype.setCurrent",A.debug),I.activate(t),this},I.prototype.resetBridge=function(){return j("ZeroClipboard.prototype.resetBridge",A.debug),I.deactivate(),this},I.prototype.setTitle=function(t){if(j("ZeroClipboard.prototype.setTitle",A.debug),t=t||A.title||i&&i.getAttribute("title")){var e=L(n.bridge);e&&e.setAttribute("title",t)}return this},I.setDefaults=function(t){j("ZeroClipboard.setDefaults",A.debug),I.config(t)},I.prototype.addEventListener=function(t,e){return j("ZeroClipboard.prototype.addEventListener",A.debug),this.on(t,e)},I.prototype.removeEventListener=function(t,e){return j("ZeroClipboard.prototype.removeEventListener",A.debug),this.off(t,e)},I.prototype.ready=function(){return j("ZeroClipboard.prototype.ready",A.debug),n.ready===!0};var W=function(o,a){o=o.toLowerCase().replace(/^on/,"");var r=a&&a.flashVersion&&t(a.flashVersion)||null,l=i,c=!0;switch(o){case"load":if(r){if(!e(r))return void W.call(this,"onWrongFlash",{flashVersion:r});n.outdated=!1,n.ready=!0,n.version=r}break;case"wrongflash":r&&!e(r)&&(n.outdated=!0,n.ready=!1,n.version=r);break;case"mouseover":v(l,A.hoverClass);
break;case"mouseout":A.autoActivate===!0&&I.deactivate();break;case"mousedown":v(l,A.activeClass);break;case"mouseup":y(l,A.activeClass);break;case"datarequested":var h=l.getAttribute("data-clipboard-target"),u=h?document.getElementById(h):null;if(u){var d=u.value||u.textContent||u.innerText;d&&this.setText(d)}else{var p=l.getAttribute("data-clipboard-text");p&&this.setText(p)}c=!1;break;case"complete":F(s)}var f=l,m=[this,a];return R.call(this,o,f,m,c)};"function"==typeof define&&define.amd?define("clipboard",["require","exports","module"],function(t,e,i){return c=i&&i.id||null,I}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?(h=module.id||null,module.exports=I):window.ZeroClipboard=I}(),define("components/pop/url",["backbone","components/pop/base","text!components/pop/templates/url.html","core/utils","clipboard"],function(t,e,i,n,s){return e.extend({template:_.template(i),className:"popover left",events:{"click .js-btn-copy":"copy"},initialize:function(t){e.prototype.initialize.call(this,t),s.config({moviePath:window._global.url.static+"/vendor/plugin/ZeroClipboard.swf",trustedDomains:["*"],allowScriptAccess:"always"}),this.data=t.data},render:function(){var t=this;this.$el.html(this.template({url:this.data}));var e=new s(this.$(".js-btn-copy"));return e.on("load",function(i){i.on("complete",function(){n.successNotify("复制成功"),t.hide(),e.off("load")})}),this},positioning:function(){var t=this.target.offset(),e={height:this.target.outerHeight(),width:this.target.outerWidth()},i={height:this.$el.outerHeight(),width:this.$el.outerWidth()};this.$el.css({display:"block",left:t.left-i.width,top:t.top-i.height/2+e.height/2})},setData:function(t){this.data=t,this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.clearInput(),this.show()},copy:function(){this.hide()},clearInput:function(){this.$(".js-link-placeholder").val("")}})}),define("text!components/pop/templates/goods_url.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-goods-url">\n    <div class="popover-content">\n        <div class="">\n            <label>商品页链接</label>\n            <div class="input-append">\n                <input type="text" class="txt js-url-placeholder url-placeholder" readonly value="<%= url %>">\n                <button type="button" class="btn js-btn-copy" data-clipboard-text="<%= url %>">复制</button>\n            </div>\n            <div class="clearfix">\n                <label class="pull-left">直接弹出购买界面的链接</label>\n                <label class="pull-right">\n                    <a class="new-window" target="_blank" href="<%= _global.url.bbs %>/forum.php?mod=viewthread&tid=3290&extra=">怎么用?</a>\n                </label>\n            </div>\n            <div class="input-append">\n                <input type="text" class="txt js-url-placeholder url-placeholder" readonly value="<%= url %>&showsku=true">\n                <button type="button" class="btn js-btn-showsku-copy" data-clipboard-text="<%= url %>&showsku=true">复制</button>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/goods_url",["require","underscore","components/pop/base","text!components/pop/templates/goods_url.html","core/utils","clipboard"],function(t){var e=t("underscore"),i=t("components/pop/base"),n=t("text!components/pop/templates/goods_url.html"),s=t("core/utils"),o=t("clipboard");return i.extend({template:e.template(n),className:"popover left",events:{"click .js-btn-copy":"copy"},initialize:function(t){i.prototype.initialize.call(this,t),o.config({moviePath:window._global.url.static+"/vendor/plugin/ZeroClipboard.swf",trustedDomains:["*"],allowScriptAccess:"always"}),this.data=t.data},render:function(){var t=this;this.$el.html(this.template({url:this.data}));var e=new o(this.$(".js-btn-copy")),i=new o(this.$(".js-btn-showsku-copy"));return e.on("load",function(i){i.on("complete",function(){s.successNotify("复制成功"),t.hide(),e.off("load")})}),i.on("load",function(e){e.on("complete",function(){s.successNotify("复制成功"),t.hide(),i.off("load")})}),this},positioning:function(){var t=this.target.offset(),e={height:this.target.outerHeight(),width:this.target.outerWidth()},i={height:this.$el.outerHeight(),width:this.$el.outerWidth()};this.$el.css({display:"block",left:t.left-i.width,top:t.top-i.height/2+e.height/2})},setData:function(t){this.data=t,this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.clearInput(),this.show()},copy:function(){this.hide()},clearInput:function(){this.$(".js-link-placeholder").val("")}})}),define("text!components/pop/templates/text.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-text">\n    <div class="popover-content">\n        <form class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label">请设置模块名称：</label>\n                <div class="controls">\n                    <input type="text" class="text-placeholder js-text-placeholder">\n                </div>\n            </div>\n            <div class="form-actions">\n                <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定"> 确定</button>\n                <button type="reset" class="btn js-btn-cancel">取消</button>\n            </div>\n        </form>\n    </div>\n</div>\n'}),define("components/pop/text",["backbone","components/pop/base","text!components/pop/templates/text.html","core/utils","jqueryui"],function(t,e,i,n){return e.extend({template:_.template(i),className:"popover top",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keydown .js-text-placeholder":function(t){t.keyCode===n.keyCode.ENTER&&this.triggerCallback()}},positioning:function(){this.$el.show().position({of:this.target,my:"center bottom-5",at:"center top",collision:"none"}),this.$(".js-text-placeholder").focus()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.clearInput(),this.show()},triggerCallback:function(){this.callback($.trim(this.$(".js-text-placeholder").val())),this.hide()},clearInput:function(){this.$(".js-text-placeholder").val("")}})}),define("text!components/pop/templates/rename.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-rename">\n    <div class="popover-content">\n        <div class="form-horizontal">\n            <div class="control-group">\n                <div class="controls">\n                    <input type="text" class="js-rename-placeholder" maxlength="60" value="<%= url %>"/>\n                    <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n                    <button type="reset" class="btn js-btn-cancel">取消</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/rename",["backbone","components/pop/base","text!components/pop/templates/rename.html","core/utils"],function(t,e,i,n){return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keydown .js-rename-placeholder":function(t){t.keyCode===n.keyCode.ENTER&&this.triggerCallback()}},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){return this.$el.html(this.template({url:this.data})),this},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},setData:function(t){this.data=t,this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className||"popover left";this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.clearInput(),this.show()},triggerCallback:function(){this.callback(this.$(".js-rename-placeholder").val()),this.hide()},clearInput:function(){this.$(".js-link-placeholder").val("")}})}),define("text!components/pop/templates/change_category.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-category">\n    <div class="popover-content">\n        <div class="select-wrap loading" id="js-change-category">\n            <select data-placeholder=" " multiple="multiple" style="display:none;"></select>\n        </div>\n        <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定"> 确定</button>\n        <button type="reset" class="btn js-btn-cancel">取消</button>\n    </div>\n</div>\n'}),define("components/pop/change_category",["backbone","components/pop/base","text!components/pop/templates/change_category.html","core/utils"],function(t,e,i,n){return e.extend({template:_.template(i),className:"popover right popover-category-wrap",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keydown .js-text-placeholder":function(t){t.keyCode===n.keyCode.ENTER&&this.triggerCallback()}},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){return this.$el.html(this.template({url:this.data})),this},positioning:function(){var t=this.target.offset(),e={height:this.target.outerHeight(),width:this.target.outerWidth()},i={height:this.$el.outerHeight(),width:this.$el.outerWidth()};this.$el.css({display:"block",left:t.left+e.width-3,top:t.top-i.height/2+e.height/2})},setData:function(t){this.data=t,this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.clearInput(),this.show()},triggerCallback:function(){this.callback($.trim(this.$(".js-text-placeholder").val())),this.hide()},clearInput:function(){this.$(".js-link-placeholder").val("")}})}),define("text!components/pop/templates/help_notes.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner">\n    <div class="popover-content">\n        <%= content %>\n    </div>\n</div>\n'}),define("components/pop/help_notes",["backbone","components/pop/base","text!components/pop/templates/help_notes.html","core/utils","clipboard"],function(t,e,i,n,s){return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keydown .js-rename-placeholder":function(t){t.keyCode===n.keyCode.ENTER&&this.triggerCallback()}},initialize:function(t){e.prototype.initialize.call(this,t),s.config({moviePath:window._global.url.static+"/vendor/plugin/ZeroClipboard.swf",trustedDomains:["*"],allowScriptAccess:"always"}),this.data=t.data},render:function(){var t=this,e=this.target.parent().find(".js-notes-cont").html()||"暂时没有注释内容。";this.$el.html(this.template({content:e}));var i=new s(this.$(".js-help-notes-btn-copy"));return i.on("load",function(e){e.on("complete",function(){n.successNotify("复制成功"),t.hide(),i.off("load")})}),this},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},setData:function(t){this.data=t,this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className||"popover bottom";this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.clearInput(),this.show()},triggerCallback:function(){this.callback(),this.hide()},clearInput:function(){this.$(".js-link-placeholder").val("")}})}),define("text!components/pop/templates/memo.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-memo">\n    <div class="popover-content">\n        <form class="form-inline">\n            <input type="text" class="text-placeholder js-text-placeholder" placeholder="最多 <%= maxLength || 15 %> 个字符" maxlength="<%= maxLength || 15 %>" value="<%=remark %>">\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </form>\n    </div>\n</div>\n'}),define("components/pop/memo",["require","backbone","components/pop/base","text!components/pop/templates/memo.html","core/utils"],function(t){var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/memo.html"),n=t("core/utils");return e.extend({template:_.template(i),className:"popover left popover-memo",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keydown .js-text-placeholder":function(t){t.keyCode===n.keyCode.ENTER&&(this.triggerCallback(),t.preventDefault())}},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return this.data.maxLength||(this.data.maxLength=15),this.$el.html(this.template(this.data)),t.txt=t.$el.find(".js-text-placeholder"),t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left",o=t.data;this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.clearInput(),this.setData(o),this.positioning(),this.show()},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className,t.txt.val(t.data.remark).focus()},clearInput:function(){var t=this;t.txt.val("")},setData:function(t){this.data=t},triggerCallback:function(){var t=this,e=$.trim(t.txt.val()),i={remark:e};t.callback(i),t.hide()}})}),define("text!components/pop/templates/chosen.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-chosen">\n    <div class="popover-content">\n        <input type="hidden" class="js-select2 select2-offscreen" style="width: 242px;" tabindex="-1">\n        <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n        <button type="reset" class="btn js-btn-cancel">取消</button>\n    </div>\n</div>\n'}),function(t){"undefined"==typeof t.fn.each2&&t.extend(t.fn,{each2:function(e){for(var i=t([0]),n=-1,s=this.length;++n<s&&(i.context=i[0]=this[n])&&e.call(i[0],n,i)!==!1;);return this}})}(jQuery),function(t,e){function i(t){var e,i,n,s;if(!t||t.length<1)return t;for(e="",i=0,n=t.length;n>i;i++)s=t.charAt(i),e+=L[s]||s;return e}function n(t,e){for(var i=0,n=e.length;n>i;i+=1)if(o(t,e[i]))return i;return-1}function s(){var e=t(O);e.appendTo("body");var i={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),i}function o(t,i){return t===i?!0:t===e||i===e?!1:null===t||null===i?!1:t.constructor===String?t+""==i+"":i.constructor===String?i+""==t+"":!1}function a(e,i){var n,s,o;if(null===e||e.length<1)return[];for(n=e.split(i),s=0,o=n.length;o>s;s+=1)n[s]=t.trim(n[s]);return n}function r(t){return t.outerWidth(!1)-t.width()}function l(i){var n="keyup-change-value";i.on("keydown",function(){t.data(i,n)===e&&t.data(i,n,i.val())}),i.on("keyup",function(){var s=t.data(i,n);s!==e&&i.val()!==s&&(t.removeData(i,n),i.trigger("keyup-change"))})}function c(i){i.on("mousemove",function(i){var n=A;(n===e||n.x!==i.pageX||n.y!==i.pageY)&&t(i.target).trigger("mousemove-filtered",i)})}function h(t,i,n){n=n||e;var s;return function(){var e=arguments;window.clearTimeout(s),s=window.setTimeout(function(){i.apply(n,e)},t)}}function u(t){var e,i=!1;return function(){return i===!1&&(e=t(),i=!0),e}}function d(t,e){var i=h(t,function(t){e.trigger("scroll-debounced",t)});e.on("scroll",function(t){n(t.target,e.get())>=0&&i(t)})}function p(t){t[0]!==document.activeElement&&window.setTimeout(function(){var e,i=t[0],n=t.val().length;t.focus(),t.is(":visible")&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(n,n):i.createTextRange&&(e=i.createTextRange(),e.collapse(!1),e.select()))},0)}function f(e){e=t(e)[0];var i=0,n=0;if("selectionStart"in e)i=e.selectionStart,n=e.selectionEnd-i;else if("selection"in document){e.focus();var s=document.selection.createRange();n=document.selection.createRange().text.length,s.moveStart("character",-e.value.length),i=s.text.length-n}return{offset:i,length:n}}function m(t){t.preventDefault(),t.stopPropagation()}function g(t){t.preventDefault(),t.stopImmediatePropagation()}function v(e){if(!I){var i=e[0].currentStyle||window.getComputedStyle(e[0],null);I=t(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"}),I.attr("class","select2-sizer"),t("body").append(I)}return I.text(e.val()),I.width()}function y(e,i,n){var s,o,a=[];s=e.attr("class"),s&&(s=""+s,t(s.split(" ")).each2(function(){0===this.indexOf("select2-")&&a.push(this)})),s=i.attr("class"),s&&(s=""+s,t(s.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(o=n(this),o&&a.push(this))})),e.attr("class",a.join(" "))}function _(t,e,n,s){var o=i(t.toUpperCase()).indexOf(i(e.toUpperCase())),a=e.length;return 0>o?void n.push(s(t)):(n.push(s(t.substring(0,o))),n.push("<span class='select2-match'>"),n.push(s(t.substring(o,o+a))),n.push("</span>"),void n.push(s(t.substring(o+a,t.length))))}function b(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(t).replace(/[&<>"'\/\\]/g,function(t){return e[t]})}function w(i){var n,s=null,o=i.quietMillis||100,a=i.url,r=this;return function(l){window.clearTimeout(n),n=window.setTimeout(function(){var n=i.data,o=a,c=i.transport||t.fn.select2.ajaxDefaults.transport,h={type:i.type||"GET",cache:i.cache||!1,jsonpCallback:i.jsonpCallback||e,dataType:i.dataType||"json"},u=t.extend({},t.fn.select2.ajaxDefaults.params,h);n=n?n.call(r,l.term,l.page,l.context):null,o="function"==typeof o?o.call(r,l.term,l.page,l.context):o,s&&s.abort(),i.params&&(t.isFunction(i.params)?t.extend(u,i.params.call(r)):t.extend(u,i.params)),t.extend(u,{url:o,dataType:i.dataType,data:n,success:function(t){var e=i.results(t,l.page);l.callback(e)}}),s=c.call(r,u)},o)}}function x(e){var i,n,s=e,o=function(t){return""+t.text};t.isArray(s)&&(n=s,s={results:n}),t.isFunction(s)===!1&&(n=s,s=function(){return n});var a=s();return a.text&&(o=a.text,t.isFunction(o)||(i=a.text,o=function(t){return t[i]})),function(e){var i,n=e.term,a={results:[]};return""===n?void e.callback(s()):(i=function(s,a){var r,l;if(s=s[0],s.children){r={};for(l in s)s.hasOwnProperty(l)&&(r[l]=s[l]);r.children=[],t(s.children).each2(function(t,e){i(e,r.children)}),(r.children.length||e.matcher(n,o(r),s))&&a.push(r)}else e.matcher(n,o(s),s)&&a.push(s)},t(s().results).each2(function(t,e){i(e,a.results)}),void e.callback(a))}}function k(i){var n=t.isFunction(i);return function(s){var o=s.term,a={results:[]};t(n?i():i).each(function(){var t=this.text!==e,i=t?this.text:this;(""===o||s.matcher(o,i))&&a.results.push(t?this:{id:this,text:this})}),s.callback(a)}}function C(e,i){if(t.isFunction(e))return!0;if(!e)return!1;throw new Error(i+" must be a function or a falsy value")}function D(e){return t.isFunction(e)?e():e}function T(e){var i=0;return t.each(e,function(t,e){e.children?i+=T(e.children):i++}),i}function j(t,i,n,s){var a,r,l,c,h,u=t,d=!1;if(!s.createSearchChoice||!s.tokenSeparators||s.tokenSeparators.length<1)return e;for(;;){for(r=-1,l=0,c=s.tokenSeparators.length;c>l&&(h=s.tokenSeparators[l],r=t.indexOf(h),!(r>=0));l++);if(0>r)break;if(a=t.substring(0,r),t=t.substring(r+h.length),a.length>0&&(a=s.createSearchChoice.call(this,a,i),a!==e&&null!==a&&s.id(a)!==e&&null!==s.id(a))){for(d=!1,l=0,c=i.length;c>l;l++)if(o(s.id(a),s.id(i[l]))){d=!0;break}d||n(a)}}return u!==t?t:void 0}function S(e,i){var n=function(){};return n.prototype=new e,n.prototype.constructor=n,n.prototype.parent=e.prototype,n.prototype=t.extend(n.prototype,i),n}if(window.Select2===e){var $,N,E,F,M,I,z,P,A={x:0,y:0},$={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(t){switch(t=t.which?t.which:t){case $.LEFT:case $.RIGHT:case $.UP:case $.DOWN:return!0}return!1},isControl:function(t){var e=t.which;switch(e){case $.SHIFT:case $.CTRL:case $.ALT:return!0}return t.metaKey?!0:!1},isFunctionKey:function(t){return t=t.which?t.which:t,t>=112&&123>=t}},O="<div class='select2-measure-scrollbar'></div>",L={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z"};z=t(document),M=function(){var t=1;return function(){return t++}}(),z.on("mousemove",function(t){A.x=t.pageX,A.y=t.pageY}),N=S(Object,{bind:function(t){var e=this;return function(){t.apply(e,arguments)}},init:function(i){var n,o,a,r,h=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==e&&null!==i.element.data("select2")&&i.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+M()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=u(function(){return i.element.closest("body")}),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",i.element.attr("style")),this.container.css(D(i.containerCss)),this.container.addClass(D(i.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",m),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(D(i.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",m),this.results=n=this.container.find(h),this.search=o=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",m),c(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",h,this.bind(this.highlightUnderEvent)),d(80,this.results),this.dropdown.on("scroll-debounced",h,this.bind(this.loadMoreIfNeeded)),t(this.container).on("change",".select2-input",function(t){t.stopPropagation()}),t(this.dropdown).on("change",".select2-input",function(t){t.stopPropagation()}),t.fn.mousewheel&&n.mousewheel(function(t,e,i,s){var o=n.scrollTop();s>0&&0>=o-s?(n.scrollTop(0),m(t)):0>s&&n.get(0).scrollHeight-n.scrollTop()+s<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),m(t))}),l(o),o.on("keyup-change input paste",this.bind(this.updateResults)),o.on("focus",function(){o.addClass("select2-focused")}),o.on("blur",function(){o.removeClass("select2-focused")}),this.dropdown.on("mouseup",h,this.bind(function(e){t(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown",function(t){t.stopPropagation()}),t.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==i.maximumInputLength&&this.search.attr("maxlength",i.maximumInputLength);var a=i.element.prop("disabled");a===e&&(a=!1),this.enable(!a);var r=i.element.prop("readonly");r===e&&(r=!1),this.readonly(r),P=P||s(),this.autofocus=i.element.prop("autofocus"),i.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.nextSearchTerm=e},destroy:function(){var t=this.opts.element,i=t.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),i!==e&&(i.container.remove(),i.dropdown.remove(),t.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?t.attr({tabindex:this.elementTabIndex}):t.removeAttr("tabindex"),t.show())},optionToData:function(t){return t.is("option")?{id:t.prop("value"),text:t.text(),element:t.get(),css:t.attr("class"),disabled:t.prop("disabled"),locked:o(t.attr("locked"),"locked")||o(t.data("locked"),!0)}:t.is("optgroup")?{text:t.attr("label"),children:[],element:t.get(),css:t.attr("class")}:void 0},prepareOpts:function(i){var n,s,r,l,c=this;if(n=i.element,"select"===n.get(0).tagName.toLowerCase()&&(this.select=s=i.element),s&&t.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")
}),i=t.extend({},{populateResults:function(n,s,o){var a,r=this.opts.id;(a=function(n,s,l){var h,u,d,p,f,m,g,v,y,_;for(n=i.sortResults(n,s,o),h=0,u=n.length;u>h;h+=1)d=n[h],f=d.disabled===!0,p=!f&&r(d)!==e,m=d.children&&d.children.length>0,g=t("<li></li>"),g.addClass("select2-results-dept-"+l),g.addClass("select2-result"),g.addClass(p?"select2-result-selectable":"select2-result-unselectable"),f&&g.addClass("select2-disabled"),m&&g.addClass("select2-result-with-children"),g.addClass(c.opts.formatResultCssClass(d)),v=t(document.createElement("div")),v.addClass("select2-result-label"),_=i.formatResult(d,v,o,c.opts.escapeMarkup),_!==e&&v.html(_),g.append(v),m&&(y=t("<ul></ul>"),y.addClass("select2-result-sub"),a(d.children,y,l+1),g.append(y)),g.data("select2-data",d),s.append(g)})(s,n,0)}},t.fn.select2.defaults,i),"function"!=typeof i.id&&(r=i.id,i.id=function(t){return t[r]}),t.isArray(i.element.data("select2Tags"))){if("tags"in i)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+i.element.attr("id");i.tags=i.element.data("select2Tags")}if(s?(i.query=this.bind(function(t){var i,s,o,a={results:[],more:!1},r=t.term;o=function(e,i){var n;e.is("option")?t.matcher(r,e.text(),e)&&i.push(c.optionToData(e)):e.is("optgroup")&&(n=c.optionToData(e),e.children().each2(function(t,e){o(e,n.children)}),n.children.length>0&&i.push(n))},i=n.children(),this.getPlaceholder()!==e&&i.length>0&&(s=this.getPlaceholderOption(),s&&(i=i.not(s))),i.each2(function(t,e){o(e,a.results)}),t.callback(a)}),i.id=function(t){return t.id},i.formatResultCssClass=function(t){return t.css}):"query"in i||("ajax"in i?(l=i.element.data("ajax-url"),l&&l.length>0&&(i.ajax.url=l),i.query=w.call(i.element,i.ajax)):"data"in i?i.query=x(i.data):"tags"in i&&(i.query=k(i.tags),i.createSearchChoice===e&&(i.createSearchChoice=function(e){return{id:t.trim(e),text:t.trim(e)}}),i.initSelection===e&&(i.initSelection=function(e,n){var s=[];t(a(e.val(),i.separator)).each(function(){var e={id:this,text:this},n=i.tags;t.isFunction(n)&&(n=n()),t(n).each(function(){return o(this.id,e.id)?(e=this,!1):void 0}),s.push(e)}),n(s)}))),"function"!=typeof i.query)throw"query function not defined for Select2 "+i.element.attr("id");return i},monitorSource:function(){var t,i=this.opts.element;i.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var t,n=i.prop("disabled");n===e&&(n=!1),this.enable(!n);var t=i.prop("readonly");t===e&&(t=!1),this.readonly(t),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(D(this.opts.containerCssClass)),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(D(this.opts.dropdownCssClass))}),i.on("propertychange.select2 DOMAttrModified.select2",t),this.mutationCallback===e&&(this.mutationCallback=function(e){e.forEach(t)}),"undefined"!=typeof WebKitMutationObserver&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(this.mutationCallback),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var i=t.Event("select2-selecting",{val:this.id(e),object:e});return this.opts.element.trigger(i),!i.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=t.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var t=this._enabled&&!this._readonly,e=!t;return t===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",e),this.close(),this.enabledInterface=t,!0)},enable:function(t){t===e&&(t=!0),this._enabled!==t&&(this._enabled=t,this.opts.element.prop("disabled",!t),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(t){return t===e&&(t=!1),this._readonly===t?!1:(this._readonly=t,this.opts.element.prop("readonly",t),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,i,n,s,o=this.dropdown,a=this.container.offset(),r=this.container.outerHeight(!1),l=this.container.outerWidth(!1),c=o.outerHeight(!1),h=t(window).scrollLeft()+t(window).width(),u=t(window).scrollTop()+t(window).height(),d=a.top+r,p=a.left,f=u>=d+c,m=a.top-c>=this.body().scrollTop(),g=o.outerWidth(!1),v=h>=p+g,y=o.hasClass("select2-drop-above");this.opts.dropdownAutoWidth?(s=t(".select2-results",o)[0],o.addClass("select2-drop-auto-width"),o.css("width",""),g=o.outerWidth(!1)+(s.scrollHeight===s.clientHeight?0:P.width),g>l?l=g:g=l,v=h>=p+g):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(e=this.body().offset(),d-=e.top,p-=e.left),y?(i=!0,!m&&f&&(i=!1)):(i=!1,!f&&m&&(i=!0)),v||(p=a.left+l-g),i?(d=a.top-c,this.container.addClass("select2-drop-above"),o.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),o.removeClass("select2-drop-above")),n=t.extend({top:d,left:p,width:l},D(this.opts.dropdownCss)),o.css(n)},shouldOpen:function(){var e;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(e=t.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var e,i=this.containerId,n="scroll."+i,s="resize."+i,o="orientationchange."+i;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),e=t("#select2-drop-mask"),0==e.length&&(e=t(document.createElement("div")),e.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),e.hide(),e.appendTo(this.body()),e.on("mousedown touchstart click",function(e){var i,n=t("#select2-drop");n.length>0&&(i=n.data("select2"),i.opts.selectOnBlur&&i.selectHighlighted({noFocus:!0}),i.close({focus:!1}),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==e[0]&&this.dropdown.before(e),t("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),e.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){t(this).on(s+" "+n+" "+o,function(){a.positionDropdown()})})},close:function(){if(this.opened()){var e=this.containerId,i="scroll."+e,n="resize."+e,s="orientationchange."+e;this.container.parents().add(window).each(function(){t(this).off(i).off(n).off(s)}),this.clearDropdownAlignmentPreference(),t("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(t.Event("select2-close"))}},externalSearch:function(t){this.open(),this.search.val(t),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return D(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var e,i,n,s,o,a,r,l=this.results;if(i=this.highlight(),!(0>i)){if(0==i)return void l.scrollTop(0);e=this.findHighlightableChoices().find(".select2-result-label"),n=t(e[i]),s=n.offset().top+n.outerHeight(!0),i===e.length-1&&(r=l.find("li.select2-more-results"),r.length>0&&(s=r.offset().top+r.outerHeight(!0))),o=l.offset().top+l.outerHeight(!0),s>o&&l.scrollTop(l.scrollTop()+(s-o)),a=n.offset().top-l.offset().top,0>a&&"none"!=n.css("display")&&l.scrollTop(l.scrollTop()+a)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled)")},moveHighlight:function(e){for(var i=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<i.length;){n+=e;var s=t(i[n]);if(s.hasClass("select2-result-selectable")&&!s.hasClass("select2-disabled")&&!s.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var i,s,o=this.findHighlightableChoices();return 0===arguments.length?n(o.filter(".select2-highlighted")[0],o.get()):(e>=o.length&&(e=o.length-1),0>e&&(e=0),this.removeHighlight(),i=t(o[e]),i.addClass("select2-highlighted"),this.ensureHighlightVisible(),s=i.data("select2-data"),void(s&&this.opts.element.trigger({type:"select2-highlight",val:this.id(s),choice:s})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var i=t(e.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(i))}else 0==i.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t,e=this.results,i=e.find("li.select2-more-results"),n=this.resultsPage+1,s=this,o=this.search.val(),a=this.context;0!==i.length&&(t=i.offset().top-e.offset().top-e.height(),t<=this.opts.loadMorePadding&&(i.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:n,context:a,matcher:this.opts.matcher,callback:this.bind(function(t){s.opened()&&(s.opts.populateResults.call(this,e,t.results,{term:o,page:n,context:a}),s.postprocessResults(t,!1,!1),t.more===!0?(i.detach().appendTo(e).text(s.opts.formatLoadMore(n+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):i.remove(),s.positionDropdown(),s.resultsPage=n,s.context=t.context,this.opts.element.trigger({type:"select2-loaded",items:t}))})})))},tokenize:function(){},updateResults:function(i){function n(){c.removeClass("select2-active"),d.positionDropdown()}function s(t){h.html(t),n()}var a,r,l,c=this.search,h=this.results,u=this.opts,d=this,p=c.val(),f=t.data(this.container,"select2-last-term");if((i===!0||!f||!o(p,f))&&(t.data(this.container,"select2-last-term",p),i===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(a=this.data(),t.isArray(a)&&a.length>=m&&C(u.formatSelectionTooBig,"formatSelectionTooBig")))return void s("<li class='select2-selection-limit'>"+u.formatSelectionTooBig(m)+"</li>");if(c.val().length<u.minimumInputLength)return s(C(u.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+u.formatInputTooShort(c.val(),u.minimumInputLength)+"</li>":""),void(i&&this.showSearch&&this.showSearch(!0));if(u.maximumInputLength&&c.val().length>u.maximumInputLength)return void s(C(u.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+u.formatInputTooLong(c.val(),u.maximumInputLength)+"</li>":"");u.formatSearching&&0===this.findHighlightableChoices().length&&s("<li class='select2-searching'>"+u.formatSearching()+"</li>"),c.addClass("select2-active"),this.removeHighlight(),r=this.tokenize(),r!=e&&null!=r&&c.val(r),this.resultsPage=1,u.query({element:u.element,term:c.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(a){var r;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(this.context=a.context===e?null:a.context,this.opts.createSearchChoice&&""!==c.val()&&(r=this.opts.createSearchChoice.call(d,c.val(),a.results),r!==e&&null!==r&&d.id(r)!==e&&null!==d.id(r)&&0===t(a.results).filter(function(){return o(d.id(this),d.id(r))}).length&&a.results.unshift(r)),0===a.results.length&&C(u.formatNoMatches,"formatNoMatches"))return void s("<li class='select2-no-results'>"+u.formatNoMatches(c.val())+"</li>");h.empty(),d.opts.populateResults.call(this,h,a.results,{term:c.val(),page:this.resultsPage,context:null}),a.more===!0&&C(u.formatLoadMore,"formatLoadMore")&&(h.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(u.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(a,i),n(),this.opts.element.trigger({type:"select2-loaded",items:a})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(t){var e=this.highlight(),i=this.results.find(".select2-highlighted"),n=i.closest(".select2-result").data("select2-data");n?(this.highlight(e),this.onSelect(n,t)):t&&t.noFocus&&this.close()},getPlaceholder:function(){var t;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((t=this.getPlaceholderOption())!==e?t.text():e)},getPlaceholderOption:function(){if(this.select){var t=this.select.children().first();if(this.opts.placeholderOption!==e)return"first"===this.opts.placeholderOption&&t||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===t.text()&&""===t.val())return t}},initContainerWidth:function(){function i(){var i,n,s,o,a;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(i=this.opts.element.attr("style"),i!==e)for(n=i.split(";"),o=0,a=n.length;a>o;o+=1)if(s=n[o].replace(/\s/g,"").match(/[^-]width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==s&&s.length>=1)return s[1];return"resolve"===this.opts.width?(i=this.opts.element.css("width"),i.indexOf("%")>0?i:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return t.isFunction(this.opts.width)?this.opts.width():this.opts.width}var n=i.call(this);null!==n&&this.container.css("width",n)}}),E=S(N,{createContainer:function(){var e=t(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var i,n,s;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),i=this.search.get(0),i.createTextRange?(n=i.createTextRange(),n.collapse(!1),n.select()):i.setSelectionRange&&(s=this.search.val().length,i.setSelectionRange(s,s)),""===this.search.val()&&this.nextSearchTerm!=e&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(t.Event("select2-open"))},close:function(t){this.opened()&&(this.parent.close.apply(this,arguments),t=t||{focus:!0},this.focusser.removeAttr("disabled"),t.focus&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},destroy:function(){t("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var e,i=this.container,n=this.dropdown;this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=e=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+M()),t("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()){if(t.which===$.PAGE_UP||t.which===$.PAGE_DOWN)return void m(t);switch(t.which){case $.UP:case $.DOWN:return this.moveHighlight(t.which===$.UP?-1:1),void m(t);case $.ENTER:return this.selectHighlighted(),void m(t);case $.TAB:return void this.selectHighlighted({noFocus:!0});case $.ESC:return this.cancel(t),void m(t)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()&&t.which!==$.TAB&&!$.isControl(t)&&!$.isFunctionKey(t)&&t.which!==$.ESC){if(this.opts.openOnEnter===!1&&t.which===$.ENTER)return void m(t);if(t.which==$.DOWN||t.which==$.UP||t.which==$.ENTER&&this.opts.openOnEnter){if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return;return this.open(),void m(t)}return t.which==$.DELETE||t.which==$.BACKSPACE?(this.opts.allowClear&&this.clear(),void m(t)):void 0}})),l(this.focusser),this.focusser.on("keyup-change input",this.bind(function(t){if(this.opts.minimumResultsForSearch>=0){if(t.stopPropagation(),this.opened())return;this.open()}})),e.on("mousedown","abbr",this.bind(function(t){this.isInterfaceEnabled()&&(this.clear(),g(t),this.close(),this.selection.focus())})),e.on("mousedown",this.bind(function(e){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(e)})),n.on("mousedown",this.bind(function(){this.search.focus()})),e.on("focus",this.bind(function(t){m(t)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(t.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var i=this.selection.data("select2-data");if(i){var n=t.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var s=this.getPlaceholderOption();this.opts.element.val(s?s.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==e&&null!==i&&(t.updateSelection(i),t.close(),t.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var t;return this.getPlaceholder()?(t=this.getPlaceholderOption())!==e&&t.is(":selected")||""===this.opts.element.val()||this.opts.element.val()===e||null===this.opts.element.val():!1},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=t.find(":selected");e(i.optionToData(n))}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var s=i.val(),a=null;e.query({matcher:function(t,i,n){var r=o(s,e.id(n));return r&&(a=n),r},callback:t.isFunction(n)?function(){n(a)}:t.noop})}),e},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===e?e:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var t=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&t!==e){if(this.select&&this.getPlaceholderOption()===e)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(t)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(t,e,i){var n=0,s=this;if(this.findHighlightableChoices().each2(function(t,e){return o(s.id(e.data("select2-data")),s.opts.element.val())?(n=t,!1):void 0}),i!==!1&&this.highlight(e===!0&&n>=0?n:0),e===!0){var a=this.opts.minimumResultsForSearch;a>=0&&this.showSearch(T(t.results)>=a)}},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),t(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(t,e){if(this.triggerSelect(t)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(t)),this.updateSelection(t),this.opts.element.trigger({type:"select2-selected",val:this.id(t),choice:t}),this.nextSearchTerm=this.opts.nextSearchTerm(t,this.search.val()),this.close(),e&&e.noFocus||this.focusser.focus(),o(i,this.id(t))||this.triggerChange({added:t,removed:n})}},updateSelection:function(t){var i,n,s=this.selection.find(".select2-chosen");this.selection.data("select2-data",t),s.empty(),null!==t&&(i=this.opts.formatSelection(t,s,this.opts.escapeMarkup)),i!==e&&s.append(i),n=this.opts.formatSelectionCssClass(t,s),n!==e&&s.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==e&&this.container.addClass("select2-allowclear")},val:function(){var t,i=!1,n=null,s=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(t=arguments[0],arguments.length>1&&(i=arguments[1]),this.select)this.select.val(t).find(":selected").each2(function(t,e){return n=s.optionToData(e),!1}),this.updateSelection(n),this.setPlaceholder(),i&&this.triggerChange({added:n,removed:o});else{if(!t&&0!==t)return void this.clear(i);if(this.opts.initSelection===e)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(t),this.opts.initSelection(this.opts.element,function(t){s.opts.element.val(t?s.id(t):""),s.updateSelection(t),s.setPlaceholder(),i&&s.triggerChange({added:t,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(t){var i,n=!1;return 0===arguments.length?(i=this.selection.data("select2-data"),i==e&&(i=null),i):(arguments.length>1&&(n=arguments[1]),void(t?(i=this.data(),this.opts.element.val(t?this.id(t):""),this.updateSelection(t),n&&this.triggerChange({added:t,removed:i})):this.clear(n)))}}),F=S(N,{createContainer:function(){var e=t(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=[];t.find(":selected").each2(function(t,e){n.push(i.optionToData(e))}),e(n)}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var s=a(i.val(),e.separator),r=[];e.query({matcher:function(i,n,a){var l=t.grep(s,function(t){return o(t,e.id(a))}).length;return l&&r.push(a),l},callback:t.isFunction(n)?function(){for(var t=[],i=0;i<s.length;i++)for(var a=s[i],l=0;l<r.length;l++){var c=r[l];if(o(a,e.id(c))){t.push(c),r.splice(l,1);break}}n(t)}:t.noop})}),e},selectChoice:function(t){var e=this.container.find(".select2-search-choice-focus");e.length&&t&&t[0]==e[0]||(e.length&&this.opts.element.trigger("choice-deselected",e),e.removeClass("select2-search-choice-focus"),t&&t.length&&(this.close(),t.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",t)))},destroy:function(){t("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var e,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=e=this.container.find(i);var n=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){n.search[0].focus(),n.selectChoice(t(this))}),this.search.attr("id","s2id_autogen"+M()),t("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()){++this.keydowns;var i=e.find(".select2-search-choice-focus"),n=i.prev(".select2-search-choice:not(.select2-locked)"),s=i.next(".select2-search-choice:not(.select2-locked)"),o=f(this.search);if(i.length&&(t.which==$.LEFT||t.which==$.RIGHT||t.which==$.BACKSPACE||t.which==$.DELETE||t.which==$.ENTER)){var a=i;return t.which==$.LEFT&&n.length?a=n:t.which==$.RIGHT?a=s.length?s:null:t.which===$.BACKSPACE?(this.unselect(i.first()),this.search.width(10),a=n.length?n:s):t.which==$.DELETE?(this.unselect(i.first()),this.search.width(10),a=s.length?s:null):t.which==$.ENTER&&(a=null),this.selectChoice(a),m(t),void(a&&a.length||this.open())}if((t.which===$.BACKSPACE&&1==this.keydowns||t.which==$.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(e.find(".select2-search-choice:not(.select2-locked)").last()),void m(t);if(this.selectChoice(null),this.opened())switch(t.which){case $.UP:case $.DOWN:return this.moveHighlight(t.which===$.UP?-1:1),void m(t);case $.ENTER:return this.selectHighlighted(),void m(t);case $.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case $.ESC:return this.cancel(t),void m(t)}if(t.which!==$.TAB&&!$.isControl(t)&&!$.isFunctionKey(t)&&t.which!==$.BACKSPACE&&t.which!==$.ESC){if(t.which===$.ENTER){if(this.opts.openOnEnter===!1)return;if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return}this.open(),(t.which===$.PAGE_UP||t.which===$.PAGE_DOWN)&&m(t),t.which===$.ENTER&&m(t)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(t.Event("select2-blur"))})),this.container.on("click",i,this.bind(function(e){this.isInterfaceEnabled()&&(t(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",i,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==e&&null!==i&&(t.updateSelection(i),t.close(),t.clearSearch())})}},clearSearch:function(){var t=this.getPlaceholder(),i=this.getMaxSearchWidth();t!==e&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(t).addClass("select2-default"),this.search.width(i>0?i:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(t.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var i=[],s=[],o=this;t(e).each(function(){n(o.id(this),i)<0&&(i.push(o.id(this)),s.push(this))}),e=s,this.selection.find(".select2-search-choice").remove(),t(e).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var t=this.search.val();t=this.opts.tokenizer.call(this,t,this.data(),this.bind(this.onSelect),this.opts),null!=t&&t!=e&&(this.search.val(t),t.length>0&&this.open())},onSelect:function(t,e){this.triggerSelect(t)&&(this.addSelectedChoice(t),this.opts.element.trigger({type:"selected",val:this.id(t),choice:t}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(t,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:t}),e&&e.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(i){var n,s,o=!i.locked,a=t("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),r=t("<li class='select2-search-choice select2-locked'><div></div></li>"),l=o?a:r,c=this.id(i),h=this.getVal();n=this.opts.formatSelection(i,l.find("div"),this.opts.escapeMarkup),n!=e&&l.find("div").replaceWith("<div>"+n+"</div>"),s=this.opts.formatSelectionCssClass(i,l.find("div")),s!=e&&l.addClass(s),o&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(t(e.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(t(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),m(e))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",i),l.insertBefore(this.searchContainer),h.push(c),this.setVal(h)},unselect:function(t){var e,i,s=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";
if(e=t.data("select2-data")){for(;(i=n(this.id(e),s))>=0;)s.splice(i,1),this.setVal(s),this.select&&this.postprocessResults();t.remove(),this.opts.element.trigger({type:"removed",val:this.id(e),choice:e}),this.triggerChange({removed:e})}},postprocessResults:function(t,e,i){var s=this.getVal(),o=this.results.find(".select2-result"),a=this.results.find(".select2-result-with-children"),r=this;o.each2(function(t,e){var i=r.id(e.data("select2-data"));n(i,s)>=0&&(e.addClass("select2-selected"),e.find(".select2-result-selectable").addClass("select2-selected"))}),a.each2(function(t,e){e.is(".select2-result-selectable")||0!==e.find(".select2-result-selectable:not(.select2-selected)").length||e.addClass("select2-selected")}),-1==this.highlight()&&i!==!1&&r.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!t||t&&!t.more&&0===this.results.find(".select2-no-results").length)&&C(r.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+r.opts.formatNoMatches(r.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-r(this.search)},resizeSearch:function(){var t,e,i,n,s,o=r(this.search);t=v(this.search)+10,e=this.search.offset().left,i=this.selection.width(),n=this.selection.offset().left,s=i-(e-n)-o,t>s&&(s=i-o),40>s&&(s=i-o),0>=s&&(s=t),this.search.width(Math.floor(s))},getVal:function(){var t;return this.select?(t=this.select.val(),null===t?[]:t):(t=this.opts.element.val(),a(t,this.opts.separator))},setVal:function(e){var i;this.select?this.select.val(e):(i=[],t(e).each(function(){n(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},buildChangeDetails:function(t,e){for(var e=e.slice(0),t=t.slice(0),i=0;i<e.length;i++)for(var n=0;n<t.length;n++)o(this.opts.id(e[i]),this.opts.id(t[n]))&&(e.splice(i,1),i--,t.splice(n,1),n--);return{added:e,removed:t}},val:function(i,n){var s,o=this;if(0===arguments.length)return this.getVal();if(s=this.data(),s.length||(s=[]),!i&&0!==i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:s}));if(this.setVal(i),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(s,this.data()));else{if(this.opts.initSelection===e)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var i=t.map(e,o.id);o.setVal(i),o.updateSelection(e),o.clearSearch(),n&&o.triggerChange(o.buildChangeDetails(s,this.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(i.opts.id(t(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,i){var n,s,o=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return t(this).data("select2-data")}).get():(s=this.data(),e||(e=[]),n=t.map(e,function(t){return o.opts.id(t)}),this.setVal(n),this.updateSelection(e),this.clearSearch(),i&&this.triggerChange(this.buildChangeDetails(s,this.data())),void 0)}}),t.fn.select2=function(){var i,s,o,a,r,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],h=["opened","isFocused","container","dropdown"],u=["val","data"],d={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])i=0===l.length?{}:t.extend({},l[0]),i.element=t(this),"select"===i.element.get(0).tagName.toLowerCase()?r=i.element.prop("multiple"):(r=i.multiple||!1,"tags"in i&&(i.multiple=r=!0)),s=r?new F:new E,s.init(i);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(n(l[0],c)<0)throw"Unknown method: "+l[0];if(a=e,s=t(this).data("select2"),s===e)return;if(o=l[0],"container"===o?a=s.container:"dropdown"===o?a=s.dropdown:(d[o]&&(o=d[o]),a=s[o].apply(s,l.slice(1))),n(l[0],h)>=0||n(l[0],u)&&1==l.length)return!1}}),a===e?this:a},t.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(t,e,i,n){var s=[];return _(t.text,i.term,s,n),s.join("")},formatSelection:function(t,i,n){return t?n(t.text):e},sortResults:function(t){return t},formatResultCssClass:function(){return e},formatSelectionCssClass:function(){return e},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(t,e){var i=e-t.length;return"Please enter "+i+" more character"+(1==i?"":"s")},formatInputTooLong:function(t,e){var i=t.length-e;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(t){return"You can only select "+t+" item"+(1==t?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(t){return t.id},matcher:function(t,e){return i(""+e).toUpperCase().indexOf(i(""+t).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:j,escapeMarkup:b,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(t){return t},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return e}},t.fn.select2.ajaxDefaults={transport:t.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:w,local:x,tags:k},util:{debounce:h,markMatch:_,escapeMarkup:b,stripDiacritics:i},"class":{"abstract":N,single:E,multi:F}},t.extend(t.fn.select2.defaults,{formatNoMatches:function(){return"没有找到匹配项"},formatInputTooShort:function(t,e){var i=e-t.length;return"请再输入"+i+"个字符"},formatInputTooLong:function(t,e){var i=t.length-e;return"请删掉"+i+"个字符"},formatSelectionTooBig:function(t){return"你只能选择最多"+t+"项"},formatLoadMore:function(){return"加载结果中..."},formatSearching:function(){return"搜索中..."}})}}(jQuery),define("select2",["jquery"],function(){}),define("components/pop/chosen",["require","underscore","backbone","components/pop/base","text!components/pop/templates/chosen.html","core/utils","select2"],function(t){{var e=t("underscore"),i=(t("backbone"),t("components/pop/base")),n=t("text!components/pop/templates/chosen.html"),s=t("core/utils");t("select2")}return i.extend({template:e.template(n),className:"popover bottom popover-chosen-wrap",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){var e=this;i.prototype.initialize.call(e,t),window.NC.on("chosen:hide",function(){e.hide()}),e.data=t.data},render:function(){var t=this;return t.$el.html(t.template({})),t},reset:function(t){var e=this,i=t.callback,n=t.target,s=t.trigger,o=t.data;e.setCallback(i),e.setTarget(n),e.setTrigger(s),e.setData(o),e.positioning(),e.show()},positioning:function(){var t=this;t.$el.show().position({of:t.target,my:"center top+5",at:"center bottom",collision:"none"}),t.initSkuList();var e=t.getSelect2Tags();t.openSelect2(e)},getSelect2Tags:function(){var t,i=this,n=i._skuList[i.data.id];return t=!e.isUndefined(n)&&n.length>0?n:[],t=i.mergeBaseData(t)},mergeBaseData:function(t){var i=this,n=i.data.atomData;if(!n||e.isEmpty(n))return t;var s=[];return e(n).each(function(i){var n=e(t).findWhere({text:i.text});n||s.push(i)}),t=t.concat(s)},initSkuList:function(){var t=this;t._skuList||(t._skuList={},e.each(window._global.skuTree,function(i){var n=[];e.each(i.list,function(t){n.push({id:t._id,text:t.text})}),t._skuList[i._id]=n}))},openSelect2:function(t){var e=this;e._selectedData=[],e.$(".js-select2").off("select2-selecting change").select2({allowClear:!0,multiple:!0,placeholder:"添加规格值",tags:t}).on("select2-selecting",function(t){e.onSelect2Selecting(t)}).on("change",function(t){e.onSelect2Change(t)}).select2("open")},onSelect2Selecting:function(t){var i=this,n=t.object,o=$(t.target);-1===n.id||e.isString(n.id)&&n.id===n.text?($.post(window._global.url.www+"/showcase/WCGoodsSkuTree/skuLeaf.json",{text:n.text,_id:i.data.id},function(t){if(0===t.code){var e={id:Number(t.data),text:n.text};i._selectedData.push(e),o.select2("data",i._selectedData),o.select2("close")}else s.errorNotify(t.msg||"出错啦。")},"json"),t.preventDefault()):i._selectedData.push(n)},onSelect2Change:function(t){var i=this;if(t.removed){var n=e.find(i._selectedData,function(e){return e.id===t.removed.id});i._selectedData.splice(i._selectedData.indexOf(n),1)}},clearInput:function(){var t=this;t.txt.val("")},setData:function(t){var e=this;e.data=t},hide:function(){var t=this;return t.$(".js-select2").select2("data","").select2("destroy"),t._selectedData=[],t.$el.hide(),t.$el},triggerCallback:function(){var t=this;t.callback(t._selectedData),t.hide()}})}),define("text!components/pop/templates/template.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-template">\n    <div class="popover-content">\n        <ul class="popover-template-list js-popover-template-list clearfix">\n            <li class="js-popover-template-item pull-left">\n                <a href="<%= window._global.url.www %>/showcase/feature#create/3" class="template template-3"></a>\n                <p class="popover-template-item-title">\n                    <span>空白模板</span>\n                </p>\n            </li>\n            <li class="js-popover-template-item pull-left">\n                <a href="<%= window._global.url.www %>/showcase/feature#create/2" class="template template-2"></a>\n                <p class="popover-template-item-title">\n                    <span>新品推荐</span>\n                </p>\n            </li>\n            <li class="js-popover-template-item pull-left">\n                <a href="<%= window._global.url.www %>/showcase/feature#create/1" class="template template-1"></a>\n                <p class="popover-template-item-title">\n                    <span>新鲜资讯</span>\n                </p>\n            </li>\n            <li class="js-popover-template-item pull-left">\n                <a href="<%= window._global.url.www %>/showcase/feature#create/4" class="template template-4"></a>\n                <p class="popover-template-item-title">\n                    <span>全画幅场景</span>\n                    <a href="<%= _global.url.wap %>/showcase/feature?alias=uptq3k4k" class="pull-right" target="_blank">样板</a>\n                </p>\n            </li>\n            <li class="js-popover-template-item pull-left">\n                <a href="<%= window._global.url.www %>/showcase/feature#create/5" class="template template-5"></a>\n                <p class="popover-template-item-title">\n                    <span>期刊导航</span>\n                    <a href="<%= _global.url.wap %>/showcase/feature?alias=auauue1o" class="pull-right" target="_blank">样板</a>\n                </p>\n                <div class="new"></div>\n            </li>\n        </ul>\n    </div>\n</div>\n'}),define("components/pop/template",["require","backbone","components/pop/base","text!components/pop/templates/template.html","core/utils"],function(t){var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/template.html"),n=t("core/utils");return e.extend({template:_.template(i),className:function(){return this.options.className},initialize:function(t){e.prototype.initialize.call(this,t)},events:{"click .js-popover-template-item > a":"triggerCallback"},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left-bottom")?{of:t.target,my:"left top",at:"left bottom",collision:"none"}:-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left";this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(t){var e=$(t.target),i=e.parent();i.attr("href")!=window.location.href&&n.successNotify("正在获取数据，请稍后。",void 0,{fade:!1}),this.hide()}})}),define("text!components/pop/templates/categorys.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-memo">\n    <div class="popover-content">\n        <div class="category-cks">\n            <!-- <label><input class="category" name="category" type="checkbox" value="2" />女装</label>\n            <label><input class="category" name="category" type="checkbox" value="3" />男装</label>\n            <label><input class="category" name="category" type="checkbox" value="4" />美妆护肤</label>\n            <label><input class="category" name="category" type="checkbox" value="5" />男鞋</label>\n            <label><input class="category" name="category" type="checkbox" value="6" />箱包</label>\n            <label><input class="category" name="category" type="checkbox" value="7" />母婴玩具</label>\n            <label><input class="category" name="category" type="checkbox" value="8" />食品特产</label>\n            <label><input class="category" name="category" type="checkbox" value="9" />家居家纺</label>\n            <label><input class="category" name="category" type="checkbox" value="10" />创意礼品</label>\n            <label><input class="category" name="category" type="checkbox" value="11" />3C 数码</label>\n            <label><input class="category" name="category" type="checkbox" value="12" />女鞋</label>\n            <label><input class="category" name="category" type="checkbox" value="14" />男女内衣</label>\n            <label><input class="category" name="category" type="checkbox" value="15" />运动户外</label>\n            <label><input class="category" name="category" type="checkbox" value="16" />童装童鞋</label>\n            <label><input class="category" name="category" type="checkbox" value="17" />珠宝首饰</label>\n            <label><input class="category" name="category" type="checkbox" value="18" />日用百货</label>\n            <label><input class="category" name="category" type="checkbox" value="19" />汽车配件</label>\n            <label><input class="category" name="category" type="checkbox" value="20" />医药保健</label>\n            <label><input class="category" name="category" type="checkbox" value="21" />生活服务</label>\n            <label><input class="category" name="category" type="checkbox" value="22" />媒体服务</label>\n            <label><input class="category" name="category" type="checkbox" value="23" />装修建材</label>\n            <label><input class="category" name="category" type="checkbox" value="24" />服装配饰</label>\n            <label><input class="category" name="category" type="checkbox" value="25" />家用电器</label>\n            <label><input class="category" name="category" type="checkbox" value="1" />综合其它</label> -->\n        </div>\n        <% if(number != 1) { %>\n            <div class="category-actions">\n                <button type="button" class="btn js-btn-confirm" data-loading-text="确定">确定</button>\n                <span class="category-tip" style="color: #ff0000; font-size: 12px; margin-left: 20px">最多只能同时选择 <%= number %> 个分类。</span>\n            </div>\n        <% } %>\n    </div>\n</div>'}),define("text!components/pop/templates/category.html",[],function(){return'<label><input class="category" name="category" type="checkbox" value="<%= id %>" /><%= name %></label>'}),define("text!components/pop/templates/category_single.html",[],function(){return'<label><input class="category" name="category" type="radio" value="<%= id %>" /><%= name %></label>'}),define("components/pop/category",["require","backbone","jquery","components/pop/base","text!components/pop/templates/categorys.html","text!components/pop/templates/category.html","text!components/pop/templates/category_single.html","core/utils"],function(t){{var e=(t("backbone"),t("jquery")),i=t("components/pop/base"),n=t("text!components/pop/templates/categorys.html"),s=t("text!components/pop/templates/category.html"),o=t("text!components/pop/templates/category_single.html");t("core/utils")}return i.extend({template:_.template(n),className:"popover right",events:{"click .category":"clickCategory","click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){i.prototype.initialize.call(this,t),this.data=t.data||{},this.data.number=this.data.number||5,this.data.business=this.data.business||[],this.initTpls(),this.loadingCategory()},initTpls:function(){this.catTpl=_.template(s),this.catSingleTpl=_.template(o)},loadingCategory:function(){var t=this,i=window._global.url.www+"/account/team/category.json";e.ajax({url:i,type:"GET",dataType:"json"}).done(function(i){if(0==i.code){var n=i.data;n.forEach(function(i){var n;n=1==t.data.number?t.catSingleTpl(i):t.catTpl(i),e(".category-cks").append(n)}),t.$el.find(".category-cks").removeClass("loading"),t.setInitialValue(t.data)}})},setInitialValue:function(t){var i=t.business;e('input[name="category"]').filter(function(){var t=this;return i.some(function(e){return e.value==t.value})}).prop("checked",!0)},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.$el.find(".category-cks").addClass("loading"),t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setInitialValue(s),this.positioning(),this.show()},positioning:function(){var t=this;t.$el.show().position({of:this.target,my:"left center",at:"right center",collision:"none"})},clickCategory:function(){var t=this.data.number;return 1==t?void this.triggerCallback():void(e('input[name="category"]:checked').length>t-1?e('input[name="category').not(":checked").prop("disabled",!0):e('input[name="category').prop("disabled",!1))},triggerCallback:function(){var t=this,i=[];e('input[name="category"]:checked').each(function(){var t={text:e(this).parent().text(),value:e(this).val()};i.push(t)}),t.callback(i),t.hide()}})}),define("text!components/pop/templates/msgcat.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-text">\n    <div class="popover-content">\n        <form class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label">分类名称：</label>\n                <div class="controls">\n                    <input type="text" class="text-placeholder js-text-placeholder cat-text" vlaue="<%- text %>">\n                    <p class="help-block">应用于：对微信、微博消息添加分类</p>\n                </div>\n            </div>\n            <div class="form-actions">\n                <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定"> 确定</button>\n                <button type="reset" class="btn js-btn-cancel">取消</button>\n            </div>\n        </form>\n    </div>\n</div>\n'}),define("components/pop/msgcat",["require","backbone","jquery","components/pop/base","text!components/pop/templates/msgcat.html","core/utils"],function(t){{var e=(t("backbone"),t("jquery")),i=t("components/pop/base"),n=t("text!components/pop/templates/msgcat.html");t("core/utils")}return i.extend({template:_.template(n),className:"popover bottom",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){i.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return t.$el.html(t.template(t.data)),t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},setData:function(t){this.data=_.extend(this.data,t),this.render()},positioning:function(){var t=this;t.$el.show().position({of:this.target,my:"center top",at:"center bottom",collision:"none"})},triggerCallback:function(){var t=this;t.callback({text:e.trim(e(".cat-text").val())}),t.hide()}})}),define("text!components/pop/templates/tag.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-tag">\n    <div class="popover-content">\n        <form class="form-inline">\n            <input type="text" class="text-placeholder js-text-placeholder" placeholder="" maxlength="" value="<%- text %>">\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </form>\n    </div>\n</div>'}),define("components/pop/tag",["require","backbone","jquery","components/pop/base","text!components/pop/templates/tag.html","core/utils"],function(t){{var e=(t("backbone"),t("jquery")),i=t("components/pop/base"),n=t("text!components/pop/templates/tag.html");t("core/utils")}return i.extend({template:_.template(n),className:"popover bottom",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){i.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return t.$el.html(t.template(t.data)),t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},setData:function(t){this.data=_.extend(this.data,t),this.render()},positioning:function(){var t=this;t.$el.show().position({of:this.target,my:"center top",at:"center bottom",collision:"none"})},triggerCallback:function(){var t=this,i=e.trim(e(".popover-tag input").val());t.callback(i),t.hide()}})}),define("text!components/pop/templates/form_actions_confirm.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-confirm">\n    <div class="popover-content text-center">\n        <div class="form-inline">\n            <div><%= options.data || \'\' %></div>\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/form_actions_confirm",["require","backbone","components/pop/base","text!components/pop/templates/form_actions_confirm.html","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/form_actions_confirm.html");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},initialize:function(t){e.prototype.initialize.call(this,t)},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},render:function(){return this.$el.html(this.template({options:this.options})),this},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),-1!==e.indexOf("left")?t.$el.position({of:t.target,my:"right center",at:"left center",collision:"none"}):-1!==e.indexOf("bottom")?t.$el.position({of:t.target,my:"center top",at:"center bottom",collision:"none"}):-1!==e.indexOf("top")?($(".arrow",t.$el).css("margin-bottom",4),$(".popover-inner",t.$el).css("margin-bottom",4),t.$el.position({of:t.target,my:"center bottom",at:"center top",collision:"none"})):t.$el.position({of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left";this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this),this.hide()}})}),define("text!components/pop/templates/send_goods.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-send-goods">\n    <div class="popover-content">\n        <form class="form-horizontal">\n            <div class="control-group">\n                <label class="control-label">发货方式：</label>\n                <div class="controls">\n                    <label class="radio inline">\n                        <input type="radio" name="no_express" class="js-express" value="0"<% if (!_global.self_fetch) { %> checked<% } %>>需要物流\n                    </label>\n                    <label class="radio inline">\n                        <input type="radio" name="no_express" class="js-express" value="1"<% if (_global.self_fetch) { %> checked<% } %>>无需物流\n                    </label>\n                </div>\n            </div>\n            <div class="js-express-section">\n                <div class="control-group">\n                    <label class="control-label">物流公司：</label>\n                    <div class="controls">\n                        <select class="js-company">\n                            <option value="0">请选择一个物流公司</option>\n                            <% _.each(window._global.express, function(item, index) { %>\n                            <option value="<%= index %>"><%= item.name %></option>\n                            <% }) %>\n                        </select>\n                        <div class="help-block">\n                            标记发货后，10分钟内仅可修改一次物流信息\n                        </div>\n                    </div>\n                </div>\n                <div class="control-group">\n                    <label class="control-label">快递单号：</label>\n                    <div class="controls">\n                        <input type="text" class="input js-number">\n                    </div>\n                </div>\n            </div>\n            <div class="form-actions">\n                <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定"> 确定</button>\n                <button type="reset" class="btn js-btn-cancel">取消</button>\n            </div>\n        </form>\n    </div>\n</div>\n'}),define("components/pop/send_goods",["require","underscore","backbone","components/pop/base","text!components/pop/templates/send_goods.html","core/utils","select2","jqueryui"],function(t){{var e=t("underscore"),i=(t("backbone"),t("components/pop/base")),n=t("text!components/pop/templates/send_goods.html"),s=t("core/utils");t("select2")}return t("jqueryui"),i.extend({template:e.template(n),events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","change .js-express":"toggleForm","keydown .js-text-placeholder":function(t){t.keyCode===s.keyCode.ENTER&&this.triggerCallback()}},onRender:function(){$.extend($.fn.select2.defaults,{formatNoMatches:function(){return"找不到相关的物流公司~喵。"}}),this.$(".js-company").select2({placeholder:"请选择一个物流公司",width:220})},toggleForm:function(t){var e=$(t.target);1===+e.val()?this.$(".js-express-section").hide():this.$(".js-express-section").show()},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className+" popover-goods"},reset:function(t){var e=t.callback,i=t.target,n=t.trigger;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.clearInput(),this.show()},triggerCallback:function(){var t=$.trim(this.$(".js-number").val()),e=Number($.trim(this.$(".js-company").select2("val"))),i=this.$(".js-express:checked").val();if(1!==+i){if(!t)return void s.errorNotify("快递单号不能为空");if(!e)return void s.errorNotify("请选择一个物流公司")}this.callback({no:t,id:e,no_express:i}),this.hide()},clearInput:function(){this.$(".js-number").val("")}})}),define("text!components/pop/templates/note.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-delete">\n    <div class="popover-content text-center">\n        <div class="js-content">\n            <%= data %>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/note",["require","backbone","components/pop/base","text!components/pop/templates/note.html","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/note.html");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},initialize:function(t){e.prototype.initialize.call(this,t)},render:function(){return this.$el.html(this.template({data:this.options.data})),this},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover right";this.$(".js-content").html(t.data),this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this),this.hide()}})}),define("text!components/pop/templates/cube.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-memo">\n    <div class="popover-content">\n        <form class="form-inline">\n            <select class="js-cube-selection">\n                <% if (cols < 1) { %>\n                <option value="">最多支持4列，不能添加了。</option>\n                <% } %>\n                <% if (cols >= 1) { %>\n                <option value="1">图片占 1列</option>\n                <% } %>\n                <% if (cols >= 2) { %>\n                <option value="2">图片占 2列</option>\n                <% } %>\n                <% if (cols >= 3) { %>\n                <option value="3">图片占 3列</option>\n                <% } %>\n                <% if (cols >= 4) { %>\n                <option value="4">图片占 4列</option>\n                <% } %>\n            </select>\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </form>\n    </div>\n</div>\n'}),define("components/pop/cube",["require","backbone","components/pop/base","text!components/pop/templates/cube.html","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/cube.html");t("core/utils")}return e.extend({template:_.template(i),className:"popover bottom popover-cube",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this,e=this.data||{};return this.$el.html(this.template(e)),t.selection=t.$el.find(".js-cube-selection"),t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover bottom",o=t.data;this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(o),this.render(),this.positioning(),this.show()},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className
},setData:function(t){this.data=t},triggerCallback:function(){var t=this,e={show_method:t.selection.val()};_.isEmpty(e.show_method)||t.callback(e),t.hide()}})}),define("text!components/pop/templates/timer.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-timer">\n    <div class="popover-content">\n        <div class="form-inline">\n            上架时间：\n            <div class="input-append">\n                <input id="time-input-popover" name="publish_time" readonly class="for-post input-medium js-time-input" size="16" type="text">\n                <label for="time-input-popover" class="add-on"><i class="icon-calendar"></i></label>\n            </div>\n        </div>\n        <div class="text-center">\n            <a href="javascript:void(0);" class="btn btn-primary js-btn-confirm" data-loading-text="正在提交..."> 确 定 </a>\n            <a href="javascript:void(0);" class="btn js-btn-cancel"> 取 消 </a>\n        </div>\n    </div>\n</div>\n'}),function($){if($.ui.timepicker=$.ui.timepicker||{},!$.ui.timepicker.version){$.extend($.ui,{timepicker:{version:"1.2.2"}});var Timepicker=function(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:!1,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneIso8601:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"},$.extend(this._defaults,this.regional[""])};$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec"],control:null,setDefaults:function(t){return extendRemove(this._defaults,t||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}overrides={beforeShow:function(t,e){return $.isFunction(tp_inst._defaults.evnts.beforeShow)?tp_inst._defaults.evnts.beforeShow.call($input[0],t,e,tp_inst):void 0},onChangeMonthYear:function(t,e,i){tp_inst._updateDateTime(i),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],t,e,i,tp_inst)},onClose:function(t,e){tp_inst.timeDefined===!0&&""!==$input.val()&&tp_inst._updateDateTime(e),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],t,e,tp_inst)}};for(i in overrides)overrides.hasOwnProperty(i)&&(fns[i]=o[i]||null);if(tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(t){return t.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(t){return t.toUpperCase()}),"string"==typeof tp_inst._defaults.controlType?(void 0===$.fn[tp_inst._defaults.controlType]&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType,null===tp_inst._defaults.timezoneList){var timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"];tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(t){return"+0000"==t?"Z":t.substring(0,3)+":"+t.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}return tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour<tp_inst._defaults.hourMin?tp_inst._defaults.hourMin:tp_inst._defaults.hour>tp_inst._defaults.hourMax?tp_inst._defaults.hourMax:tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute<tp_inst._defaults.minuteMin?tp_inst._defaults.minuteMin:tp_inst._defaults.minute>tp_inst._defaults.minuteMax?tp_inst._defaults.minuteMax:tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second<tp_inst._defaults.secondMin?tp_inst._defaults.secondMin:tp_inst._defaults.second>tp_inst._defaults.secondMax?tp_inst._defaults.secondMax:tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec<tp_inst._defaults.millisecMin?tp_inst._defaults.millisecMin:tp_inst._defaults.millisec>tp_inst._defaults.millisecMax?tp_inst._defaults.millisecMax:tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")})),(0===tp_inst._defaults.minDate||0===tp_inst._defaults.minDateTime)&&(tp_inst._defaults.minDate=new Date),(0===tp_inst._defaults.maxDate||0===tp_inst._defaults.maxDateTime)&&(tp_inst._defaults.maxDate=new Date),void 0!==tp_inst._defaults.minDate&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),void 0!==tp_inst._defaults.minDateTime&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),void 0!==tp_inst._defaults.maxDate&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),void 0!==tp_inst._defaults.maxDateTime&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(t){var e=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(e),this._limitMinMaxDateTime(t,!1),this._injectTimePicker()},_parseTime:function(t,e){if(this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),e||!this._defaults.timeOnly){var i=$.datepicker._get(this.inst,"dateFormat");try{var n=parseDateTimeInternal(i,this._defaults.timeFormat,t,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!n.timeObj)return!1;$.extend(this,n.timeObj)}catch(s){return $.timepicker.log("Error parsing the date/time string: "+s+"\ndate/time string = "+t+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+i),!1}return!0}var o=$.datepicker.parseTime(this._defaults.timeFormat,t,this._defaults);return o?($.extend(this,o),!0):!1},_injectTimePicker:function(){var t=this.inst.dpDiv,e=this.inst.settings,i=this,n="",s="",o={},a={},r=null,l=0,c=0;if(0===t.find("div.ui-timepicker-div").length&&e.showTimepicker){var h=' style="display:none;"',u='<div class="ui-timepicker-div'+(e.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(e.showTime?"":h)+">"+e.timeText+'</dt><dd class="ui_tpicker_time"'+(e.showTime?"":h)+"></dd>";for(l=0,c=this.units.length;c>l;l++){if(n=this.units[l],s=n.substr(0,1).toUpperCase()+n.substr(1),o[n]=parseInt(e[n+"Max"]-(e[n+"Max"]-e[n+"Min"])%e["step"+s],10),a[n]=0,u+='<dt class="ui_tpicker_'+n+'_label"'+(e["show"+s]?"":h)+">"+e[n+"Text"]+'</dt><dd class="ui_tpicker_'+n+'"><div class="ui_tpicker_'+n+'_slider"'+(e["show"+s]?"":h)+"></div>",e["show"+s]&&e[n+"Grid"]>0){if(u+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',"hour"==n)for(var d=e[n+"Min"];d<=o[n];d+=parseInt(e[n+"Grid"],10)){a[n]++;var p=$.datepicker.formatTime(useAmpm(e.pickerTimeFormat||e.timeFormat)?"hht":"HH",{hour:d},e);u+='<td data-for="'+n+'">'+p+"</td>"}else for(var f=e[n+"Min"];f<=o[n];f+=parseInt(e[n+"Grid"],10))a[n]++,u+='<td data-for="'+n+'">'+(10>f?"0":"")+f+"</td>";u+="</tr></table></div>"}u+="</dd>"}u+='<dt class="ui_tpicker_timezone_label"'+(e.showTimezone?"":h)+">"+e.timezoneText+"</dt>",u+='<dd class="ui_tpicker_timezone" '+(e.showTimezone?"":h)+"></dd>",u+="</dl></div>";var m=$(u);for(e.timeOnly===!0&&(m.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+e.timeOnlyTitle+"</div></div>"),t.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),l=0,c=i.units.length;c>l;l++)n=i.units[l],s=n.substr(0,1).toUpperCase()+n.substr(1),i[n+"_slider"]=i.control.create(i,m.find(".ui_tpicker_"+n+"_slider"),n,i[n],e[n+"Min"],o[n],e["step"+s]),e["show"+s]&&e[n+"Grid"]>0&&(r=100*a[n]*e[n+"Grid"]/(o[n]-e[n+"Min"]),m.find(".ui_tpicker_"+n+" table").css({width:r+"%",marginLeft:e.isRTL?"0":r/(-2*a[n])+"%",marginRight:e.isRTL?r/(-2*a[n])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(){var t=$(this),e=t.html(),s=parseInt(e.replace(/[^0-9]/g),10),o=e.replace(/[^apm]/gi),a=t.data("for");"hour"==a&&(-1!==o.indexOf("p")&&12>s?s+=12:-1!==o.indexOf("a")&&12===s&&(s=0)),i.control.value(i,i[a+"_slider"],n,s),i._onTimeChange(),i._onSelectHandler()}).css({cursor:"pointer",width:100/a[n]+"%",textAlign:"center",overflow:"hidden"}));if(this.timezone_select=m.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(e.timezoneList,function(t){return $("<option />").val("object"==typeof t?t.value:t).text("object"==typeof t?t.label:t)})),"undefined"!=typeof this.timezone&&null!==this.timezone&&""!==this.timezone){var g=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12),v=$.timepicker.timeZoneOffsetString(g);v==this.timezone?selectLocalTimeZone(i):this.timezone_select.val(this.timezone)}else"undefined"!=typeof this.hour&&null!==this.hour&&""!==this.hour?this.timezone_select.val(e.defaultTimezone):selectLocalTimeZone(i);this.timezone_select.change(function(){i._defaults.useLocalTimezone=!1,i._onTimeChange(),i._onSelectHandler()});var y=t.find(".ui-datepicker-buttonpane");if(y.length?y.before(m):t.append(m),this.$timeObj=m.find(".ui_tpicker_time"),null!==this.inst){var _=this.timeDefined;this._onTimeChange(),this.timeDefined=_}if(this._defaults.addSliderAccess){var b=this._defaults.sliderAccessArgs,w=this._defaults.isRTL;b.isRTL=w,setTimeout(function(){if(0===m.find(".ui-slider-access").length){m.find(".ui-slider:visible").sliderAccess(b);var t=m.find(".ui-slider-access:eq(0)").outerWidth(!0);t&&m.find("table:visible").each(function(){var e=$(this),i=e.outerWidth(),n=e.css(w?"marginRight":"marginLeft").toString().replace("%",""),s=i-t,o=n*s/i+"%",a={width:s,marginRight:0,marginLeft:0};a[w?"marginRight":"marginLeft"]=o,e.css(a)})}},10)}}},_limitMinMaxDateTime:function(t,e){var i=this._defaults,n=new Date(t.selectedYear,t.selectedMonth,t.selectedDay);if(this._defaults.showTimepicker){if(null!==$.datepicker._get(t,"minDateTime")&&void 0!==$.datepicker._get(t,"minDateTime")&&n){var s=$.datepicker._get(t,"minDateTime"),o=new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0);(null===this.hourMinOriginal||null===this.minuteMinOriginal||null===this.secondMinOriginal||null===this.millisecMinOriginal)&&(this.hourMinOriginal=i.hourMin,this.minuteMinOriginal=i.minuteMin,this.secondMinOriginal=i.secondMin,this.millisecMinOriginal=i.millisecMin),t.settings.timeOnly||o.getTime()==n.getTime()?(this._defaults.hourMin=s.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=s.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=s.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=s.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if(null!==$.datepicker._get(t,"maxDateTime")&&void 0!==$.datepicker._get(t,"maxDateTime")&&n){var a=$.datepicker._get(t,"maxDateTime"),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);(null===this.hourMaxOriginal||null===this.minuteMaxOriginal||null===this.secondMaxOriginal)&&(this.hourMaxOriginal=i.hourMax,this.minuteMaxOriginal=i.minuteMax,this.secondMaxOriginal=i.secondMax,this.millisecMaxOriginal=i.millisecMax),t.settings.timeOnly||r.getTime()==n.getTime()?(this._defaults.hourMax=a.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=a.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=a.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=a.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(void 0!==e&&e===!0){var l=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),h=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),u=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:l}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour)),this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute)),this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:h}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:u}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec))}}},_onTimeChange:function(){var t=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,e=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,i=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,n=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,s=this.timezone_select?this.timezone_select.val():!1,o=this._defaults,a=o.pickerTimeFormat||o.timeFormat,r=o.pickerTimeSuffix||o.timeSuffix;"object"==typeof t&&(t=!1),"object"==typeof e&&(e=!1),"object"==typeof i&&(i=!1),"object"==typeof n&&(n=!1),"object"==typeof s&&(s=!1),t!==!1&&(t=parseInt(t,10)),e!==!1&&(e=parseInt(e,10)),i!==!1&&(i=parseInt(i,10)),n!==!1&&(n=parseInt(n,10));var l=o[12>t?"amNames":"pmNames"][0],c=t!=this.hour||e!=this.minute||i!=this.second||n!=this.millisec||this.ampm.length>0&&12>t!=(-1!==$.inArray(this.ampm.toUpperCase(),this.amNames))||null===this.timezone&&s!=this.defaultTimezone||null!==this.timezone&&s!=this.timezone;c&&(t!==!1&&(this.hour=t),e!==!1&&(this.minute=e),i!==!1&&(this.second=i),n!==!1&&(this.millisec=n),s!==!1&&(this.timezone=s),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),useAmpm(o.timeFormat)&&(this.ampm=l),this.formattedTime=$.datepicker.formatTime(o.timeFormat,this,o),this.$timeObj&&this.$timeObj.text(a===o.timeFormat?this.formattedTime+r:$.datepicker.formatTime(a,this,o)+r),this.timeDefined=!0,c&&this._updateDateTime()},_onSelectHandler:function(){var t=this._defaults.onSelect||this.inst.settings.onSelect,e=this.$input?this.$input[0]:null;t&&e&&t.apply(e,[this.formattedDateTime,this])},_updateDateTime:function(t){t=this.inst||t;var e=$.datepicker._daylightSavingAdjust(new Date(t.selectedYear,t.selectedMonth,t.selectedDay)),i=$.datepicker._get(t,"dateFormat"),n=$.datepicker._getFormatConfig(t),s=null!==e&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(i,null===e?new Date:e,n);var o=this.formattedDate;if(""===t.lastVal&&(t.currentYear=t.selectedYear,t.currentMonth=t.selectedMonth,t.currentDay=t.selectedDay),this._defaults.timeOnly===!0?o=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||s)&&(o+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=o,this._defaults.showTimepicker)if(this.$altInput&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(o);var a="",r=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,l=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;a=this._defaults.altFormat?$.datepicker.formatDate(this._defaults.altFormat,null===e?new Date:e,n):this.formattedDate,a&&(a+=r),a+=this._defaults.altTimeFormat?$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+l:this.formattedTime+l,this.$altInput.val(a)}else this.$input.val(o);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var t=$.datepicker._getInst(this.$input.get(0)),e=$.datepicker._get(t,"timepicker");if(e&&e._defaults.timeOnly&&t.input.val()!=t.lastVal)try{$.datepicker._updateDatepicker(t)}catch(i){$.timepicker.log(i)}}},_controls:{slider:{create:function(t,e,i,n,s,o,a){var r=t._defaults.isRTL;return e.prop("slide",null).slider({orientation:"horizontal",value:r?-1*n:n,min:r?-1*o:s,max:r?-1*s:o,step:a,slide:function(e,n){t.control.value(t,$(this),i,r?-1*n.value:n.value),t._onTimeChange()},stop:function(){t._onSelectHandler()}})},options:function(t,e,i,n,s){if(t._defaults.isRTL){if("string"==typeof n)return"min"==n||"max"==n?void 0!==s?e.slider(n,-1*s):Math.abs(e.slider(n)):e.slider(n);var o=n.min,a=n.max;return n.min=n.max=null,void 0!==o&&(n.max=-1*o),void 0!==a&&(n.min=-1*a),e.slider(n)}return"string"==typeof n&&void 0!==s?e.slider(n,s):e.slider(n)},value:function(t,e,i,n){return t._defaults.isRTL?void 0!==n?e.slider("value",-1*n):Math.abs(e.slider("value")):void 0!==n?e.slider("value",n):e.slider("value")}},select:{create:function(t,e,i,n,s,o,a){for(var r='<select class="ui-timepicker-select" data-unit="'+i+'" data-min="'+s+'" data-max="'+o+'" data-step="'+a+'">',l=t._defaults.pickerTimeFormat||t._defaults.timeFormat,c=s;o>=c;c+=a)r+='<option value="'+c+'"'+(c==n?" selected":"")+">",r+="hour"==i?$.datepicker.formatTime($.trim(l.replace(/[^ht ]/gi,"")),{hour:c},t._defaults):"millisec"==i||c>=10?c:"0"+c.toString(),r+="</option>";return r+="</select>",e.children("select").remove(),$(r).appendTo(e).change(function(){t._onTimeChange(),t._onSelectHandler()}),e},options:function(t,e,i,n,s){var o={},a=e.children("select");if("string"==typeof n){if(void 0===s)return a.data(n);o[n]=s}else o=n;return t.control.create(t,e,a.data("unit"),a.val(),o.min||a.data("min"),o.max||a.data("max"),o.step||a.data("step"))},value:function(t,e,i,n){var s=e.children("select");return void 0!==n?s.val(n):s.val()}}}}),$.fn.extend({timepicker:function(t){t=t||{};var e=Array.prototype.slice.call(arguments);return"object"==typeof t&&(e[0]=$.extend(t,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),e)})},datetimepicker:function(t){t=t||{};var e=arguments;return"string"==typeof t?"getDate"==t?$.fn.datepicker.apply($(this[0]),e):this.each(function(){var t=$(this);t.datepicker.apply(t,e)}):this.each(function(){var e=$(this);e.datepicker($.timepicker._newInst(e,t)._defaults)})}}),$.datepicker.parseDateTime=function(t,e,i,n,s){var o=parseDateTimeInternal(t,e,i,n,s);if(o.timeObj){var a=o.timeObj;o.date.setHours(a.hour,a.minute,a.second,a.millisec)}return o.date},$.datepicker.parseTime=function(t,e,i){var n=extendRemove(extendRemove({},$.timepicker._defaults),i||{}),s=function(t,e,i){var n,s=function(t,e){var i=[];return t&&$.merge(i,t),e&&$.merge(i,e),i=$.map(i,function(t){return t.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+i.join("|")+")?"},o=function(t){var e=t.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z|'.*?')/g),i={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(e)for(var n=0;n<e.length;n++)-1==i[e[n].toString().charAt(0)]&&(i[e[n].toString().charAt(0)]=n+1);return i},a="^"+t.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[lz]|'.*?')/g,function(t){var e=t.length;switch(t.charAt(0).toLowerCase()){case"h":return 1===e?"(\\d?\\d)":"(\\d{"+e+"})";case"m":return 1===e?"(\\d?\\d)":"(\\d{"+e+"})";case"s":return 1===e?"(\\d?\\d)":"(\\d{"+e+"})";case"l":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return s(i.amNames,i.pmNames);default:return"("+t.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(t){return"\\"+t})+")?"}}).replace(/\s/g,"\\s?")+i.timeSuffix+"$",r=o(t),l="";n=e.match(new RegExp(a,"i"));var c={hour:0,minute:0,second:0,millisec:0};if(n){if(-1!==r.t&&(void 0===n[r.t]||0===n[r.t].length?(l="",c.ampm=""):(l=-1!==$.inArray(n[r.t].toUpperCase(),i.amNames)?"AM":"PM",c.ampm=i["AM"==l?"amNames":"pmNames"][0])),-1!==r.h&&(c.hour="AM"==l&&"12"==n[r.h]?0:"PM"==l&&"12"!=n[r.h]?parseInt(n[r.h],10)+12:Number(n[r.h])),-1!==r.m&&(c.minute=Number(n[r.m])),-1!==r.s&&(c.second=Number(n[r.s])),-1!==r.l&&(c.millisec=Number(n[r.l])),-1!==r.z&&void 0!==n[r.z]){var h=n[r.z].toUpperCase();switch(h.length){case 1:h=i.timezoneIso8601?"Z":"+0000";break;case 5:i.timezoneIso8601&&(h="0000"==h.substring(1)?"Z":h.substring(0,3)+":"+h.substring(3));break;case 6:i.timezoneIso8601?"00:00"==h.substring(1)&&(h="Z"):h="Z"==h||"00:00"==h.substring(1)?"+0000":h.replace(/:/,"")}c.timezone=h}return c}return!1},o=function(t,e,i){try{var n=new Date("2012-01-01 "+e);if(isNaN(n.getTime())&&(n=new Date("2012-01-01T"+e),isNaN(n.getTime())&&(n=new Date("01/01/2012 "+e),isNaN(n.getTime()))))throw"Unable to parse time with native Date: "+e;return{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds(),millisec:n.getMilliseconds(),timezone:$.timepicker.timeZoneOffsetString(n)}}catch(o){try{return s(t,e,i)}catch(a){$.timepicker.log("Unable to parse \ntimeString: "+e+"\ntimeFormat: "+t)}}return!1};return"function"==typeof n.parse?n.parse(t,e,n):"loose"===n.parse?o(t,e,n):s(t,e,n)},$.datepicker.formatTime=function(t,e,i){i=i||{},i=$.extend({},$.timepicker._defaults,i),e=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},e);var n=t,s=i.amNames[0],o=parseInt(e.hour,10);return o>11&&(s=i.pmNames[0]),n=n.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[lz]|('.*?'|".*?"))/g,function(t){switch(t){case"HH":return("0"+o).slice(-2);case"H":return o;case"hh":return("0"+convert24to12(o)).slice(-2);case"h":return convert24to12(o);case"mm":return("0"+e.minute).slice(-2);case"m":return e.minute;case"ss":return("0"+e.second).slice(-2);case"s":return e.second;case"l":return("00"+e.millisec).slice(-3);case"z":return null===e.timezone?i.defaultTimezone:e.timezone;case"T":return s.charAt(0).toUpperCase();case"TT":return s.toUpperCase();case"t":return s.charAt(0).toLowerCase();case"tt":return s.toLowerCase();default:return t.replace(/\'/g,"")||"'"}}),n=$.trim(n)},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(t,e){var i=this._getInst($(t)[0]),n=this._get(i,"timepicker");n?(n._limitMinMaxDateTime(i,!0),i.inline=i.stay_open=!0,this._base_selectDate(t,e),i.inline=i.stay_open=!1,this._notifyChange(i),this._updateDatepicker(i)):this._base_selectDate(t,e)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(t){var e=t.input[0];if(!($.datepicker._curInst&&$.datepicker._curInst!=t&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=e||"boolean"==typeof t.stay_open&&t.stay_open!==!1)){this._base_updateDatepicker(t);var i=this._get(t,"timepicker");i&&i._addTimePicker(t)}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(t){var e=$.datepicker._getInst(t.target),i=$.datepicker._get(e,"timepicker");if(i&&$.datepicker._get(e,"constrainInput")){var n=useAmpm(i._defaults.timeFormat),s=$.datepicker._possibleChars($.datepicker._get(e,"dateFormat")),o=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,n?"APM":"").replace(/Tt/g,n?"AaPpMm":"").replace(/tT/g,n?"AaPpMm":"").replace(/T/g,n?"AP":"").replace(/tt/g,n?"apm":"").replace(/t/g,n?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(i._defaults.showTimezone?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+s,a=String.fromCharCode(void 0===t.charCode?t.keyCode:t.charCode);return t.ctrlKey||" ">a||!s||o.indexOf(a)>-1}return $.datepicker._base_doKeyPress(t)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(t){var e=this._get(t,"timepicker");if(e){var i=e._defaults.altField;if(i){var n=(e._defaults.altFormat||e._defaults.dateFormat,this._getDate(t)),s=$.datepicker._getFormatConfig(t),o="",a=e._defaults.altSeparator?e._defaults.altSeparator:e._defaults.separator,r=e._defaults.altTimeSuffix?e._defaults.altTimeSuffix:e._defaults.timeSuffix,l=null!==e._defaults.altTimeFormat?e._defaults.altTimeFormat:e._defaults.timeFormat;o+=$.datepicker.formatTime(l,e,e._defaults)+r,e._defaults.timeOnly||e._defaults.altFieldTimeOnly||null===n||(o=e._defaults.altFormat?$.datepicker.formatDate(e._defaults.altFormat,n,s)+a+o:e.formattedDate+a+o),$(i).val(o)}}else $.datepicker._base_updateAlternate(t)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(t){var e=$.datepicker._getInst(t.target),i=$.datepicker._get(e,"timepicker");if(i&&i._defaults.timeOnly&&e.input.val()!=e.lastVal)try{$.datepicker._updateDatepicker(e)}catch(n){$.timepicker.log(n)}return $.datepicker._base_doKeyUp(t)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(t){var e=this._getInst($(t)[0]),i=e.dpDiv;this._base_gotoToday(t);var n=this._get(e,"timepicker");selectLocalTimeZone(n);var s=new Date;this._setTime(e,s),$(".ui-datepicker-today",i).click()},$.datepicker._disableTimepickerDatepicker=function(t){var e=this._getInst(t);if(e){var i=this._get(e,"timepicker");$(t).datepicker("getDate"),i&&(i._defaults.showTimepicker=!1,i._updateDateTime(e))}},$.datepicker._enableTimepickerDatepicker=function(t){var e=this._getInst(t);if(e){var i=this._get(e,"timepicker");$(t).datepicker("getDate"),i&&(i._defaults.showTimepicker=!0,i._addTimePicker(e),i._updateDateTime(e))}},$.datepicker._setTime=function(t,e){var i=this._get(t,"timepicker");if(i){var n=i._defaults;i.hour=e?e.getHours():n.hour,i.minute=e?e.getMinutes():n.minute,i.second=e?e.getSeconds():n.second,i.millisec=e?e.getMilliseconds():n.millisec,i._limitMinMaxDateTime(t,!0),i._onTimeChange(),i._updateDateTime(t)}},$.datepicker._setTimeDatepicker=function(t,e,i){var n=this._getInst(t);if(n){var s=this._get(n,"timepicker");if(s){this._setDateFromField(n);var o;e&&("string"==typeof e?(s._parseTime(e,i),o=new Date,o.setHours(s.hour,s.minute,s.second,s.millisec)):o=new Date(e.getTime()),"Invalid Date"==o.toString()&&(o=void 0),this._setTime(n,o))}}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(t,e){var i=this._getInst(t);if(i){var n=e instanceof Date?new Date(e.getTime()):e;this._updateDatepicker(i),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(t,n,!0)}},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(t,e){var i=this._getInst(t);if(i){var n=this._get(i,"timepicker");if(n){void 0===i.lastVal&&this._setDateFromField(i,e);var s=this._getDate(i);return s&&n._parseTime($(t).val(),n.timeOnly)&&s.setHours(n.hour,n.minute,n.second,n.millisec),s}return this._base_getDateDatepicker(t,e)}},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(t,e,i){var n;try{n=this._base_parseDate(t,e,i)}catch(s){if(!(s.indexOf(":")>=0))throw s;n=this._base_parseDate(t,e.substring(0,e.length-(s.length-s.indexOf(":")-2)),i),$.timepicker.log("Error parsing the date string: "+s+"\ndate string = "+e+"\ndate format = "+t)}return n},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(t){var e=this._get(t,"timepicker");return e?(e._updateDateTime(t),e.$input.val()):this._base_formatDate(t)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(t,e,i){var n,s=this._getInst(t);if(!s)return null;var o=this._get(s,"timepicker");if(o){var a,r=null,l=null,c=null,h=o._defaults.evnts,u={};if("string"==typeof e){if("minDate"===e||"minDateTime"===e)r=i;else if("maxDate"===e||"maxDateTime"===e)l=i;else if("onSelect"===e)c=i;else if(h.hasOwnProperty(e)){if("undefined"==typeof i)return h[e];u[e]=i,n={}}}else if("object"==typeof e){e.minDate?r=e.minDate:e.minDateTime?r=e.minDateTime:e.maxDate?l=e.maxDate:e.maxDateTime&&(l=e.maxDateTime);for(a in h)h.hasOwnProperty(a)&&e[a]&&(u[a]=e[a])}for(a in u)u.hasOwnProperty(a)&&(h[a]=u[a],n||(n=$.extend({},e)),delete n[a]);if(n&&isEmptyObject(n))return;r?(r=0===r?new Date:new Date(r),o._defaults.minDate=r,o._defaults.minDateTime=r):l?(l=0===l?new Date:new Date(l),o._defaults.maxDate=l,o._defaults.maxDateTime=l):c&&(o._defaults.onSelect=c)}return void 0===i?this._base_optionDatepicker.call($.datepicker,t,e):this._base_optionDatepicker.call($.datepicker,t,n||e,i)};var isEmptyObject=function(t){var e;for(e in t)if(t.hasOwnProperty(t))return!1;return!0},extendRemove=function(t,e){$.extend(t,e);for(var i in e)(null===e[i]||void 0===e[i])&&(t[i]=e[i]);return t},useAmpm=function(t){return(-1!==t.indexOf("t")||-1!==t.indexOf("T"))&&-1!==t.indexOf("h")},convert24to12=function(t){return t>12&&(t-=12),0===t&&(t=12),String(t)},splitDateTime=function(t,e,i,n){try{var s=n&&n.separator?n.separator:$.timepicker._defaults.separator,o=n&&n.timeFormat?n.timeFormat:$.timepicker._defaults.timeFormat,a=o.split(s),r=a.length,l=e.split(s),c=l.length;
if(c>1)return[l.splice(0,c-r).join(s),l.splice(0,r).join(s)]}catch(h){if($.timepicker.log("Could not split the date from the time. Please check the following datetimepicker options\nthrown error: "+h+"\ndateTimeString"+e+"\ndateFormat = "+t+"\nseparator = "+n.separator+"\ntimeFormat = "+n.timeFormat),h.indexOf(":")>=0){{var u=e.length-(h.length-h.indexOf(":")-2);e.substring(u)}return[$.trim(e.substring(0,u)),$.trim(e.substring(u))]}throw h}return[e,""]},parseDateTimeInternal=function(t,e,i,n,s){var o,a=splitDateTime(t,i,n,s);if(o=$.datepicker._base_parseDate(t,a[0],n),""!==a[1]){var r=a[1],l=$.datepicker.parseTime(e,r,s);if(null===l)throw"Wrong time format";return{date:o,timeObj:l}}return{date:o}},selectLocalTimeZone=function(t,e){if(t&&t.timezone_select){t._defaults.useLocalTimezone=!0;var i="undefined"!=typeof e?e:new Date,n=$.timepicker.timeZoneOffsetString(i);t._defaults.timezoneIso8601&&(n=n.substring(0,3)+":"+n.substring(3)),t.timezone_select.val(n)}};$.timepicker=new Timepicker,$.timepicker.timeZoneOffsetString=function(t){var e=-1*t.getTimezoneOffset(),i=e%60,n=(e-i)/60;return(e>=0?"+":"-")+("0"+(101*n).toString()).slice(-2)+("0"+(101*i).toString()).slice(-2)},$.timepicker.timeRange=function(t,e,i){return $.timepicker.handleRange("timepicker",t,e,i)},$.timepicker.dateTimeRange=function(t,e,i){$.timepicker.dateRange(t,e,i,"datetimepicker")},$.timepicker.dateRange=function(t,e,i,n){n=n||"datepicker",$.timepicker.handleRange(n,t,e,i)},$.timepicker.handleRange=function(t,e,i,n){function s(t,n,s){n.val()&&new Date(e.val())>new Date(i.val())&&n.val(s)}function o(e,i,n){if($(e).val()){var s=$(e)[t].call($(e),"getDate");s.getTime&&$(i)[t].call($(i),"option",n,s)}}return $.fn[t].call(e,$.extend({onClose:function(t){s(this,i,t)},onSelect:function(){o(this,i,"minDate")}},n,n.start)),$.fn[t].call(i,$.extend({onClose:function(t){s(this,e,t)},onSelect:function(){o(this,e,"maxDate")}},n,n.end)),"timepicker"!=t&&n.reformat&&$([e,i]).each(function(){var e=$(this)[t].call($(this),"option","dateFormat"),i=new Date($(this).val());$(this).val()&&i&&$(this).val($.datepicker.formatDate(e,i))}),s(e,i,e.val()),o(e,i,"minDate"),o(i,e,"maxDate"),$([e.get(0),i.get(0)])},$.timepicker.log=function(t){window.console},$.timepicker.version="1.2.2"}}(jQuery),function(t){t.timepicker.regional["zh-CN"]={timeOnlyTitle:"选择时间",timeText:"时间",hourText:"小时",minuteText:"分钟",secondText:"秒钟",millisecText:"微秒",timezoneText:"时区",currentText:"当前时间",closeText:"确认",timeFormat:"HH:mm",amNames:["AM","A"],pmNames:["PM","P"],isRTL:!1},t.timepicker.setDefaults(t.timepicker.regional["zh-CN"])}(jQuery),define("datetimepicker",["jqueryui","jquery"],function(){}),define("components/pop/timer",["require","backbone","components/pop/base","text!components/pop/templates/timer.html","core/utils","datetimepicker"],function(t){var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/timer.html"),n=t("core/utils");return t("datetimepicker"),e.extend({template:_.template(i),events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},className:function(){return this.options.className},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){this.$el.html(this.template({}));var t=this.$(".js-time-input"),e=this.data.time;if(e>0){var i=n.getFullTime(new Date(e));t.val(i)}return t.datetimepicker({minDate:new Date}),$("#ui-datepicker-div").on("click",function(t){t.stopPropagation()}),this},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},setData:function(t){this.data=_.extend(this.data,t),this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover top",o=t.data;this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(o),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this,this.$(".js-time-input").datetimepicker("getDate")),this.hide()}})}),define("text!components/pop/templates/fans_tag.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-fans-tag">\n    <div class="popover-content">\n        <form class="form-inline loading">\n            <select data-placeholder="选择标签" multiple class="js-chosen-select">\n                <% for(var i = 0; i < tags.length; i ++){ %>\n                    <option value="<%= tags[i].id %>"\n                        <% if(tags[i].isSelected) {%>\n                            selected\n                        <% } %>\n                    ><%= tags[i].name %></option>\n                <% } %>\n            </select>\n            <div class="pull-right">\n                <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n                <button type="reset" class="btn js-btn-cancel">取消</button>\n            </div>\n            \n        </form>\n    </div>\n</div>'}),function(){var t,e,i,n,s,o={}.hasOwnProperty,a=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};n=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,i,n,s,o,a;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:this.escapeExpression(t.label),children:0,disabled:t.disabled}),o=t.childNodes,a=[],n=0,s=o.length;s>n;n++)i=o[n],a.push(this.add_option(i,e,t.disabled));return a},t.prototype.add_option=function(t,e,i){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:i===!0?i:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},t.prototype.escapeExpression=function(t){var e,i;return null==t||t===!1?"":/[\&\<\>\"\'\`]/.test(t)?(e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,t.replace(i,function(t){return e[t]||"&amp;"})):t},t}(),n.select_to_array=function(t){var e,i,s,o,a;for(i=new n,a=t.childNodes,s=0,o=a.length;o>s;s++)e=a[s],i.add_node(e);return i.parsed},e=function(){function t(e,i){this.form_field=e,this.options=null!=i?i:{},t.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return t.prototype.set_default_values=function(){var t=this;return this.click_test_action=function(e){return t.test_active_click(e)},this.activate_action=function(e){return t.activate_field(e)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},t.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},t.prototype.results_option_build=function(t){var e,i,n,s,o;for(e="",o=this.results_data,n=0,s=o.length;s>n;n++)i=o[n],e+=i.group?this.result_add_group(i):this.result_add_option(i),(null!=t?t.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(i.text));return e},t.prototype.result_add_option=function(t){var e,i;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),i=""!==t.style.cssText?' style="'+t.style+'"':"",'<li class="'+e.join(" ")+'"'+i+' data-option-array-index="'+t.array_index+'">'+t.search_text+"</li>"):""},t.prototype.result_add_group=function(t){return(t.search_match||t.group_match)&&t.active_options>0?'<li class="group-result">'+t.search_text+"</li>":""},t.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing?this.winnow_results():void 0},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.winnow_results=function(){var t,e,i,n,s,o,a,r,l,c,h,u,d;for(this.no_results_clear(),s=0,a=this.get_search_text(),t=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=this.search_contains?"":"^",i=new RegExp(n+t,"i"),c=new RegExp(t,"i"),d=this.results_data,h=0,u=d.length;u>h;h++)e=d[h],e.search_match=!1,o=null,this.include_option_in_results(e)&&(e.group&&(e.group_match=!1,e.active_options=0),null!=e.group_array_index&&this.results_data[e.group_array_index]&&(o=this.results_data[e.group_array_index],0===o.active_options&&o.search_match&&(s+=1),o.active_options+=1),(!e.group||this.group_search)&&(e.search_text=e.group?e.label:e.html,e.search_match=this.search_string_match(e.search_text,i),e.search_match&&!e.group&&(s+=1),e.search_match?(a.length&&(r=e.search_text.search(c),l=e.search_text.substr(0,r+a.length)+"</em>"+e.search_text.substr(r+a.length),e.search_text=l.substr(0,r)+"<em>"+l.substr(r)),null!=o&&(o.group_match=!0)):null!=e.group_array_index&&this.results_data[e.group_array_index].search_match&&(e.search_match=!0)));return this.result_clear_highlight(),1>s&&a.length?(this.update_results_content(""),this.no_results(a)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},t.prototype.search_string_match=function(t,e){var i,n,s,o;if(e.test(t))return!0;if(this.enable_split_word_search&&(t.indexOf(" ")>=0||0===t.indexOf("["))&&(n=t.replace(/\[|\]/g,"").split(" "),n.length))for(s=0,o=n.length;o>s;s++)if(i=n[s],e.test(i))return!0},t.prototype.choices_count=function(){var t,e,i,n;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,n=this.form_field.options,e=0,i=n.length;i>e;e++)t=n[e],t.selected&&(this.selected_option_count+=1);return this.selected_option_count},t.prototype.choices_click=function(t){return t.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},t.prototype.keyup_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),e){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(t.preventDefault(),this.results_showing)return this.result_select(t);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},t.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},t.prototype.include_option_in_results=function(t){return this.is_multiple&&!this.display_selected_options&&t.selected?!1:!this.display_disabled_options&&t.disabled?!1:t.empty?!1:!0},t.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results match",t}(),t=jQuery,t.fn.extend({chosen:function(n){return e.browser_is_supported()?this.each(function(){var e,s;e=t(this),s=e.data("chosen"),"destroy"===n&&s?s.destroy():s||e.data("chosen",new i(this,n))}):this}}),i=function(e){function i(){return s=i.__super__.constructor.apply(this,arguments)}return a(i,e),i.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},i.prototype.set_up_html=function(){var e,i;return e=["chosen-container"],e.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),i={"class":e.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(i.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=t("<div />",i),this.container.html(this.is_multiple?'<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>':'<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},i.prototype.register_observers=function(){var t=this;return this.container.bind("mousedown.chosen",function(e){t.container_mousedown(e)}),this.container.bind("mouseup.chosen",function(e){t.container_mouseup(e)}),this.container.bind("mouseenter.chosen",function(e){t.mouse_enter(e)}),this.container.bind("mouseleave.chosen",function(e){t.mouse_leave(e)}),this.search_results.bind("mouseup.chosen",function(e){t.search_results_mouseup(e)}),this.search_results.bind("mouseover.chosen",function(e){t.search_results_mouseover(e)}),this.search_results.bind("mouseout.chosen",function(e){t.search_results_mouseout(e)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(e){t.search_results_mousewheel(e)}),this.form_field_jq.bind("chosen:updated.chosen",function(e){t.results_update_field(e)}),this.form_field_jq.bind("chosen:activate.chosen",function(e){t.activate_field(e)}),this.form_field_jq.bind("chosen:open.chosen",function(e){t.container_mousedown(e)}),this.search_field.bind("blur.chosen",function(e){t.input_blur(e)}),this.search_field.bind("keyup.chosen",function(e){t.keyup_checker(e)}),this.search_field.bind("keydown.chosen",function(e){t.keydown_checker(e)}),this.search_field.bind("focus.chosen",function(e){t.input_focus(e)}),this.is_multiple?this.search_choices.bind("click.chosen",function(e){t.choices_click(e)}):this.container.bind("click.chosen",function(t){t.preventDefault()})},i.prototype.destroy=function(){return t(document).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},i.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},i.prototype.container_mousedown=function(e){return this.is_disabled||(e&&"mousedown"===e.type&&!this.results_showing&&e.preventDefault(),null!=e&&t(e.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!e||t(e.target)[0]!==this.selected_item[0]&&!t(e.target).parents("a.chosen-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(document).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},i.prototype.container_mouseup=function(t){return"ABBR"!==t.target.nodeName||this.is_disabled?void 0:this.results_reset(t)},i.prototype.search_results_mousewheel=function(t){var e,i,n;return e=-(null!=(i=t.originalEvent)?i.wheelDelta:void 0)||(null!=(n=t.originialEvent)?n.detail:void 0),null!=e?(t.preventDefault(),"DOMMouseScroll"===t.type&&(e=40*e),this.search_results.scrollTop(e+this.search_results.scrollTop())):void 0},i.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},i.prototype.close_field=function(){return t(document).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},i.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},i.prototype.test_active_click=function(e){return this.container.is(t(e.target).closest(".chosen-container"))?this.active_field=!0:this.close_field()},i.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=n.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},i.prototype.result_do_highlight=function(t){var e,i,n,s,o;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),n=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),s=n+o,i=this.result_highlight.position().top+this.search_results.scrollTop(),e=i+this.result_highlight.outerHeight(),e>=s)return this.search_results.scrollTop(e-n>0?e-n:0);if(o>i)return this.search_results.scrollTop(i)}},i.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},i.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},i.prototype.update_results_content=function(t){return this.search_results.html(t)},i.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},i.prototype.set_tab_index=function(){var t;return this.form_field.tabIndex?(t=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=t):void 0},i.prototype.set_label_behavior=function(){var e=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=t("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(t){return e.is_multiple?e.container_mousedown(t):e.activate_field()}):void 0},i.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},i.prototype.search_results_mouseup=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(e),this.search_field.focus()):void 0},i.prototype.search_results_mouseover=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},i.prototype.search_results_mouseout=function(e){return t(e.target).hasClass("active-result")?this.result_clear_highlight():void 0},i.prototype.choice_build=function(e){var i,n,s=this;return i=t("<li />",{"class":"search-choice"}).html("<span>"+e.html+"</span>"),e.disabled?i.addClass("search-choice-disabled"):(n=t("<a />",{"class":"search-choice-close","data-option-array-index":e.array_index}),n.bind("click.chosen",function(t){return s.choice_destroy_link_click(t)}),i.append(n)),this.search_container.before(i)},i.prototype.choice_destroy_link_click=function(e){return e.preventDefault(),e.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(t(e.target))},i.prototype.choice_destroy=function(t){return this.result_deselect(t[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()):void 0},i.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},i.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},i.prototype.result_select=function(t){var e,i,n;return this.result_highlight?(e=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?e.removeClass("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClass("result-selected"),n=this.result_single_selected[0].getAttribute("data-option-array-index"),this.results_data[n].selected=!1),this.result_single_selected=e),e.addClass("result-selected"),i=this.results_data[e[0].getAttribute("data-option-array-index")],i.selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):this.single_set_selected_text(i.text),(t.metaKey||t.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},i.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(t)},i.prototype.result_deselect=function(t){var e;return e=this.results_data[t],this.form_field.options[e.options_index].disabled?!1:(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},i.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},i.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":t("<div/>").text(t.trim(this.search_field.val())).html()},i.prototype.winnow_results_set_highlight=function(){var t,e;return e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),t=e.length?e.first():this.search_results.find(".active-result").first(),null!=t?this.result_do_highlight(t):void 0},i.prototype.no_results=function(e){var i;return i=t('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(e),this.search_results.append(i)},i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},i.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},i.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result"),t.length?this.result_do_highlight(t.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},i.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last(),t.length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},i.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},i.prototype.keydown_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),8!==e&&this.pending_backstroke&&this.clear_backstroke(),e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},i.prototype.search_field_scale=function(){var e,i,n,s,o,a,r,l,c;if(this.is_multiple){for(n=0,r=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",a=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,c=a.length;c>l;l++)s=a[l],o+=s+":"+this.search_field.css(s)+";";return e=t("<div />",{style:o}),e.text(this.search_field.val()),t("body").append(e),r=e.width()+25,e.remove(),i=this.container.outerWidth(),r>i-10&&(r=i-10),this.search_field.css({width:r+"px"})}},i}(e)}.call(this),define("chosen",["jquery"],function(){}),define("components/pop/fans_tag",["require","backbone","jquery","components/pop/base","text!components/pop/templates/fans_tag.html","core/utils","chosen"],function(t){var e=(t("backbone"),t("jquery")),i=t("components/pop/base"),n=t("text!components/pop/templates/fans_tag.html"),s=t("core/utils");return t("chosen"),i.extend({template:_.template(n),className:"popover bottom",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){i.prototype.initialize.call(this,t),this.data=t.data;var n=_global.url.www;this.loadTagsUrl=n+"/fans/tag/list.json",this.addTagUrl=n+"/fans/tag/item.json",this.tagsData={tags:[]},this.loadingTags();var s=this;this.$el.on("keyup",".chosen-choices input",function(t){var i=e(this).parents(".chosen-container").find(".no-results");return i.size()>0&&0===e(".add-new-tag",this.$el).size()&&i.append(' <div><a class="add-new-tag" href="javascript:void(0);">添加该标签</a></div>'),13===t.keyCode?(e(".add-new-tag",this.$el).click(),!1):void 0}),this.$el.on("click",".add-new-tag",function(){var t=e(this).parents(".chosen-container").find(".chosen-choices").find("input").val();s.createTag(t)})},createTag:function(t){var i=this;e.post(this.addTagUrl,{name:t}).success(function(e){if(0==e.code){var n=e.data;i.chosen.append("<option value="+n.tag_id+" selected>"+t+"</option>").trigger("chosen:updated"),s.successNotify("创建新标签成功")}else s.errorNotify(e.msg)}).fail(function(){s.errorNotify("操作失败")})},loadingTags:function(){var t=this;e.get(this.loadTagsUrl,{scope:"all"}).success(function(e){0==e.code?(t.tagsData.tags=e.data,t.render()):s.errorNotify(e.msg+"")}).fail(function(){s.errorNotify("数据获取失败")})},render:function(){var t=this,e=this.tagsData,i=this.data.get();return e.tags.forEach(function(t){t.isSelected=i.some(function(e){return t.id==e.id})}),t.$el.html(t.template(e)),this.chosen=this.$(".js-chosen-select").chosen({no_results_text:"木有这个标签哦"}),t
},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show(),this.$(".js-chosen-select").empty().trigger("chosen:updated"),this.loadingTags()},setData:function(t){this.data=_.extend(this.data,t),this.render()},positioning:function(){var t=this;t.$el.show().position({of:this.target,my:"center top",at:"center bottom",collision:"none"})},triggerCallback:function(){var t=this,i=[];this.chosen.find(":selected").each(function(){var t=e(this);i.push({text:t.text(),value:t.val()})}),t.callback(i),t.hide()}})}),define("text!components/pop/templates/fans_level.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-fans-tag">\n    <div class="popover-content">\n        <form class="form-inline loading">\n            <select data-placeholder="选择会员等级" class="js-chosen-select">\n                <% for(var i = 0; i < levels.length; i ++){ %>\n                    <option value="<%= levels[i].id %>"\n                        <% if(levels[i].isSelected) {%>\n                            selected\n                        <% } %>\n                    ><%= levels[i].name %></option>\n                <% } %>\n            </select>\n            <div class="pull-right">\n                <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n                <button type="reset" class="btn js-btn-cancel">取消</button>\n            </div>\n\n        </form>\n    </div>\n</div>\n'}),define("components/pop/fans_level",["require","underscore","jquery","components/pop/base","text!components/pop/templates/fans_level.html","core/utils","chosen"],function(t){var e=t("underscore"),i=t("jquery"),n=t("components/pop/base"),s=t("text!components/pop/templates/fans_level.html"),o=t("core/utils");return t("chosen"),n.extend({template:e.template(s),className:"popover bottom",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){n.prototype.initialize.call(this,t),this.data=t.data;var e=_global.url.www;this.loadLevelsUrl=e+"/weixin/autoreply/fansLevels.json",this.levelsData={levels:[]},this.loadingLevels()},loadingLevels:function(){var t=this;i.get(this.loadLevelsUrl).success(function(e){0===+e.code?(t.levelsData.levels=e.data,t.render()):o.errorNotify(e.msg+"")}).fail(function(){o.errorNotify("数据获取失败")})},render:function(){var t=this,e=this.levelsData,i=this.data.get();return e.levels.forEach(function(t){t.isSelected=t.id===i.id}),t.$el.html(t.template(e)),this.chosen=this.$(".js-chosen-select").chosen({no_results_text:"木有这个会员等级哦"}),t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show(),this.$(".js-chosen-select").empty().trigger("chosen:updated"),this.loadingLevels()},setData:function(t){this.data=e.extend(this.data,t),this.render()},positioning:function(){var t=this;t.$el.show().position({of:this.target,my:"center top",at:"center bottom",collision:"none"})},triggerCallback:function(){var t=this,e=[];this.chosen.find(":selected").each(function(){var t=i(this);e.push({text:t.text(),value:t.val()})}),t.callback(e),t.hide()}})}),define("text!components/pop/templates/qrcode.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-thin">\n    <div class="popover-content">             \n        <div class="controls">\n            <input class="js-txt" type="text" maxlength="15" class="span3 txt" placeholder="二维码名称" value="<%= name %>">\n        </div>\n           \n        <button class="js-btn-confirm btn btn-primary">确定</button>\n        <button class="js-btn-cancel btn">取消</button>        \n    </div>\n</div>'}),define("components/pop/qrcode",["backbone","components/pop/base","text!components/pop/templates/qrcode.html","core/utils"],function(t,e,i,n){return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback","keypress .js-txt":"enterSave"},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.el.className=t.options.className,t.txt=t.$el.find(".js-txt"),t},positioning:function(){var t=this;t.$el.show().position({of:t.target,my:"center top",at:"center bottom",collision:"none"}),t.txt.focus()},setData:function(t){this.data=_.extend(this.data,t),this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className;this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},enterSave:function(t){return t.which===n.keyCode.ENTER?(this.triggerCallback(),!1):void 0},triggerCallback:function(){var t=this,e=t.txt.val();return n.isEmpty(e)?(t.txt.focus(),!1):(t.setData({name:e}),t.callback.call(t,t.data),void t.hide())}})}),define("components/editor_v2/models/editor",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=(t("core/utils"),e.Model.extend({defaults:function(){return{charLimit:300,picLimit:9,topic:"在这里输入你想要说的话题",hasSign:!1,supportModules:{emotion:"Emotion",hyperlink:"Hyperlink",picture:"Picture",articles:"Articles",feature:"Feature",goods:"Goods",homepage:"Homepage",shortlink:"Shortlink",image:"Image",usercenter:"Usercenter",voice:"Voice",wx_emotion:"WxEmotion",music:"Music"},i18n:{text:"文本",hyperlink:"插入链接",picture:"图片",image:"图片",articles:"选择图文",feature:"微杂志及分类",goods:"商品及分类",homepage:"店铺主页",usercenter:"会员主页",voice:"语音",music:"音乐"},mode:"top-action",modules:["emotion","hyperlink"],flat:[],thumb:[],data:{type:"text",pics:[],content:""}}},initialize:function(){var t=this.toJSON();t.flat=t.modules.filter(function(e){return t.thumb.every(function(t){return t!=e})}),this.set(t,{silent:!0})}}));return i}),define("text!components/audio/1.0.0/templates/audio_list.html",[],function(){return'<div class="modal-header">\n    <a class="close" data-dismiss="modal">×</a>\n    <!-- 顶部tab -->\n    <ul class="module-nav modal-tab">\n        <li class="active"><a href="javascript:;" data-pane="audio" class="js-modal-tab">用过的语音</a> | </li>\n        <li><a href="javascript:;" data-pane="upload" class="js-modal-tab">新语音</a></li>\n    </ul>\n</div>\n<div class="tab-pane js-tab-pane-audio">\n    <div class="modal-body module-audio">\n        <table class="table">\n            <thead>\n                <tr>\n                    <th class="time"><span>语音</span></th>\n                    <th class="title"><span>文件名</span></th>\n                    <th class="time"><span>创建时间</span></th>\n                    <th class="opts">\n                        <form class="form-search search-box">\n                            <div class="input-append">\n                                <input class="input-small js-modal-search-input" type="text"/>\n                                <a href="javascript:void(0);" class="btn js-fetch-page js-modal-search" data-action-type="search">搜</a>\n                            </div>\n                        </form>\n                    </th>\n                </tr>\n            </thead>\n            <tbody class="module-body clearfix">\n\n            </tbody>\n        </table>\n    </div>\n    <div class="modal-footer">\n        <div class="modal-action pull-left">\n            <input type="button" class="btn btn-primary js-choose-audio hide" value="确定使用">\n        </div>\n        <div class="pagenavi js-pagenavi"></div>\n    </div>\n</div>\n<div class="tab-pane js-tab-pane-upload hide">\n    <div class="modal-body">\n        <div class="upload-local-img js-upload-local-audio"></div>\n    </div>\n    <div class="modal-footer">\n        <div class="modal-action pull-right">\n            <input type="button" class="btn btn-primary js-upload-audio" data-loading-text="上传中..." value="确定上传">\n        </div>\n    </div>\n</div>\n\n'}),define("text!components/audio/1.0.0/templates/audio.html",[],function(){return'<td>\n    <div class="td_cont">\n        <div class="voice-wrapper" data-voice-src="<%= window._global.url.imgqn %>/<%= attachment_url %>!8k.mp3">\n            <span class="voice-player">\n                <span class="arrow"></span>\n                <span class="stop">点击播放</span>\n                <span class="second"></span>\n                <i class="play" style="display:none;"></i>\n            </span>\n        </div>\n    </div>\n</td>\n<td class="title"><%= attachment_title %></td>\n<td class="time">\n    <span class="td_cont"><%= created_time %></span>\n</td>\n<td class="opts">\n    <div class="td_cont"><button class="btn btn-choose">选取</button></div>\n</td>'}),define("components/audio/1.0.0/views/audio_view",["require","marionette","text!components/audio/1.0.0/templates/audio.html"],function(t){var e=t("marionette"),i=t("text!components/audio/1.0.0/templates/audio.html");return e.ItemView.extend({template:_.template(i),tagName:"tr",events:{"click .btn-choose":"select"},collectionEvents:{clear:"clear"},className:function(){return this.model.collection.isSelected(this.model)?"selected":""},select:function(){this.model.collection.select(this.model)&&(this.$el.toggleClass("selected"),0==this.model.collection.multiChoose&&this.model.collection.trigger("audio:choose:success"))},clear:function(){this.$el.removeClass("selected")}})}),define("components/audio/1.0.0/views/audio_list_view",["require","marionette","text!components/audio/1.0.0/templates/audio_list.html","components/audio/1.0.0/views/audio_view","core/utils"],function(t){var e=t("marionette"),i=t("text!components/audio/1.0.0/templates/audio_list.html"),n=t("components/audio/1.0.0/views/audio_view"),s=t("core/utils");return e.CompositeView.extend({className:"modal fade hide",ui:{pagenavi:".js-pagenavi",chooseButton:".js-choose-audio",audio:".js-tab-pane-audio",upload:".js-tab-pane-upload",pane:".tab-pane",uploadButton:".js-upload-audio",searchInput:".js-modal-search-input"},events:{"click .fetch_page:not(.active)":"fetchPage","keydown .fetch_page.active":"fetchPage","click .js-choose-audio":"chooseAudio","click .js-update-audio-list":"update","click .js-modal-tab":"tab","click .js-upload-audio":"uploadAudio","click .js-modal-search":"update","keydown .js-modal-search-input":"search"},template:_.template(i),itemView:n,itemViewContainer:".module-body",collectionEvents:{sync:"renderPagenavi",select:"toggleChooseButton"},initialize:function(){this.update();var t=this;this.listenTo(window.NC,"audio:upload:always",function(){t.ui.uploadButton.button("reset")}),this.listenTo(this.collection,"audio:choose:success",this.chooseAudio),this.listenTo(window.NC,"audio:upload:success",this.update)},tab:function(t){var e=$(t.target),i=e.parent();i.addClass("active"),i.siblings("li").removeClass("active");var n=e.data("pane");this.ui.pane.addClass("hide"),this.ui[n].removeClass("hide")},fetchPage:function(t){t.stopPropagation();var e=$(t.target);return"keydown"==t.type&&t.keyCode!==s.keyCode.ENTER?!0:(this.collection._pageNumber="keydown"==t.type?+e.html():e.data("page-num"),t.preventDefault(),void this._fetch())},update:function(){this._fetch()},search:function(t){t.stopPropagation(),t.keyCode==s.keyCode.ENTER&&(this._fetch(),t.preventDefault())},_fetch:function(){this.$el.addClass("audio-loading");var t="";_.isFunction(this.ui.searchInput.val)&&(t=this.ui.searchInput.val());var e=s.addParameter(this.collection.url,{p:this.collection._pageNumber,keyword:t}),i=this;this.collection.fetch({url:e,success:function(){i.$el.removeClass("audio-loading")}})},chooseAudio:function(){var t=this.collection.getSelectedAudios();window.NC.trigger("audio:choose:success",t),this.clearAllSelected()},clearAllSelected:function(){this.collection.clearAllSelected(),this.$("li.selected").removeClass("selected")},renderPagenavi:function(){this.ui.pagenavi.html(this.collection.pagenavi)},toggleChooseButton:function(t){t>0?this.ui.chooseButton.removeClass("hide"):this.ui.chooseButton.addClass("hide")},uploadAudio:function(){this.ui.uploadButton.button("loading"),window.NC.trigger("audio:upload")}})}),define("components/audio/1.0.0/models/audio",["require","backbone"],function(t){var e=t("backbone");return e.Model.extend({})}),define("components/audio/1.0.0/collections/audios",["require","backbone","components/audio/1.0.0/models/audio","core/utils"],function(t){var e=t("backbone"),i=t("components/audio/1.0.0/models/audio"),n=t("core/utils");return e.Collection.extend({url:_global.url.www+"/showcase/attachment/alert.json?media_type=2&v=2",model:i,_pageNumber:1,parse:function(t){return 0==t.errcode?(this.pagenavi=t.data.page_view,t.data.data_list):void n.errorNotify(t.errmsg||"出错啦。")},_selectedModel:[],_idAttribute:"attachment_id",getSelectedAudios:function(){return this._selectedModel},select:function(t){var e=this;if(t.get("attachment_size")>1024*this.maxSize)return n.errorNotify("音频不能大于 "+this.maxSize+" KB"),!1;var i={};i[this._idAttribute]=t.get(this._idAttribute);var s=_.where(this._selectedModel,i);return s.length>0?_.each(s,function(t){e._selectedModel.splice(e._selectedModel.indexOf(t),1)}):this._selectedModel.push(t.attributes),this.trigger("select",this._selectedModel.length,t),!0},isSelected:function(t){var e={};e[this._idAttribute]=t.get(this._idAttribute);var i=_.where(this._selectedModel,e);return i.length>0?!0:!1},clearAllSelected:function(){this._selectedModel.length=0,this.trigger("clear"),this.trigger("select",0)}})}),define("text!components/audio/1.0.0/templates/audio_upload.html",[],function(){return'<div class="control-group">\n    <label class="control-label">本地语音：</label>\n    <div class="controls preview-container js-preview-upload-img">\n    </div>\n    <div class="controls">\n        <div class="control-action">\n            <div class="voice-preview hide">\n                <p class="name"></p>\n                <p class="size"></p>\n            </div>\n            <div class="voice-file-input">\n                <a href="javascript:;" class="js-fileupload-btn">添加语音...</a>\n                <input class="js-fileupload-input" type="file" name="upload_file" data-url="http://img.koudaitong.com/uploadmultiple?format=json">\n            </div>\n\n            <p class="help-desc">最大支持 <span class="js-max-size">2 MB</span> 以内的语音 (amr, mp3 格式)</p>\n        </div>\n    </div>\n</div>'}),define("components/audio/1.0.0/views/audio_upload",["require","marionette","text!components/audio/1.0.0/templates/audio_upload.html"],function(t){var e=t("marionette"),i=t("text!components/audio/1.0.0/templates/audio_upload.html");return e.CompositeView.extend({tagName:"form",className:"form-horizontal",template:_.template(i),events:{"change .js-fileupload-input":"selectFile"},initialize:function(){this.listenTo(window.NC,"audio:upload",this.upload)},appendBuffer:function(t,e){t.$(".fileinput-button").before(e)},appendHtml:function(t,e){t.isBuffering?(t.elBuffer.appendChild(e.el),t._bufferedChildren.push(e)):t.$(".fileinput-button").before(e.el)},selectFile:function(t){var e=t.target.files,i=this;_.each(e,function(t){var e=t.size/1024;e>i.collection.maxSize||t.name.match(/(\.|\/)(mp3|amr)$/i)&&i.previewAndAdd(t)})},previewAndAdd:function(t){var e=new FileReader,i=this;e.onload=function(e){i.collection.reset({src:e.target.result,file:t},{silent:!0}),i.$(".voice-preview").show(),i.$(".voice-preview .name").html(t.name),i.$(".voice-preview .size").html((t.size/1024).toFixed(1)+"kb")},this.$(".js-fileupload-btn").html("重新选择.."),e.readAsDataURL(t)},upload:function(){this.collection.sync({success:function(){this.render()}.bind(this)})}})}),define("components/audio/1.0.0/models/audio_upload",["require","backbone"],function(t){var e=t("backbone");return e.Model.extend({})}),define("components/audio/1.0.0/collections/audio_upload",["require","backbone","components/audio/1.0.0/models/audio_upload","core/utils","components/image/1.0.0/collections/image_upload"],function(t){var e=(t("backbone"),t("components/audio/1.0.0/models/audio_upload")),i=(t("core/utils"),t("components/image/1.0.0/collections/image_upload"));return i.extend({model:e,eventPrefix:"audio"})}),define("components/player/audio_player",["jquery"],function(t){var e=function(t,e){this.Audio.init(t,e)};e.prototype.Audio={init:function(e,i){var n=this;this.opts=i,this.$voice=t(e),this.$wrapper=this.$voice.parent(),this.$stop=this.$voice.find(i.stop),this.$play=this.$voice.find(i.play),this.$second=this.$voice.find(i.second),this.$duration=this.$voice.find(i.duration),this.stop_text="点击播放",this.voice_src=this.$wrapper.data("voice-src"),this.stopnow=null,n.appendDom()},appendDom:function(){var e=this,i=null,n=t('<div id="audio_wrapper"><audio id="audio_player" preload="" type="audio/mpeg" src=""></audio></div>').hide();0===t("#audio_wrapper").size()&&t("body").append(n);var s=e.voice_src;s.slice&&".amr"===s.slice(-4)&&(s+="!128k.mp3"),t("#audio_player").attr("src",s),i=t("#audio_player").get(0),e.voicePlay(i)},voicePlay:function(e){var i=this,n=this.opts,s="js-audio-playnow";t("."+s).find(n.play).hide(),t("."+s).find(n.stop).text(i.stop_text).show(),t("."+s).find(n.second).empty().hide(),t("."+s).find(n.duration).show(),t("."+s).removeClass(s),i.$voice.addClass(s),i.$stop.text("loading..."),i.playerEvent(e)},playerEvent:function(e){var i=this,n=null,s=!!navigator.userAgent.match(/AppleWebKit.*Mobile./),o=function(){i.$play.hide(),i.$stop.text(i.stop_text).show(),i.$second.empty().hide(),i.$duration.show(),i.$voice.removeClass("js-audio-playnow"),n&&clearInterval(n)};i.stopnow=!1,s&&e.play(),e.addEventListener("canplay",function(){i.stopnow||(s||(e.play(),i.$second.empty().show(),n&&clearInterval(n),i.$second.html("0/"+Math.floor(e.duration)),n=setInterval(function(){i.$second.html(Math.round(e.currentTime)+"/"+Math.floor(e.duration))},1e3)),i.$stop.text(i.stop_text).hide(),i.$play.show(),i.$duration.hide())}),e.addEventListener("ended",function(){o()}),e.addEventListener("error",function(){i.$stop.text("加载失败！")}),t("body").on("click",".js-audio-playnow",function(){i.stopnow=!0,e.pause(),o()})}},t.fn.extend({audioPlayer:function(i){return this.each(function(){var n=t.extend({stop:".stop",play:".play",second:".second",duration:".duration"},i);new e(this,n)})}}),t.getAudioDuration=function(e){var i,n,s,o;return n=new t.Deferred,void 0==e?(n.reject("音频地址为空"),n):(e.split&&(o=e.split("/"),o=o[o.length-1],-1===o.indexOf(".")&&(e+="!128k.mp3")),e.slice&&".amr"===e.slice(-4)&&(e+="!128k.mp3"),i=new Audio,i.src=e,i.oncanplay=function(){clearTimeout(s),n.resolve(i.duration)},i.onerror=function(){clearTimeout(s),n.reject("音频获取失败")},s=setTimeout(function(){n.reject("获取音频信息超时")},5e3),n)}}),define("components/audio/1.0.0/audio",["require","core/event","marionette","components/audio/1.0.0/views/audio_list_view","components/audio/1.0.0/collections/audios","components/audio/1.0.0/views/audio_upload","components/audio/1.0.0/collections/audio_upload","components/player/audio_player"],function(t){window.NC=t("core/event");var e=t("marionette"),i=t("components/audio/1.0.0/views/audio_list_view"),n=t("components/audio/1.0.0/collections/audios"),s=t("components/audio/1.0.0/views/audio_upload"),o=t("components/audio/1.0.0/collections/audio_upload");t("components/player/audio_player");var a=new e.Application;a.on("initialize:before",function(){$("body").append('<div class="js-audio-app-container"></div>'),a.addRegions({container:".js-audio-app-container",audioUpload:".js-upload-local-audio"})});var r=new n,l=new o;a.addInitializer(function(){a.container.show(new i({collection:r})),a.audioUpload.show(new s({collection:l}))}),a.on("show:audio",function(){a.container.$el.find(".modal").modal("show");var t,e=a._options.maxSize;void 0!=e&&(t=e%1024==0?e/1024+" MB":e+" KB",a.audioUpload.$el.find(".js-max-size").html(t));var i=a._options.tabIndex,n=a._options.onlyUpload,s=a.container.$el.find(".js-modal-tab");void 0!=i&&s.eq(i).click(),n===!0&&(a.container.$el.find(".module-nav li").eq(0).hide(),s.eq(1).click())});var c=function(t){a._options&&_.isFunction(a._options.callback)&&a._options.callback(t),a.container.$el.find(".modal").modal("hide")};return window.NC.on("audio:upload:success",c),window.NC.on("audio:download:success",c),window.NC.on("audio:choose:success",c),{initialize:function(t){this._initialized||(a.start(),this._initialized=!0),a._options=t,r.multiChoose=t.multiChoose===!1?!1:!0,t.maxSize?(l.maxSize=t.maxSize,r.maxSize=t.maxSize):(t.maxSize=l.maxSize=2048,r.maxSize=2048),$("body").off("click",".voice-player:not(.js-audio-playnow)"),$("body").on("click",".voice-player:not(.js-audio-playnow)",function(){$(this).audioPlayer()}),a.trigger("show:audio")}}}),define("text!components/editor_v2/templates/editor.html",[],function(){return'<% if(mode !== \'bottom-action\') { %>\n<div class="misc top clearfix">\n    <div class="content-actions clearfix">\n    <% for(var idx = 0, len = flat.length; idx < len; idx++) { %>\n\n        <% if (flat[idx] === \'emotion\') { %>\n        <div class="editor-module insert-emotion">\n            <a class="js-open-emotion" data-action-type="emotion" href="javascript:;">表情</a>\n            <div class="emotion-wrapper">\n                <ul class="emotion-container clearfix"></ul>\n            </div>\n        </div>\n\n        <% } else if (flat[idx] === \'wx_emotion\') { %>\n        <div class="editor-module insert-emotion">\n            <a class="js-open-wx_emotion" data-action-type="emotion" href="javascript:;">表情</a>\n            <div class="emotion-wrapper">\n                <ul class="emotion-container clearfix"></ul>\n            </div>\n        </div>\n\n        <% } else if (flat[idx] === \'shortlink\') { %>\n        <div class="editor-module insert-shortlink">\n            <div class="js-reply-menu dropup hover dropdown--right add-reply-menu">\n                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">\n                    <span class="dropdown-current">插入链接</span>\n                    <i class="caret"></i>\n                </a>\n                <ul class="dropdown-menu">\n                    <li><a data-link-type="Feature" class="js-open-shortlink" href="javascript:;">微杂志及分类</a></li>\n                    <li><a data-link-type="Goods" class="js-open-shortlink" href="javascript:;">商品及分类</a></li>\n                    <li><a data-link-type="Homepage" class="js-open-shortlink" href="javascript:;">店铺主页</a></li>\n                </ul>\n            </div>\n        </div>\n        \n        <% } else { %>\n        <div class="editor-module insert-<%- flat[idx] %>">\n            <a class="js-open-<%- flat[idx] %>" data-action-type="<%- flat[idx] %>" href="javascript:;"><%- i18n[flat[idx]] %></a>\n            <div class="<%- flat[idx] %>-wrapper"></div>\n        </div>\n        <% } %>\n\n    <% } %>\n\n        <% if (thumb.length > 0) { %>\n            <div class="editor-module">\n                <div class="js-reply-menu dropdown hover add-reply-menu">\n                    <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">\n                        <span class="dropdown-current">其它</span>\n                        <i class="caret"></i>\n                    </a>\n                    <ul class="dropdown-menu">\n                    <% for(var idx = 0, len = thumb.length; idx < len; idx++) { %>\n                        <li><a class="js-open-<%= thumb[idx] %>" data-action-type="<%= thumb[idx] %>" data-complex-mode="true" href="javascript:;"><%= i18n[thumb[idx]] %></a></li>\n                    <% } %>\n                    </ul>\n                </div>\n            </div>\n        <% } %>\n\n    </div>\n</div>\n<% } %>\n\n<div class="content-wrapper">\n    <textarea class="js-txta" cols="50" rows="4"></textarea>\n    <div class="js-picture-container picture-container"></div>\n    <div class="complex-backdrop"><div class="js-complex-content complex-content"></div></div>\n</div>\n\n<div class="misc clearfix">\n    <div class="content-actions clearfix">\n        <div class="word-counter pull-right">还能输入 <i><%=charLimit %></i> 个字</div>\n    </div>\n</div>\n\n\n'}),define("components/editor_v2/models/data",["require","backbone","core/utils"],function(t){var e=t("backbone"),i=t("core/utils"),n=e.Model.extend({defaults:function(){return{type:"text",pics:[],content:""}},i18n:{text:"文本",picture:"图片",articles:"图文",feature:"微杂志",category:"微杂志分类",goods:"商品",tag:"商品标签",homepage:"商家主页",usercenter:"会员主页",music:"音乐"},initialize:function(t,e){var i=this,n=e.modules||[],s="text,"+n.join(",");s=s.replace("goods","goods,tag").replace("feature","feature,category"),i.modules=s.split(",")},validate:function(t){var e=this,n=!0,s=t.type,o=e.modules;return o&&!_(o).contains(s)?(n="此编辑器不支持插入“"+e.i18n[s]+"”类型的内容。",i.errorNotify(n),n):void 0}});return n}),define("components/editor_v2/collections/picture_list",["require","backbone","components/wb_editor_v2/models/picture","core/utils"],function(t){var e=t("backbone"),i=t("components/wb_editor_v2/models/picture"),n=t("core/utils"),s=e.Collection.extend({model:i,initialize:function(t){var e=this;e.maxSize=t.maxSize||9},getPics:function(){var t=this;return t.pluck("attachment_url")},checkMaxsize:function(){var t=this,e=t.length<t.maxSize,i="最多支持 "+t.maxSize+" 张图片。";return e||n.errorNotify(i),e}});return s}),define("components/editor_v2/views/picture",["require","backbone","text!components/wb_editor_v2/templates/picture.html","core/utils"],function(t){var e=t("backbone"),i=t("text!components/wb_editor_v2/templates/picture.html"),n=(t("core/utils"),e.View.extend({template:_.template(i),tagName:"div",className:"picture-wrapper",events:{"click .js-delete-picture":"deletePicture"},initialize:function(){var t=this;t.listenTo(t.model,"change",t.render),t.listenTo(t.model,"destroy",t.remove)},render:function(){var t=this;return t.$el.html(t.template(t.model.toJSON())),this.$("img").load(function(){$(this).parents(".picture").removeClass("loading").off("load")}),t},deletePicture:function(){var t=this,e=t.model.collection;t.model.destroy(),e.trigger("update:picture_list")}}));return n}),define("text!components/music/1.0.0/templates/layout.html",[],function(){return'<div class="modal-header">\n    <a class="close" data-dismiss="modal">×</a>\n    <h3 class="title">音乐素材</h3>\n</div>\n<div class="modal-body js-detail-container">\n\n</div>\n<div class="modal-footer">\n    <a href="javascript:;" class="btn btn-primary js-save-data" data-loading-text="确 定...">确 定</a>\n</div>\n'}),define("components/validation/validate",["backbone","backboneValidate"],function(t){_.extend(t.Validation.patterns,{mobile:/^1\d{10}$/,integer:/^[1-9]\d*$/}),_.extend(t.Validation.messages,{mobile:"请输入正确的手机号码"}),_.extend(t.Validation.callbacks,{valid:function(t,e,i){e.indexOf(".")>=0&&(e=e.split(".").join("_"));var n,s;return n=t.$("["+i+"="+e+"]"),0===n.length?(n=t.$("["+i+'^="'+e+'"]'),s=n.parents(".control-group").first()):s=n.parents(".control-group").first(),s.removeClass("error"),"tooltip"!==n.data("error-style")?"inline"===n.data("error-style")?s.find(".help-inline.error-message").remove():s.find(".help-block.error-message").remove():n.data("tooltip")?n.tooltip("hide"):void 0},invalid:function(t,e,i,n){e.indexOf(".")>=0&&(e=e.split(".").join("_"));var s,o,a,r;return s=t.$("["+n+"="+e+"]"),0===s.length?(s=t.$("["+n+'^="'+e+'"]'),o=s.parents(".control-group").first()):o=s.parents(".control-group").first(),o.addClass("error"),"tooltip"===s.data("error-style")?(a=s.data("tooltip-position")||"right",s.tooltip({placement:a,trigger:"manual",title:i}),s.tooltip("show")):"inline"===s.data("error-style")?(0===o.find(".help-inline").length&&o.find(".controls").append('<span class="help-inline error-message"></span>'),r=o.find(".help-inline"),r.text(i)):"block"===s.data("error-style")?(0===o.find(".help-block").length&&o.append('<p class="help-block error-message"></p>'),r=o.find(".help-block"),r.text(i)):(0===o.find(".help-block").length&&o.find(".controls").append('<p class="help-block error-message"></p>'),r=o.find(".help-block"),r.text(i))}})}),define("text!components/music/1.0.0/templates/thumb.html",[],function(){return'<% if (thumb_attachment_url) { %>\n    <img src="<%= fullfillImage(thumb_attachment_url) %>" width="100" height="100">\n<% } else { %>\n    <a class="js-choose-thumb" href="javascript:;">+添加缩略图</a>\n<% } %>'}),define("components/music/1.0.0/views/thumb",["require","marionette","components/image/1.0.0/image","text!components/music/1.0.0/templates/thumb.html","core/utils"],function(t){var e=t("marionette"),i=t("components/image/1.0.0/image"),n=t("text!components/music/1.0.0/templates/thumb.html"),s=t("core/utils");return e.ItemView.extend({template:_.template(n),className:"msg-music-thumb-inner",modelEvents:{"change thumb_attachment_id":"render"},events:{"click .js-choose-thumb":"chooseThumb"},templateHelpers:{fullfillImage:function(t){return s.fullfillImage(t)}},chooseThumb:function(){i.initialize({multiChoose:!1,maxSize:128,callback:function(t){t=t[0],this.model.set({thumb_attachment_id:t.attachment_id,thumb_attachment_url:t.thumb_url})}.bind(this)})}})}),define("text!components/music/1.0.0/templates/form.html",[],function(){return'<div class="msg-music clearfix">\n    <div class="pull-left msg-music-thumb">\n\n    </div>\n    <div class="pull-left msg-music-input">\n        <div class="control-group">\n            <input type="text" name="title" placeholder="音乐标题" maxLength="20" value="<%= title %>">\n        </div>\n        <div class="control-group">\n            <textarea name="description" cols="30" rows="2" placeholder="音乐描述" maxLength="50"><%= description %></textarea>\n        </div>\n    </div>\n</div>\n<div class="control-group">\n    <div class="controls">\n        <input type="hidden" name="thumb_attachment_id" value="<%= thumb_attachment_id %>">\n    </div>\n</div>\n<div class="control-group">\n    <label class="control-label" for="music_url">普通音质：</label>\n    <div class="controls">\n        <input type="text" id="music_url" placeholder="填写音乐地址" name="music_url" value="<%= music_url %>">\n    </div>\n</div>\n<div class="control-group">\n    <label class="control-label" for="hq_music_url">高清音质：</label>\n    <div class="controls">\n        <input type="text" id="hq_music_url" placeholder="填写音乐地址" name="hq_music_url" value="<%= hq_music_url %>">\n    </div>\n</div>\n'}),define("components/music/1.0.0/views/form",["require","marionette","components/validation/validate","components/music/1.0.0/views/thumb","core/utils","text!components/music/1.0.0/templates/form.html"],function(t){var e=t("marionette");t("components/validation/validate");var i=t("components/music/1.0.0/views/thumb"),n=t("core/utils"),s=t("text!components/music/1.0.0/templates/form.html");return e.Layout.extend({template:_.template(s),tagName:"form",className:"form-horizontal",ui:{thumb:".msg-music-thumb"},modelEvents:{"change thumb_attachment_id":"change"},onRender:function(){Backbone.Validation.bind(this),this.thumb.show(new i({model:this.model}))},regions:{thumb:".msg-music-thumb"},change:function(){this.ui.thumb},saveForm:function(){var t=this.$el.serializeArray();_(t).each(function(t){["thumb_attachment_id","thumb_attachment_url"].indexOf(t.name)<0&&this.model.set(t.name,t.value)}.bind(this))},submit:function(t){this.saveForm();var e=this.model.validate(),i=this;e?_.isFunction(t.always)&&t.always():this.model.save().always(function(){_.isFunction(t.always)&&t.always()}).success(function(t){n.parse(t,{success:function(){i.model.callback(i.model.attributes),i.model.trigger("closeAll")}})})}})}),define("components/music/1.0.0/views/layout",["require","marionette","text!components/music/1.0.0/templates/layout.html","core/utils","components/music/1.0.0/views/form"],function(t){var e=t("marionette"),i=t("text!components/music/1.0.0/templates/layout.html"),n=(t("core/utils"),t("components/music/1.0.0/views/form"));return e.Layout.extend({template:_.template(i),className:"modal hide fade modal-music",ui:{},regions:{detail:".js-detail-container"},events:{"click .js-save-data":"save"},save:function(t){var e=$(t.target);
e.button("loading"),this.detail.currentView.submit({always:function(){e.button("reset")}})},closeAll:function(){this.$el.modal("hide")},renderToBody:function(t){this.model=t,this.listenTo(this.model,"closeAll",this.closeAll),this.render().$el.appendTo("body"),this.renderDetail(t),this.showModal()},renderDetail:function(t){this.detail.show(new n({model:t}))},showModal:function(){this.$el.modal("show")},initialize:function(){this.$el.on("hidden",function(){this.$el.off("hidden"),this.$el.data("modal",null),this.close(),this.model=null}.bind(this))}})}),define("components/music/1.0.0/models/form",["require","backbone"],function(t){var e=t("backbone");return e.Model.extend({url:_global.url.www+"/showcase/music/detail.json",defaults:function(){return{thumb_attachment_id:"",thumb_attachment_url:"",music_url:"",hq_music_url:"",title:"",description:""}},validation:{thumb_attachment_id:{required:!0,msg:"必须添加一个缩略图"},music_url:[{required:!0,msg:"音乐地址不能为空"},{pattern:"url",msg:"音乐地址必须是一个有效的网址"}],hq_music_url:[{required:!0,msg:"高清音乐地址不能为空"},{pattern:"url",msg:"音乐地址必须是一个有效的网址"}],title:{required:!0,msg:"音乐标题不能为空"},description:{required:!0,msg:"音乐描述不能为空"}},parse:function(t){return t.data},initialize:function(t){this.callback=t.callback}})}),define("components/music/1.0.0/music",["require","components/music/1.0.0/views/layout","components/music/1.0.0/models/form"],function(t){var e=t("components/music/1.0.0/views/layout"),i=t("components/music/1.0.0/models/form");return{initialize:function(t){var n=new e,s=new i(t);n.renderToBody(s)}}}),define("text!components/editor_v2/templates/complex.html",[],function(){return'<% if (type === \'feature\') { %>\n<!-- 微杂志 -->\n<div class="ng ng-single">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">微杂志</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item view-more">\n        <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n            <span class="pull-left">阅读全文</span>\n            <span class="pull-right">&gt;</span>\n        </a>\n    </div>\n</div>\n\n<% } else if (type === \'category\') { %>\n<!-- 微杂志分类 -->\n<div class="ng ng-multiple-mini">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">微杂志分类</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n</div>\n\n<% } else if (type === \'goods\') { %>\n<!-- 商品 -->\n<div class="ng ng-single">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">商 品</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item view-more">\n        <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n            <span class="pull-left">阅读全文</span>\n            <span class="pull-right">&gt;</span>\n        </a>\n    </div>\n</div>\n\n<% } else if (type === \'tag\') { %>\n<!-- 商品标签 -->\n<div class="ng ng-multiple-mini">\n    <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n    <div class="ng-item">\n        <span class="label label-success">分 类</span>\n        <div class="ng-title">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="<%-content.reply.title %>"><%=content.reply.title %></a>\n        </div>\n    </div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n    <div class="ng-item"></div>\n</div>\n\n<% } else if (type === \'articles\') { %>\n<!-- 图文 -->\n    <% if(content.reply && content.reply.length > 1) { %>\n        <div class="ng ng-multiple-mini">\n            <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n            <div class="ng-item">\n                <span class="label label-success">多条图文</span>\n                <div class="ng-title">\n                    <a href="<%=content.reply[0].link %>" target="_blank" class="new-window" title="<%-content.reply[0].title %>"><%=content.reply[0].title %></a>\n                </div>\n            </div>\n            <% for(var idx = 1, len = content.reply.length; idx < len; idx++) { %>\n            <div class="ng-item"></div>\n            <% } %>\n        </div>\n    <% } else { %>\n        <div class="ng ng-single">\n            <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n            <div class="ng-item">\n                <span class="label label-success">图 文</span>\n                <div class="ng-title">\n                    <a href="<%=content.reply[0].url %>" target="_blank" class="new-window" title="<%-content.reply[0].title %>"><%=content.reply[0].title %></a>\n                </div>\n            </div>\n            <div class="ng-item view-more">\n                <a href="<%=content.reply[0].url %>" target="_blank" class="clearfix new-window">\n                    <span class="pull-left">阅读全文</span>\n                    <span class="pull-right">&gt;</span>\n                </a>\n            </div>\n        </div>\n    <% } %>\n\n<% } else if (type === \'homepage\') { %>\n    <!-- 店铺主页 -->\n    <div class="ng ng-single">\n        <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n        <div class="ng-item">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="店铺主页"><span class="label label-success">店铺主页</span></a>\n        </div>\n        <div class="ng-item view-more">\n            <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n                <span class="pull-left">阅读全文</span>\n                <span class="pull-right">&gt;</span>\n            </a>\n        </div>\n    </div>\n<% } else if (type === \'usercenter\') { %>\n    <div class="ng ng-single">\n        <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n        <div class="ng-item">\n            <a href="<%=content.reply.link %>" target="_blank" class="new-window" title="会员主页"><span class="label label-success">会员主页</span></a>\n        </div>\n        <div class="ng-item view-more">\n            <a href="<%=content.reply.link %>" target="_blank" class="clearfix new-window">\n                <span class="pull-left">阅读全文</span>\n                <span class="pull-right">&gt;</span>\n            </a>\n        </div>\n    </div>\n<% } else if (type === \'image\') { %>\n    <div class="ng ng-single ng-image">\n        <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n        <a title="<%=content.reply.title %>" class="picture" target="_blank" href="<%=content.reply.link %>"><img src="<%=content.reply.link %>!100x100.jpg" alt="" /></a>\n    </div>\n<% } else if (type === \'voice\') { %>\n    <div class="voice-wrapper" data-voice-src="<%= content.reply.link%>!8k.mp3">\n        <span class="voice-player">\n            <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n            <span class="stop">点击播放</span>\n            <span class="second"></span>\n            <i class="play" style="display:none;"></i>\n        </span>\n    </div>\n<% } else if (type === \'music\') { %>\n    <div class="voice-wrapper" data-voice-src="<%= content.reply.link %>">\n        <span class="voice-player">\n            <a href="javascript:;" class="close--circle js-delete-complex">&times;</a>\n            <span class="stop">点击播放</span>\n            <span class="second"></span>\n            <i class="play" style="display:none;"></i>\n        </span>\n    </div>\n<% } %>\n'}),define("components/editor_v2/views/editor",["require","jquery","backbone","components/modal/1.0.0/modal","components/image/1.0.0/image","components/audio/1.0.0/audio","text!components/editor_v2/templates/editor.html","components/editor_v2/models/data","components/editor_v2/collections/picture_list","components/editor_v2/views/picture","components/wb_emotion/com","components/weixin_emotion/com","components/wb_hyperlink/com","components/homepage/com","components/usercenter/com","components/music/1.0.0/music","text!components/editor_v2/templates/complex.html","core/utils","jwerty"],function(t){var e=t("jquery"),i=t("backbone"),n=t("components/modal/1.0.0/modal"),s=t("components/image/1.0.0/image"),o=t("components/audio/1.0.0/audio"),a=t("text!components/editor_v2/templates/editor.html"),r=t("components/editor_v2/models/data"),l=t("components/editor_v2/collections/picture_list"),c=t("components/editor_v2/views/picture"),h=t("components/wb_emotion/com"),u=t("components/weixin_emotion/com"),d=t("components/wb_hyperlink/com"),p=t("components/homepage/com"),f=t("components/usercenter/com"),m=t("components/music/1.0.0/music"),g=t("text!components/editor_v2/templates/complex.html"),v=t("core/utils");t("jwerty");var y=i.View.extend({template:_.template(a),complexTemplate:_.template(g),events:{"click .js-delete-complex":"deleteComplex","keyup .js-txta":"textUx",click:"hideMiscPops"},initialize:function(t){var e=this;e.config={},e.setConfig(t),e.hideModules=[],e.listenTo(e,"update:counter",e.updateCounter),e.render(),e.init(),e.renderContent()},setConfig:function(t){var e=this;_(e.config).extend(t);var i=e.model,n=i.get("data");e.charLimit=i.get("charLimit"),e.picLimit=i.get("picLimit"),e.hasSign=i.get("hasSign"),e.sign="",e.hasSign&&"text"===n.type&&(e.sign=n.content)},render:function(){var t=this;return t.$el.html(t.template(t.model.toJSON())),t.$txta=t.$el.find(".js-txta"),t.txta=t.$txta[0],t.counter=t.$el.find(".word-counter i"),t.pictureContainer=t.$el.find(".js-picture-container"),t.complexBackdrop=t.$el.find(".complex-backdrop"),t.complexContent=t.$el.find(".js-complex-content"),t.focusTxta(),t},init:function(){var t=this;t.initModules(),t.initEditorData(),t.initShortcuts()},renderContent:function(){var t=this,e=t.getContent(),i=e.type;"text"===i?(t.setText(e.content),t.switchToText(),t.renderPicture(e.pics)):t.renderComplex(e)},initEditorData:function(){var t=this,e=t.model;t.editorData=new r(e.get("data"),{modules:e.get("modules")}),t.listenTo(t.editorData,"change",t.renderContent)},initShortcuts:function(){var t=this;t.$txta.bind("keydown",jwerty.event("ctrl+enter",function(){t.trigger("ctrl+enter:txta")}))},initModules:function(){var t,e,i=this,n=i.model.get("modules"),s=i.model.get("supportModules"),o={};_.each(n,function(n){_.has(s,n)&&(t=s[n],e=i["init"+t],_.isFunction(e)&&e.apply(i),o["click .js-open-"+n]="toggle"+t)}),_(i.events).extend(o)},textUx:function(){var t=this,e=t.$txta.val();t.hasRemain(e),t.updateData({type:"text",content:e},{silent:!0})},hasRemain:function(t){var e=this,i=v.wbLength(t),n=e.charLimit-i;return e.trigger("update:counter",n),n>=0?!0:!1},updateData:function(t,e){var i=this,n=i.model.get("data");_(n).extend(t);var s={validate:!0};_(s).extend(e),i.editorData.set(n,s)},initEmotion:function(){var t=this;t.emotionTrigger=t.$el.find(".js-open-emotion"),t.emotionWrapper=t.$el.find(".emotion-wrapper")},initWxEmotion:function(){var t=this;t.emotionTrigger=t.$el.find(".js-open-wx_emotion"),t.emotionWrapper=t.$el.find(".emotion-wrapper")},_initEmotion:function(){var t=this;t.wbEmotion=new h({target:t.emotionTrigger,el:t.emotionWrapper}),t.hideModules.push(t.wbEmotion),t.listenTo(t.wbEmotion,"selected:emotion",t.insertText)},_initWxEmotion:function(){var t=this;t.wxEmotion=new u({target:t.emotionTrigger,el:t.emotionWrapper}),t.hideModules.push(t.wxEmotion),t.listenTo(t.wxEmotion,"selected:emotion",t.insertText)},initHyperlink:function(){var t=this;t.hyperlinkTrigger=t.$el.find(".js-open-hyperlink"),t.hyperlinkWrapper=t.$el.find(".hyperlink-wrapper"),t.wbHyperlink=new d({target:t.hyperlinkTrigger,el:t.hyperlinkWrapper}),t.hideModules.push(t.wbHyperlink),t.listenTo(t.wbHyperlink,"save:hyperlink",t.insertHyperlink)},initArticles:function(){},initHomepage:function(){var t=this;t.homepage=new p,t.usercenter=new f},initPicture:function(){var t=this,e=t.pictureList=new l([]);t.listenTo(e,"add",t.addOnePicture),t.listenTo(e,"reset",t.addAllPicture),t.listenTo(e,"update:picture_list",t.updatePics)},initMusic:function(){},setText:function(t){var e=this;e.$txta.val(t).trigger("keyup")},insertText:function(t){var e=this;v.insertText(e.txta,t),e.$txta.trigger("keyup")},insertHyperlink:function(t){var i=v.getSelectedText(this.txta);i&&0!=i.length&&(t='<a href="'+e.trim(t)+'">'+i+"</a>"),this.insertText(t)},updateCounter:function(t){var e=this;e.counter.html(t),e.counter.toggleClass("error",0>t)},toggleHyperlink:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.switchToText(),e.hideMiscPops(),e.wbHyperlink.toggle()},toggleEmotion:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.wbEmotion||e._initEmotion(),e.switchToText(),e.hideMiscPops(),e.wbEmotion.toggle()},toggleWxEmotion:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.wxEmotion||e._initWxEmotion(),e.switchToText(),e.hideMiscPops(),e.wxEmotion.toggle()},togglePicture:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.pictureModal=s.initialize({multiChoose:!1,callback:function(t){t=t[0],e.switchToText(),e.insertPicture(t)}})},toggleMusic:function(t){t.preventDefault(),t.stopPropagation();var e=this;m.initialize({callback:function(t){e.insertComplex({type:"music",content:{_id:t.id,reply:{title:t.title,link:t.hq_music_url}}})}})},toggleArticles:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.articleModal=n.initialize({type:"news"}).setChooseItemCallback(function(t){t.news&&t.news.length>1&&(t.news=t.news.slice(0,4)),e.insertComplex({type:"articles",content:{_id:t.id,reply:t.news}})}),e.articleModal.modal("show")},toggleImage:function(t){t.preventDefault(),t.stopPropagation();var e=this;s.initialize({multiChoose:!1,maxSize:128,callback:function(t){t=t[0],e.insertComplex({type:"image",content:{_id:t.attachment_id,reply:{title:t.attachment_title,link:v.fullfillImage(t.attachment_url)}}})}})},toggleVoice:function(t){t.preventDefault(),t.stopPropagation();var e=this;o.initialize({multiChoose:!1,callback:function(t){t=t[0],e.insertComplex({type:"voice",content:{_id:t.attachment_id,reply:{title:t.attachment_title,link:v.fullfillImage(t.attachment_url)}}})}})},toggleShortlink:function(t){var i=this,n=e(t.target),s=n.data("link-type");i.homepage||i.initHomepage(),i["toggle"+s]()},toggleFeature:function(t){var i=this,s=!1;t&&(s=e(t.target).data("complex-mode")),i.featureModal=n.initialize({type:"feature"}).setChooseItemCallback(function(t){s?i.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.title,link:t.data_url}}}):(i.switchToText(),i.insertText(" "+t.data_url+" "))}),i.featureModal.modal("show")},toggleGoods:function(t){var i=this,s=!1;t&&(s=e(t.target).data("complex-mode")),i.goodsModal=n.initialize({type:"goods"}).setChooseItemCallback(function(t){s?i.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.title,link:t.data_url}}}):(i.switchToText(),i.insertText(" "+t.data_url+" "))}),i.goodsModal.modal("show")},toggleHomepage:function(t){var i=this,n=!1;return t&&(n=e(t.target).data("complex-mode")),"homepage"===i.model.get("data").type?!1:void i.homepage.get(function(t){n?i.insertComplex({type:t.type,content:{_id:t.id,reply:{title:t.title,link:t.data_url}}}):(i.switchToText(),i.insertText(" "+t.data_url+" "))})},toggleUsercenter:function(){var t=this,i=!1;return event&&(i=e(event.target).data("complex-mode")),"usercenter"===t.model.get("data").type?!1:void t.usercenter.get(function(e){i?t.insertComplex({type:e.type,content:{_id:e.id,reply:{title:e.title,link:e.data_url}}}):(t.switchToText(),t.insertText(" "+e.data_url+" "))})},insertComplex:function(t){var e=this;e.renderComplex(t),e.updateData(t),e.$txta.focus()},renderComplex:function(t){var e=this;e.showBackdrop();var i=e.complexTemplate(t);e.complexContent.empty(),e.complexContent.append(i)},insertPicture:function(t){var e=this;e.pictureList&&(e.picLimit>1?e.pictureList.checkMaxsize()&&e.pictureList.add(t):e.pictureList.reset(t),e.pictureList.trigger("update:picture_list"))},addOnePicture:function(t){var e=this,i=new c({model:t});e.pictureContainer.append(i.render().el)},addAllPicture:function(){var t=this;t.pictureContainer.empty(),t.pictureList.each(t.addOnePicture,t)},updatePics:function(){var t=this,e=t.pictureList.getPics();t.updateData({pics:e},{silent:!0})},renderPicture:function(t){for(var e=this,i=0,n=t.length;n>i;i++)t[i]={attachment_url:t[i]};e.insertPicture(t)},existedComplex:function(){var t=this,e=t.editorData.toJSON();"text"!==e.type&&t.renderComplex(e)},showBackdrop:function(){this.complexBackdrop.show()},hideBackdrop:function(){this.complexBackdrop.hide()},focusTxta:function(){var t=this;t.$txta.focus()},clearTxta:function(){var t=this;t.$txta.val(t.hasSign?t.sign:""),t.resetData()},clearPicture:function(){var t=this;t.pictureList&&t.pictureList.reset([])},resetData:function(){var t=this;t.updateData({type:"text",content:t.sign||"",pics:[]})},deleteComplex:function(){var t=this;t.complexContent.empty(),t.hideBackdrop(),t.textUx(),t.focusTxta()},switchToText:function(){var t=this;t.deleteComplex()},hideMiscPops:function(){var t=this;_(t.hideModules).each(function(t){t.hide()})},clear:function(){var t=this;t.deleteComplex(),t.clearTxta(),t.clearPicture()},getContent:function(){var t=this,e=t.editorData.toJSON();return"text"===e.type&&v.wbLength(e.content)>t.charLimit&&(t.flashAnimate(),t.focusTxta()),e},flashAnimate:function(){var t=this;t.$txta.addClass("animated flashError"),window.clearTimeout(t.flashTimer),t.flashTimer=window.setTimeout(function(){t.$txta.removeClass("flashError")},2e3)}});return y}),define("components/editor_v2/com",["require","backbone","components/editor_v2/models/editor","components/editor_v2/views/editor"],function(t){var e=t("backbone"),i=t("components/editor_v2/models/editor"),n=t("components/editor_v2/views/editor"),s={enter:function(t){var e={};return e="text"===t.type?t:"image"==t.type||"voice"==t.type?{type:t.type,content:{_id:t.media_attachment_id,reply:{link:t.attachment_url_cdn,title:t.title}}}:"music"==t.type?{type:t.type,content:{_id:t.data_id,reply:{link:t.hq_music_url,title:t.title}}}:"news"==t.data_type?{type:"articles",content:{_id:t.data_id,reply:[{url:t.url,title:t.title}]}}:{type:t.data_type,content:{_id:t.data_id,reply:{link:t.url,title:t.title}}}},out:function(t){var e;return e="text"===t.type?t:"image"===t.type||"voice"===t.type?{type:t.type,media_attachment_id:t.content._id,attachment_url_cdn:t.content.reply.link,title:t.content.reply.title}:"music"===t.type?{type:t.type,data_id:t.content._id,data_type:"music",hq_music_url:t.content.reply.link,title:t.content.reply.title}:"articles"===t.type?{type:"news",data_type:"news",data_id:t.content._id,url:t.content.reply[0].url,title:t.content.reply[0].title}:{type:"news",data_type:t.type,data_id:t.content._id,url:t.content.reply.link,title:t.content.reply.title}}},o=e.View.extend({initialize:function(t){var e=this,o=e.config=t.config;o.data=s.enter(o.data);var a=e.editor=new i(o);e.editorView=new n({el:e.el,model:a}),e.listenTo(e.editorView,"ctrl+enter:txta",e.shortcuts)},render:function(){var t=this;return t},focus:function(){var t=this;t.editorView.focusTxta()},shortcuts:function(){var t=this;t.trigger("ctrl+enter:txta")},updateContent:function(t){t=s.enter(t),this.editorView.updateData(t)},getContent:function(){var t=this.editorView.getContent();return t=s.out(t)},insertText:function(t){var e=this;e.editorView.insertText(t)},clear:function(){var t=this;t.editorView.clear()}});return o}),define("components/pop/rule_reply",["require","components/pop/base","text!components/pop/templates/reply.html","components/editor_v2/com","core/utils"],function(t){var e=t("components/pop/base"),i=t("text!components/pop/templates/reply.html"),n=t("components/editor_v2/com"),s=t("core/utils");return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-close":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){var i=this;e.prototype.initialize.call(i,t),i.data=t.data},render:function(){var t=this,e=t.data,i=e.minus;t.$el.html(t.template(e)),t.editorEle=t.$el.find(".wb-sender__input");var s=["wx_emotion","hyperlink","image","voice","music","articles","goods","feature","homepage","usercenter"];return["/v2/weixin/autoreply/normal","/v2/weixin/autoreply/default"].indexOf(window.location.pathname)<0&&(_global.team_status.weixin_server&&_global.team_status.weixin_oldsub||(s=_.without(s,"music"))),i&&(s=s.filter(function(t){return!i.some(function(e){return e==t})})),t.editor=new n({config:{data:e,charLimit:300,picLimit:1,modules:s,thumb:["goods","feature","homepage","usercenter"]},el:t.editorEle}),t},positioning:function(){var t=this,e=t.options.className;t.el.className=e,t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center"}:{of:t.target,my:"left center",at:"right center"}),t.editor.focus()},setData:function(t){var e=this;e.editor.updateContent(t)},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className;this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},triggerCallback:function(){var t=this,e=t.editor.getContent();this.validateData(e).done(function(){t.callback.call(t,e)}).fail(function(t){s.errorNotify(t)}).always(function(){t.hide(),t.editor.clear()})},validateData:function(t){var e=new $.Deferred;if("voice"==t.type){if(void 0!=$.getAudioDuration)return $.getAudioDuration(t.attachment_url_cdn).then(function(t){return Math.floor(t)>61?e.reject("音频不能超过60秒"):void 0});e.resolve()}else e.resolve();return e}})}),define("text!components/pop/templates/rule_method.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-thin">\n    <div class="popover-content">\n        <div class="controls">\n            <label class="radio inline">\n                <input value="1" type="radio" name="send_type" \n                    <% if(sendAll == 1) {%>\n                        checked\n                    <% } %>\n                > 全部发送 \n            </label>\n            <label class="radio inline">\n                <input value="0" type="radio" name="send_type"\n                    <% if(sendAll == 0) {%>\n                        checked\n                    <% } %>\n                > 随机发送一条 \n            </label>\n        </div>\n        \n        <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n        <button type="button" class="btn btn-cancle js-btn-cancel">取消</button>\n    \n    </div>\n</div>'}),define("components/pop/rule_method",["backbone","components/pop/base","text!components/pop/templates/rule_method.html","core/utils"],function(t,e,i,n){return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){e.prototype.initialize.call(this,t),this.data=t.data},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.el.className=t.options.className,t.txt=t.$el.find(".js-txt"),t},positioning:function(){var t=this;t.$el.show().position({of:t.target,my:"center top",at:"center bottom",collision:"none"}),t.txt.focus()},setData:function(t){this.data=_.extend(this.data,t),this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data,o=t.className;this.options.className=o,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},enterSave:function(t){return t.which===n.keyCode.ENTER?(this.triggerCallback(),!1):void 0},triggerCallback:function(){var t=this,e={};t.$("input[type=radio]").each(function(){this.checked&&(e.sendAll=this.value)}),t.callback(e),t.hide()}})}),define("text!components/pop/templates/change.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-change">\n    <div class="popover-content text-center">\n        <form class="form-inline">\n            <label class="radio">\n                <input type="radio" name="discount" value="1" checked/>参与\n            </label>\n            <label class="radio">\n                <input type="radio" name="discount" value="0"/>不参与\n            </label>\n            <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            <button type="reset" class="btn js-btn-cancel">取消</button>\n        </form>\n    </div>\n</div>\n'}),define("components/pop/change",["backbone","components/pop/base","text!components/pop/templates/change.html","core/utils"],function(t,e,i){return e.extend({template:_.template(i),className:"popover right popover-change",events:{"click .js-btn-cancel":"hide","click .js-btn-confirm":"triggerCallback"},initialize:function(t){e.prototype.initialize.call(this,t)},render:function(){return this.$el.html(this.template({})),this},setData:function(t){this.data=t,this.render()},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.data;this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.setData(s),this.positioning(),this.show()},triggerCallback:function(){this.callback({join:$.trim(this.$('[name="discount"]:checked').val())}),this.hide()}})}),define("text!components/pop/templates/apps_qrcode.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-qrcode">\n    <div class="popover-content">\n        <div class="popover-qrcode-header">\n            <button type="button" class="close js-close">×</button>\n            <div class="popover-qrcode-title">活动二维码</div>    \n        </div>\n        \n        <div class="qrcode-wrap">\n            <img class="qrcode loading" src="http://wap.koudaitong.com/v2/common/url/create?type=<%= type %>&mode=apps&alias=<%= alias %>">\n            <p class="scan-info">扫一扫立即参与活动</p>\n        </div>\n\n        <div class="popover-qrcode-footer">\n            <a href="http://wap.koudaitong.com/v2/common/url/create?type=<%= type %>&mode=apps&alias=<%= alias %>" download="<%= name %>">下载二维码</a>\n            <a href="/v2/weixin/autoreply/scan" class="pull-right">设置带参数二维码</a>\n        </div>\n    </div>\n</div>'}),define("components/pop/apps_qrcode",["require","backbone","components/pop/base","text!components/pop/templates/apps_qrcode.html","core/utils","underscore"],function(t){var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/apps_qrcode.html"),n=t("core/utils"),s=t("underscore");return e.extend({template:s.template(i),className:function(){return this.options.className},initialize:function(t){this.data=t.data,e.prototype.initialize.call(this,t)},events:{"click .js-close":"hide"},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),n.focus(t.$(".js-btn-confirm")),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.el.className=t.options.className,t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left";this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()}})}),define("text!components/pop/templates/common_qrcode.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-qrcode">\n    <div class="popover-content">\n        <div class="popover-qrcode-header">\n            <button type="button" class="close js-close">×</button>\n            <div class="popover-qrcode-title"><%- title %></div>\n        </div>\n\n        <div class="qrcode-wrap loading">\n            <img class="qrcode" src="<%= qr_url %>">\n            <p class="scan-info"><%- description %></p>\n        </div>\n\n        <div class="popover-qrcode-footer">\n            <a href="<%= qr_url %>">下载二维码</a>\n            <a href="/v2/weixin/autoreply/scan" class="pull-right">设置带参数二维码</a>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/common_qrcode",["require","components/pop/base","text!components/pop/templates/common_qrcode.html","core/utils","underscore"],function(t){var e=t("components/pop/base"),i=t("text!components/pop/templates/common_qrcode.html"),n=t("core/utils"),s=t("underscore");return e.extend({template:s.template(i),className:function(){return this.options.className},initialize:function(t){this.data=t.data,e.prototype.initialize.call(this,t)},events:{"click .js-close":"hide"},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),n.focus(t.$(".js-btn-confirm")),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},render:function(){var t=this;return t.$el.html(t.template(t.data)),t.el.className=t.options.className,t},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left";this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()}})}),define("text!components/pop/templates/image_text.html",[],function(){return'<div class="popover-inner popover-image-text">\n    <div class="popover-content">\n        <ul class="clearfix">\n            <li class="js-mode-weixin-trigger active">微信图文</li>\n            <li class="js-mode-kdt-trigger">高级图文</li>\n        </ul>\n        <div class="tab-content">\n            <div class="js-mode-weixin active">\n                <p class="color-danger">该类型可用于群发。关键词、扫码、自定义菜单等回复，推荐使用高级图文。<a class="new-window" href="http://bbs.koudaitong.com/forum.php?mod=viewthread&tid=3243" target="_blank">详情</a></p>\n                <div class="mode-links clearfix">\n                    <a href="#create/0" class="pull-left">单条图文素材</a>\n                    <a href="#create/1" class="pull-right">多条图文素材</a>\n                </div>\n            </div>\n            <div class="js-mode-kdt">\n                <p class="color-danger">该类型不可用于群发。<a class="new-window" href="http://bbs.koudaitong.com/forum.php?mod=viewthread&tid=3243" target="_blank">详情</a></p>\n                <div class="mode-links clearfix">\n                    <a href="/news/create?is_single=1" class="pull-left">单条图文素材</a>\n                    <a href="/news/create?is_single=0" class="pull-right">多条图文素材</a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("components/pop/image_text",["require","backbone","components/pop/base","text!components/pop/templates/image_text.html","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/image_text.html");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},events:{"click a":"hide","click .js-mode-weixin-trigger":"toggleShow","click .js-mode-kdt-trigger":"toggleShow"},toggleShow:function(){this.$(".js-mode-weixin").toggleClass("active"),this.$(".js-mode-kdt").toggleClass("active"),this.$(".js-mode-weixin-trigger").toggleClass("active"),this.$(".js-mode-kdt-trigger").toggleClass("active")
},initialize:function(t){e.prototype.initialize.call(this,t)},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left-bottom")?{of:t.target,my:"left top",at:"left bottom",collision:"none"}:-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover left";this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()}})}),define("text!components/pop/templates/alert.html",[],function(){return'<div class="arrow"></div>\n<div class="popover-inner popover-confirm">\n    <div class="popover-content text-center">\n        <div class="form-inline clearfix">\n            <span class="js-confirm-text help-inline pull-left">\n                <%= options.data || \'\' %>\n            </span>\n            <span class="js-confirm-btn-action pull-right">\n                <button type="button" class="btn btn-primary js-btn-confirm" data-loading-text="确定">确定</button>\n            </span>\n        </div>\n        <% if(options.content) { %>\n        <div class="popover-confirm-content">\n            <%= options.content %>\n        </div>\n        <% } %>\n    </div>\n</div>\n'}),define("components/pop/alert",["require","backbone","components/pop/base","text!components/pop/templates/alert.html","core/utils"],function(t){{var e=(t("backbone"),t("components/pop/base")),i=t("text!components/pop/templates/alert.html");t("core/utils")}return e.extend({template:_.template(i),className:function(){return this.options.className},initialize:function(t){$(".popover-confirm").parents(".popover").remove(),e.prototype.initialize.call(this,t)},events:{"click .js-btn-confirm":"triggerCallback"},render:function(){return this.$el.html(this.template({options:this.options})),this},isShow:function(){var t=this.$el.css("display");return"none"===t?!1:!0},positioning:function(){var t=this,e=t.options.className;t.$el.show(),t.$el.position(-1!==e.indexOf("left")?{of:t.target,my:"right center",at:"left center",collision:"none"}:-1!==e.indexOf("bottom")?{of:t.target,my:"center top",at:"center bottom",collision:"none"}:-1!==e.indexOf("top")?{of:t.target,my:"center bottom",at:"center top",collision:"none"}:{of:t.target,my:"left center",at:"right center",collision:"none"}),t.el.className=t.options.className},reset:function(t){var e=t.callback,i=t.target,n=t.trigger,s=t.className||"popover right";this.$(".js-confirm-text").html(t.data),this.options.className=s,this.setCallback(e),this.setTarget(i),this.setTrigger(n),this.positioning(),this.show()},triggerCallback:function(){this.callback.call(this),this.hide()}})}),define("components/pop/pop",["require","backbone","components/pop/link","components/pop/confirm","components/pop/delete","components/pop/delete_multiple","components/pop/rule","components/pop/keyword","components/pop/reply","components/pop/normal_reply","components/pop/url","components/pop/goods_url","components/pop/text","components/pop/rename","components/pop/change_category","components/pop/help_notes","components/pop/memo","components/pop/chosen","components/pop/template","components/pop/category","components/pop/msgcat","components/pop/tag","components/pop/form_actions_confirm","components/pop/send_goods","components/pop/note","components/pop/cube","components/pop/timer","components/pop/fans_tag","components/pop/fans_level","components/pop/qrcode","components/pop/rule_reply","components/pop/rule_method","components/pop/change","components/pop/apps_qrcode","components/pop/common_qrcode","components/pop/image_text","components/pop/alert"],function(t){var e=(t("backbone"),t("components/pop/link")),i=t("components/pop/confirm"),n=t("components/pop/delete"),s=t("components/pop/delete_multiple"),o=t("components/pop/rule"),a=t("components/pop/keyword"),r=t("components/pop/reply"),l=t("components/pop/normal_reply"),c=t("components/pop/url"),h=t("components/pop/goods_url"),u=t("components/pop/text"),d=t("components/pop/rename"),p=t("components/pop/change_category"),f=t("components/pop/help_notes"),m=t("components/pop/memo"),g=t("components/pop/chosen"),v=t("components/pop/template"),y=t("components/pop/category"),_=t("components/pop/msgcat"),b=t("components/pop/tag"),w=t("components/pop/form_actions_confirm"),x=t("components/pop/send_goods"),k=t("components/pop/note"),C=t("components/pop/cube"),D=t("components/pop/timer"),T=t("components/pop/fans_tag"),j=t("components/pop/fans_level"),S=t("components/pop/qrcode"),N=t("components/pop/rule_reply"),E=t("components/pop/rule_method"),F=t("components/pop/change"),M=t("components/pop/apps_qrcode"),I=t("components/pop/common_qrcode"),z=t("components/pop/image_text"),P=t("components/pop/alert"),A={};return{initialize:function(t){var O=t.target=$(t.target),L=t.className,H=t.type,R=t.callback,q=t.trigger=$(t.trigger||O),W=t.data,B=t.notAutoHide||!1,U=t.content||"",V=t.appendTarget||"body";if(A[H])return A[H].reset(t),A[H];var Y;switch(H){case"link":Y=new e({callback:R,target:O,trigger:q,content:U});break;case"text":Y=new u({callback:R,target:O,trigger:q});break;case"delete":Y=new n({callback:R,target:O,className:L||"popover left",trigger:q});break;case"confirm":Y=new i({callback:R,target:O,className:L||"popover right",trigger:q,notAutoHide:B,data:W,content:U});break;case"alert":Y=new P({callback:R,target:O,className:L||"popover right",trigger:q,data:W,content:U});break;case"note":Y=new k({callback:R,target:O,className:L||"popover right",trigger:q,data:W});break;case"timer":Y=new D({callback:R,target:O,className:L||"popover top",trigger:q,data:W});break;case"delete_multiple":Y=new s({callback:R,target:O,trigger:q});break;case"url":Y=new c({callback:R,target:O,trigger:q,data:W});break;case"goods_url":Y=new h({callback:R,target:O,trigger:q,data:W});break;case"rule":Y=new o({callback:R,target:O,trigger:q,className:L,data:W});break;case"keyword":Y=new a({callback:R,target:O,trigger:q,data:W});break;case"reply":Y=new r({callback:R,target:O,trigger:q,className:L,notAutoHide:!0,data:W});break;case"normal_reply":Y=new l({callback:R,target:O,trigger:q,className:L,data:W});break;case"rename":Y=new d({callback:R,target:O,className:L||"popover left",trigger:q,data:W});break;case"chosen":Y=new g({callback:R,target:O,trigger:q,notAutoHide:!0,data:W});break;case"change_category":Y=new p({callback:R,target:O,trigger:q});break;case"change":Y=new F({callback:R,target:O,className:L||"popover top",trigger:q});break;case"help_notes":Y=new f({callback:R,target:O,className:L||"popover bottom",trigger:q});break;case"memo":Y=new m({callback:R,target:O,trigger:q,className:L||"popover left",data:W});break;case"template":Y=new v({callback:R,target:O,trigger:q,className:L});break;case"category":Y=new y({callback:R,target:O,trigger:q,data:W});break;case"msgcat":Y=new _({callback:R,target:O,trigger:q,data:W});break;case"tag":Y=new b({callback:R,target:O,trigger:q,data:W});break;case"form_actions_confirm":Y=new w({callback:R,target:O,appendTarget:V,className:L||"popover top",trigger:q,data:W});break;case"send_goods":Y=new x({callback:R,target:O,trigger:q,className:"popover left"});break;case"cube":Y=new C({callback:R,target:O,trigger:q,className:"popover bottom",data:W});break;case"fans_tag":Y=new T({callback:R,target:O,trigger:q,className:"popover bottom",data:W});break;case"fans_level":Y=new j({callback:R,target:O,trigger:q,className:"popover bottom",data:W});break;case"qrcode":Y=new S({callback:R,target:O,trigger:q,className:"popover bottom",data:W});break;case"rule_reply":Y=new N({callback:R,target:O,trigger:q,className:L,notAutoHide:!0,data:W});break;case"rule_method":Y=new E({callback:R,target:O,trigger:q,className:L,data:W});break;case"apps_qrcode":Y=new M({target:O,trigger:q,className:L||"popover left",data:W});break;case"common_qrcode":Y=new I({target:O,trigger:q,className:L||"popover left",data:W});break;case"image_text":Y=new z({target:O,trigger:q,className:L||"popover top",data:W})}return Y.render().$el.appendTo(V),Y.positioning(),"help_notes"!==H&&"confirm"!==H&&"apps_qrcode"!==H&&"common_qrcode"!==H&&(A[H]=Y),Y}}}),define("core/global",["jquery","backbone","marionette","bootstrap","notify","core/utils","components/page_help/help","backboneValidate","core/event","common","backbone.wreqr","text","jqueryui","components/pop/pop"],function(){});